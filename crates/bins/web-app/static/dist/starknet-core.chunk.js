/*! For license information please see starknet-core.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkpaynet_web_app=self.webpackChunkpaynet_web_app||[]).push([[745],{450:(e,t,n)=>{n.r(t),n.d(t,{Account:()=>rg,AccountInterface:()=>sg,BatchClient:()=>Jc,BlockStatus:()=>Ic,BlockTag:()=>Cc,CairoCustomEnum:()=>Fd,CairoFixedArray:()=>Xd,CairoOption:()=>Md,CairoOptionVariant:()=>Ud,CairoResult:()=>Hd,CairoResultVariant:()=>$d,CairoUint256:()=>ad,CairoUint512:()=>ld,CallData:()=>hu,Contract:()=>kg,ContractFactory:()=>Tg,ContractInterface:()=>Sg,EDAMode:()=>Lc,EDataAvailabilityMode:()=>Dc,ETH_ADDRESS:()=>Hc,ETransactionExecutionStatus:()=>Fc,ETransactionStatus:()=>Pc,ETransactionVersion:()=>Bc,ETransactionVersion2:()=>Oc,ETransactionVersion3:()=>Nc,EntryPointType:()=>kc,EthSigner:()=>wp,LedgerSigner:()=>bp,LedgerSigner111:()=>bp,LedgerSigner221:()=>Tp,LedgerSigner231:()=>Ip,LibraryError:()=>Lh,Literal:()=>$c,LogLevelIndex:()=>bc,NON_ZERO_PREFIX:()=>zc,OutsideExecutionTypesV1:()=>jc,OutsideExecutionTypesV2:()=>qc,OutsideExecutionVersion:()=>Kc,PaymasterInterface:()=>tg,PaymasterRpc:()=>eg,Provider:()=>dp,ProviderInterface:()=>up,RPC:()=>xo,RPC07:()=>Ec,RPC08:()=>of,RPCResponseParser:()=>pf,ReceiptTx:()=>gf,ResponseParser:()=>xg,RpcChannel:()=>lf,RpcError:()=>Rh,RpcProvider:()=>dp,Signer:()=>pp,SignerInterface:()=>fp,Subscription:()=>hf,TimeoutError:()=>Vh,TransactionExecutionStatus:()=>xc,TransactionFinalityStatus:()=>Tc,TransactionType:()=>Sc,TypedDataRevision:()=>U.K,UINT_128_MAX:()=>Jl,UINT_128_MIN:()=>cd,UINT_256_HIGH_MAX:()=>nd,UINT_256_HIGH_MIN:()=>sd,UINT_256_LOW_MAX:()=>td,UINT_256_LOW_MIN:()=>rd,UINT_256_MAX:()=>Ql,UINT_256_MIN:()=>ed,UINT_512_MAX:()=>id,UINT_512_MIN:()=>od,Uint:()=>Mc,ValidateType:()=>Uc,WalletAccount:()=>wg,WebSocketChannel:()=>ff,WebSocketNotConnectedError:()=>Ph,addAddressPadding:()=>Ep,byteArray:()=>Wl,cairo:()=>Gl,config:()=>wc,constants:()=>To,contractClassResponseToLegacyCompiledContract:()=>Oh,defaultPaymaster:()=>ng,defaultProvider:()=>hp,ec:()=>gu,encode:()=>Co,eth:()=>Fh,events:()=>Cp,extractContractHashes:()=>Bh,getCalldata:()=>Ag,getChecksumAddress:()=>kp,getLedgerPathBuffer:()=>vp,getLedgerPathBuffer111:()=>vp,getLedgerPathBuffer221:()=>xp,hash:()=>fu,isPendingBlock:()=>uh,isPendingStateUpdate:()=>fh,isPendingTransaction:()=>hh,isRPC08_FeeEstimate:()=>Rc,isRPC08_ResourceBounds:()=>Vc,isSierra:()=>Ch,isSupportedSpecVersion:()=>ch,isV3Tx:()=>ih,isVersion:()=>oh,json:()=>Wc,logger:()=>vc,merkle:()=>yf,num:()=>tl,outsideExecution:()=>Vp,parseCalldataField:()=>eu,paymaster:()=>Kp,provider:()=>Hh,selector:()=>Cl,shortString:()=>Pl,src5:()=>jp,stark:()=>ah,starknetId:()=>Pf,toAnyPatchVersion:()=>lh,toApiVersion:()=>dh,transaction:()=>Xh,typedData:()=>mf,types:()=>Ac,uint256:()=>gp,units:()=>Ig,v2hash:()=>pu,v3hash:()=>Eu,validateAndParseAddress:()=>Ap,validateChecksumAddress:()=>Sp,wallet:()=>ag});var r={};n.r(r),n.d(r,{aK:()=>Xe,e8:()=>Le,DO:()=>De,dJ:()=>Je,OG:()=>Qe,My:()=>Ve,Ph:()=>He,lX:()=>ze,Id:()=>Ze,fg:()=>nt,qj:()=>We,aT:()=>$e,ME:()=>Fe,r4:()=>Ge,aY:()=>Ne,x:()=>at,lq:()=>je,z:()=>qe,zW:()=>Pe,IV:()=>Ke,Q5:()=>st});var s={};n.r(s),n.d(s,{poseidon:()=>gn,splitConstants:()=>pn,validateOpts:()=>fn});var a={};n.r(a),n.d(a,{DER:()=>In,SWUFpSqrtRatio:()=>Vn,mapToCurveSimpleSWU:()=>Pn,weierstrass:()=>Rn,weierstrassPoints:()=>Ln});var i={};n.r(i),n.d(i,{CURVE:()=>tr,Fp251:()=>Er,MAX_VALUE:()=>Hn,ProjectivePoint:()=>nr,Signature:()=>rr,_poseidonMDS:()=>kr,_starkCurve:()=>Kn,computeHashOnElements:()=>_r,ethSigToPrivate:()=>lr,getAccountPath:()=>ur,getPublicKey:()=>Yn,getSharedSecret:()=>Gn,getStarkKey:()=>cr,grindKey:()=>or,keccak:()=>br,normalizePrivateKey:()=>Zn,pedersen:()=>yr,poseidonBasic:()=>Tr,poseidonCreate:()=>xr,poseidonHash:()=>Cr,poseidonHashFunc:()=>Br,poseidonHashMany:()=>Nr,poseidonHashSingle:()=>Or,poseidonSmall:()=>Ir,sign:()=>Qn,utils:()=>sr,verify:()=>er});var o=n(785),c=n(568),l=n(864),d=n(917),u=n(74);function h(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function f(e,t){return!!Array.isArray(t)&&(0===t.length||(e?t.every(e=>"string"==typeof e):t.every(e=>Number.isSafeInteger(e))))}function p(e){if("function"!=typeof e)throw new Error("function expected");return!0}function g(e,t){if("string"!=typeof t)throw new Error(`${e}: string expected`);return!0}function m(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function y(e){if(!Array.isArray(e))throw new Error("array expected")}function _(e,t){if(!f(!0,t))throw new Error(`${e}: array of strings expected`)}function w(e,t){if(!f(!1,t))throw new Error(`${e}: array of numbers expected`)}function b(...e){const t=e=>e,n=(e,t)=>n=>e(t(n));return{encode:e.map(e=>e.encode).reduceRight(n,t),decode:e.map(e=>e.decode).reduce(n,t)}}function v(e){const t="string"==typeof e?e.split(""):e,n=t.length;_("alphabet",t);const r=new Map(t.map((e,t)=>[e,t]));return{encode:r=>(y(r),r.map(r=>{if(!Number.isSafeInteger(r)||r<0||r>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${r}". Allowed: ${e}`);return t[r]})),decode:t=>(y(t),t.map(t=>{g("alphabet.decode",t);const n=r.get(t);if(void 0===n)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return n}))}}function E(e=""){return g("join",e),{encode:t=>(_("join.decode",t),t.join(e)),decode:t=>(g("join.decode",t),t.split(e))}}function A(e,t="="){return m(e),g("padding",t),{encode(n){for(_("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){_("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8==0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}function k(e){return p(e),{encode:e=>e,decode:t=>e(t)}}function S(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(y(e),!e.length)return[];let r=0;const s=[],a=Array.from(e,e=>{if(m(e),e<0||e>=t)throw new Error(`invalid integer: ${e}`);return e}),i=a.length;for(;;){let e=0,o=!0;for(let s=r;s<i;s++){const i=a[s],c=t*e,l=c+i;if(!Number.isSafeInteger(l)||c/t!==e||l-i!==c)throw new Error("convertRadix: carry overflow");const d=l/n;e=l%n;const u=Math.floor(d);if(a[s]=u,!Number.isSafeInteger(u)||u*n+e!==l)throw new Error("convertRadix: carry overflow");o&&(u?o=!1:r=s)}if(s.push(e),o)break}for(let t=0;t<e.length-1&&0===e[t];t++)s.push(0);return s.reverse()}const T=(e,t)=>0===t?e:T(t,e%t),x=(e,t)=>e+(t-T(e,t)),I=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function C(e,t,n,r){if(y(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(x(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${x(t,n)}`);let s=0,a=0;const i=I[t],o=I[n]-1,c=[];for(const r of e){if(m(r),r>=i)throw new Error(`convertRadix2: invalid data word=${r} from=${t}`);if(s=s<<t|r,a+t>32)throw new Error(`convertRadix2: carry overflow pos=${a} from=${t}`);for(a+=t;a>=n;a-=n)c.push((s>>a-n&o)>>>0);const e=I[a];if(void 0===e)throw new Error("invalid carry");s&=e-1}if(s=s<<n-a&o,!r&&a>=t)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&a>0&&c.push(s>>>0),c}function B(e,t=!1){if(m(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(x(8,e)>32||x(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!h(n))throw new Error("radix2.encode input should be Uint8Array");return C(Array.from(n),8,e,!t)},decode:n=>(w("radix2.decode",n),Uint8Array.from(C(n,e,8,t)))}}function O(e){return p(e),function(...t){try{return e.apply(null,t)}catch(e){}}}b(B(4),v("0123456789ABCDEF"),E("")),b(B(5),v("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),A(5),E(""));const N=(b(B(5),v("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),E("")),b(B(5),v("0123456789ABCDEFGHIJKLMNOPQRSTUV"),A(5),E("")),b(B(5),v("0123456789ABCDEFGHIJKLMNOPQRSTUV"),E("")),b(B(5),v("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),E(""),k(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),b(B(6),v("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),A(6),E(""))),D=(b(B(6),v("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),E("")),b(B(6),v("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),A(6),E("")),b(B(6),v("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),E("")),e=>{return b((m(t=58),{encode:e=>{if(!h(e))throw new Error("radix.encode input should be Uint8Array");return S(Array.from(e),256,t)},decode:e=>(w("radix.decode",e),Uint8Array.from(S(e,t,256)))}),v(e),E(""));var t}),L=(D("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),D("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),D("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),b(v("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),E(""))),R=[996825010,642813549,513874426,1027748829,705979059];function V(e){const t=e>>25;let n=(33554431&e)<<5;for(let e=0;e<R.length;e++)1==(t>>e&1)&&(n^=R[e]);return n}function P(e,t,n=1){const r=e.length;let s=1;for(let t=0;t<r;t++){const n=e.charCodeAt(t);if(n<33||n>126)throw new Error(`Invalid prefix (${e})`);s=V(s)^n>>5}s=V(s);for(let t=0;t<r;t++)s=V(s)^31&e.charCodeAt(t);for(let e of t)s=V(s)^e;for(let e=0;e<6;e++)s=V(s);return s^=n,L.encode(C([s%I[30]],30,5,!1))}function F(e){const t="bech32"===e?1:734539939,n=B(5),r=n.decode,s=n.encode,a=O(r);function i(e,n,r=90){g("bech32.encode prefix",e),h(n)&&(n=Array.from(n)),w("bech32.encode",n);const s=e.length;if(0===s)throw new TypeError(`Invalid prefix length ${s}`);const a=s+7+n.length;if(!1!==r&&a>r)throw new TypeError(`Length ${a} exceeds limit ${r}`);const i=e.toLowerCase(),o=P(i,n,t);return`${i}1${L.encode(n)}${o}`}function o(e,n=90){g("bech32.decode input",e);const r=e.length;if(r<8||!1!==n&&r>n)throw new TypeError(`invalid string length: ${r} (${e}). Expected (8..${n})`);const s=e.toLowerCase();if(e!==s&&e!==e.toUpperCase())throw new Error("String must be lowercase or uppercase");const a=s.lastIndexOf("1");if(0===a||-1===a)throw new Error('Letter "1" must be present between prefix and data only');const i=s.slice(0,a),o=s.slice(a+1);if(o.length<6)throw new Error("Data must be at least 6 characters long");const c=L.decode(o).slice(0,-6),l=P(i,c,t);if(!o.endsWith(l))throw new Error(`Invalid checksum in ${e}: expected "${l}"`);return{prefix:i,words:c}}return{encode:i,decode:o,encodeFromBytes:function(e,t){return i(e,s(t))},decodeToBytes:function(e){const{prefix:t,words:n}=o(e,!1);return{prefix:t,words:n,bytes:r(n)}},decodeUnsafe:O(o),fromWords:r,fromWordsUnsafe:a,toWords:s}}F("bech32"),F("bech32m");b(B(4),v("0123456789abcdef"),E(""),k(e=>{if("string"!=typeof e||e.length%2!=0)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}));var U=n(556);function M(e){return $.test(e)}const $=/^-?[0-9]+$/;function H(e){return z.test(e)}const z=/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?$/;let j=function(e){return e.underflow="underflow",e.overflow="overflow",e.truncate_integer="truncate_integer",e.truncate_float="truncate_float",e}({});function q(e){const{start:t,end:n}=function(e){let t=0;for("-"===e[0]&&t++;"0"===e[t]||"."===e[t];)t++;let n=e.lastIndexOf("e");for(-1===n&&(n=e.lastIndexOf("E")),-1===n&&(n=e.length);("0"===e[n-1]||"."===e[n-1])&&n>t;)n--;return{start:t,end:n}}(e),r=e.substring(t,n),s=r.indexOf(".");return-1===s?r:r.substring(0,s)+r.substring(s+1)}class K{isLosslessNumber=!0;constructor(e){if(!H(e))throw new Error(`Invalid number (value: "${e}")`);this.value=e}valueOf(){const e=function(e){if(function(e){const t=Number.parseFloat(e),n=String(t);if(e===n)return!0;return q(e)===q(n)}(e))return;if(M(e))return j.truncate_integer;const t=Number.parseFloat(e);return Number.isFinite(t)?0===t?j.underflow:j.truncate_float:j.overflow}(this.value);if(void 0===e||e===j.truncate_float)return Number.parseFloat(this.value);if(M(this.value))return BigInt(this.value);throw new Error(`Cannot safely convert to number: the value '${this.value}' would ${e} and become ${Number.parseFloat(this.value)}`)}toString(){return this.value}}function W(e){return new K(e)}function Z(e){return M(e)?BigInt(e):Number.parseFloat(e)}function Y(e,t,n,r){return Array.isArray(n)?r.call(e,t,function(e,t){for(let n=0;n<e.length;n++)e[n]=Y(e,String(n),e[n],t);return e}(n,r)):n&&"object"==typeof n&&!function(e){return e&&"object"==typeof e&&e.isLosslessNumber||!1}(n)?r.call(e,t,function(e,t){for(const n of Object.keys(e)){const r=Y(e,n,e[n],t);void 0!==r?e[n]=r:delete e[n]}return e}(n,r)):r.call(e,t,n)}function G(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:W,r=0;const s=a();return function(e){if(void 0===e)throw new SyntaxError(`JSON value expected ${b()}`)}(s),function(){if(r<e.length)throw new SyntaxError(`Expected end of input ${b()}`)}(),t?function(e,t){return Y({"":e},"",e,t)}(s,t):s;function a(){o();const t=c()??function(){const t=r;if(e.charCodeAt(r)===ge&&(r++,h(t)),e.charCodeAt(r)===me)r++;else if((s=e.charCodeAt(r))>=ye&&s<=_e)for(r++;Q(e.charCodeAt(r));)r++;var s;if(e.charCodeAt(r)===be)for(r++,h(t);Q(e.charCodeAt(r));)r++;if(e.charCodeAt(r)===Se||e.charCodeAt(r)===ke)for(r++,e.charCodeAt(r)!==ge&&e.charCodeAt(r)!==pe||r++,h(t);Q(e.charCodeAt(r));)r++;if(r>t)return n(e.slice(t,r))}()??function(){if(e.charCodeAt(r)===ae){r++,o();const t={};let n=!0;for(;r<e.length&&e.charCodeAt(r)!==ie;){n?n=!1:(l(),o());const e=r,s=c();if(void 0===s)return void f();o(),d();const i=a();if(void 0===i)return void y();Object.prototype.hasOwnProperty.call(t,s)&&!te(i,t[s])&&p(s,e+1),t[s]=i}return e.charCodeAt(r)!==ie&&function(){throw new SyntaxError(`Quoted object key or end of object '}' expected ${b()}`)}(),r++,t}}()??function(){if(e.charCodeAt(r)===oe){r++,o();const t=[];let n=!0;for(;r<e.length&&e.charCodeAt(r)!==ce;){n?n=!1:l();const e=a();u(e),t.push(e)}return e.charCodeAt(r)!==ce&&function(){throw new SyntaxError(`Array item or end of array ']' expected ${b()}`)}(),r++,t}}()??i("true",!0)??i("false",!1)??i("null",null);return o(),t}function i(t,n){if(e.slice(r,r+t.length)===t)return r+=t.length,n}function o(){for(;X(e.charCodeAt(r));)r++}function c(){if(e.charCodeAt(r)===fe){r++;let t="";for(;r<e.length&&e.charCodeAt(r)!==fe;){if(e.charCodeAt(r)===se){const n=e[r+1],s=re[n];void 0!==s?(t+=s,r++):"u"===n?J(e.charCodeAt(r+2))&&J(e.charCodeAt(r+3))&&J(e.charCodeAt(r+4))&&J(e.charCodeAt(r+5))?(t+=String.fromCharCode(Number.parseInt(e.slice(r+2,r+6),16)),r+=5):_(r):m(r)}else ee(e.charCodeAt(r))?t+=e[r]:g(e[r]);r++}return function(){if(e.charCodeAt(r)!==fe)throw new SyntaxError(`End of string '"' expected ${b()}`)}(),r++,t}}function l(){if(e.charCodeAt(r)!==we)throw new SyntaxError(`Comma ',' expected after value ${b()}`);r++}function d(){if(e.charCodeAt(r)!==ve)throw new SyntaxError(`Colon ':' expected after property name ${b()}`);r++}function u(e){if(void 0===e)throw new SyntaxError(`Array item expected ${b()}`)}function h(t){if(!Q(e.charCodeAt(r))){const n=e.slice(t,r);throw new SyntaxError(`Invalid number '${n}', expecting a digit ${b()}`)}}function f(){throw new SyntaxError(`Quoted object key expected ${b()}`)}function p(e,t){throw new SyntaxError(`Duplicate key '${e}' encountered at position ${t}`)}function g(e){throw new SyntaxError(`Invalid character '${e}' ${w()}`)}function m(t){const n=e.slice(t,t+2);throw new SyntaxError(`Invalid escape character '${n}' ${w()}`)}function y(){throw new SyntaxError(`Object value expected after ':' ${w()}`)}function _(t){const n=e.slice(t,t+6);throw new SyntaxError(`Invalid unicode character '${n}' ${w()}`)}function w(){return`at position ${r}`}function b(){return`${r<e.length?`but got '${e[r]}'`:"but reached end of input"} ${w()}`}}function X(e){return e===le||e===de||e===ue||e===he}function J(e){return e>=me&&e<=_e||e>=Ee&&e<=Te||e>=Ae&&e<=xe}function Q(e){return e>=me&&e<=_e}function ee(e){return e>=32&&e<=1114111}function te(e,t){return e===t||(Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every((e,n)=>te(e,t[n])):!(!ne(e)||!ne(t))&&[...new Set([...Object.keys(e),...Object.keys(t)])].every(n=>te(e[n],t[n])))}function ne(e){return"object"==typeof e&&null!==e}const re={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},se=92,ae=123,ie=125,oe=91,ce=93,le=32,de=10,ue=9,he=13,fe=34,pe=43,ge=45,me=48,ye=49,_e=57,we=44,be=46,ve=58,Ee=65,Ae=97,ke=69,Se=101,Te=70,xe=102;function Ie(e,t,n,r){const s=function(e){return"number"==typeof e?" ".repeat(e):"string"==typeof e&&""!==e?e:void 0}(n);return function e(i,o){if(Array.isArray(r)){const e=r.find(e=>e.test(i));if(e){const t=e.stringify(i);if("string"!=typeof t||!H(t))throw new Error(`Invalid JSON number: output of a number stringifier must be a string containing a JSON number (output: ${t})`);return t}}return"boolean"==typeof i||"number"==typeof i||"string"==typeof i||null===i||i instanceof Date||i instanceof Boolean||i instanceof Number||i instanceof String?JSON.stringify(i):i?.isLosslessNumber||"bigint"==typeof i?i.toString():Array.isArray(i)?function(n,r){if(0===n.length)return"[]";const a=s?r+s:void 0;let i=s?"[\n":"[";for(let r=0;r<n.length;r++){const o="function"==typeof t?t.call(n,String(r),n[r]):n[r];s&&(i+=a),i+=void 0!==o&&"function"!=typeof o?e(o,a):"null",r<n.length-1&&(i+=s?",\n":",")}return i+=s?`\n${r}]`:"]",i}(i,o):i&&"object"==typeof i?function(r,i){if("function"==typeof r.toJSON)return Ie(r.toJSON(),t,n,void 0);const o=Array.isArray(t)?t.map(String):Object.keys(r);if(0===o.length)return"{}";const c=s?i+s:void 0;let l=!0,d=s?"{\n":"{";for(const n of o){const i="function"==typeof t?t.call(r,n,r[n]):r[n];if(a(0,i)){l?l=!1:d+=s?",\n":",";const t=JSON.stringify(n);d+=s?`${c+t}: `:`${t}:`,d+=e(i,c)}}return d+=s?`\n${i}}`:"}",d}(i,o):void 0}("function"==typeof t?t.call({"":e},"",e):e,"");function a(e,t){return void 0!==t&&"function"!=typeof t&&"symbol"!=typeof t}}const Ce=BigInt(0),Be=BigInt(1),Oe=BigInt(2);function Ne(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function De(e){if(!Ne(e))throw new Error("Uint8Array expected")}function Le(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}const Re=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Ve(e){De(e);let t="";for(let n=0;n<e.length;n++)t+=Re[e[n]];return t}function Pe(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function Fe(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?Ce:BigInt("0x"+e)}const Ue={_0:48,_9:57,A:65,F:70,a:97,f:102};function Me(e){return e>=Ue._0&&e<=Ue._9?e-Ue._0:e>=Ue.A&&e<=Ue.F?e-(Ue.A-10):e>=Ue.a&&e<=Ue.f?e-(Ue.a-10):void 0}function $e(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let t=0,s=0;t<n;t++,s+=2){const n=Me(e.charCodeAt(s)),a=Me(e.charCodeAt(s+1));if(void 0===n||void 0===a){const t=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+s)}r[t]=16*n+a}return r}function He(e){return Fe(Ve(e))}function ze(e){return De(e),Fe(Ve(Uint8Array.from(e).reverse()))}function je(e,t){return $e(e.toString(16).padStart(2*t,"0"))}function qe(e,t){return je(e,t).reverse()}function Ke(e){return $e(Pe(e))}function We(e,t,n){let r;if("string"==typeof t)try{r=$e(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!Ne(t))throw new Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}const s=r.length;if("number"==typeof n&&s!==n)throw new Error(e+" of length "+n+" expected, got "+s);return r}function Ze(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];De(r),t+=r.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const s=e[t];n.set(s,r),r+=s.length}return n}const Ye=e=>"bigint"==typeof e&&Ce<=e;function Ge(e,t,n){return Ye(e)&&Ye(t)&&Ye(n)&&t<=e&&e<n}function Xe(e,t,n,r){if(!Ge(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function Je(e){let t;for(t=0;e>Ce;e>>=Be,t+=1);return t}const Qe=e=>(Oe<<BigInt(e-1))-Be,et=e=>new Uint8Array(e),tt=e=>Uint8Array.from(e);function nt(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=et(e),s=et(e),a=0;const i=()=>{r.fill(1),s.fill(0),a=0},o=(...e)=>n(s,r,...e),c=(e=et())=>{s=o(tt([0]),e),r=o(),0!==e.length&&(s=o(tt([1]),e),r=o())},l=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=o();const t=r.slice();n.push(t),e+=r.length}return Ze(...n)};return(e,t)=>{let n;for(i(),c(e);!(n=t(l()));)c();return i(),n}}const rt={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||Ne(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function st(e,t,n={}){const r=(t,n,r)=>{const s=rt[n];if("function"!=typeof s)throw new Error("invalid validator function");const a=e[t];if(!(r&&void 0===a||s(a,e)))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+a)};for(const[e,n]of Object.entries(t))r(e,n,!1);for(const[e,t]of Object.entries(n))r(e,t,!0);return e}function at(e){const t=new WeakMap;return(n,...r)=>{const s=t.get(n);if(void 0!==s)return s;const a=e(n,...r);return t.set(n,a),a}}function it(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function ot(e,...t){if(!((n=e)instanceof Uint8Array||ArrayBuffer.isView(n)&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ct(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function lt(e,t){ot(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const dt="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,ut=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),ht=(e,t)=>e<<32-t|e>>>t,ft=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])(),pt=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;function gt(e){for(let t=0;t<e.length;t++)e[t]=pt(e[t])}function mt(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function yt(e){return"string"==typeof e&&(e=mt(e)),ot(e),e}class _t{clone(){return this._cloneInto()}}function wt(e){const t=t=>e().update(yt(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function bt(e=32){if(dt&&"function"==typeof dt.getRandomValues)return dt.getRandomValues(new Uint8Array(e));if(dt&&"function"==typeof dt.randomBytes)return dt.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}const vt=(e,t,n)=>e&t^~e&n,Et=(e,t,n)=>e&t^e&n^t&n;class At extends _t{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ut(this.buffer)}update(e){ct(this);const{view:t,buffer:n,blockLen:r}=this,s=(e=yt(e)).length;for(let a=0;a<s;){const i=Math.min(r-this.pos,s-a);if(i===r){const t=ut(e);for(;r<=s-a;a+=r)this.process(t,a);continue}n.set(e.subarray(a,a+i),this.pos),this.pos+=i,a+=i,this.pos===r&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ct(this),lt(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:s}=this;let{pos:a}=this;t[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>r-a&&(this.process(n,0),a=0);for(let e=a;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const s=BigInt(32),a=BigInt(4294967295),i=Number(n>>s&a),o=Number(n&a),c=r?4:0,l=r?0:4;e.setUint32(t+c,i,r),e.setUint32(t+l,o,r)}(n,r-8,BigInt(8*this.length),s),this.process(n,0);const i=ut(e),o=this.outputLen;if(o%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=o/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)i.setUint32(4*e,l[e],s)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:s,destroyed:a,pos:i}=this;return e.length=r,e.pos=i,e.finished=s,e.destroyed=a,r%t&&e.buffer.set(n),e}}const kt=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),St=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Tt=new Uint32Array(64);class xt extends At{constructor(){super(64,32,8,!1),this.A=0|St[0],this.B=0|St[1],this.C=0|St[2],this.D=0|St[3],this.E=0|St[4],this.F=0|St[5],this.G=0|St[6],this.H=0|St[7]}get(){const{A:e,B:t,C:n,D:r,E:s,F:a,G:i,H:o}=this;return[e,t,n,r,s,a,i,o]}set(e,t,n,r,s,a,i,o){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|s,this.F=0|a,this.G=0|i,this.H=0|o}process(e,t){for(let n=0;n<16;n++,t+=4)Tt[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=Tt[e-15],n=Tt[e-2],r=ht(t,7)^ht(t,18)^t>>>3,s=ht(n,17)^ht(n,19)^n>>>10;Tt[e]=s+Tt[e-7]+r+Tt[e-16]|0}let{A:n,B:r,C:s,D:a,E:i,F:o,G:c,H:l}=this;for(let e=0;e<64;e++){const t=l+(ht(i,6)^ht(i,11)^ht(i,25))+vt(i,o,c)+kt[e]+Tt[e]|0,d=(ht(n,2)^ht(n,13)^ht(n,22))+Et(n,r,s)|0;l=c,c=o,o=i,i=a+t|0,a=s,s=r,r=n,n=t+d|0}n=n+this.A|0,r=r+this.B|0,s=s+this.C|0,a=a+this.D|0,i=i+this.E|0,o=o+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(n,r,s,a,i,o,c,l)}roundClean(){Tt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const It=wt(()=>new xt),Ct=BigInt(2**32-1),Bt=BigInt(32);function Ot(e,t=!1){return t?{h:Number(e&Ct),l:Number(e>>Bt&Ct)}:{h:0|Number(e>>Bt&Ct),l:0|Number(e&Ct)}}function Nt(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:a,l:i}=Ot(e[s],t);[n[s],r[s]]=[a,i]}return[n,r]}const Dt=[],Lt=[],Rt=[],Vt=BigInt(0),Pt=BigInt(1),Ft=BigInt(2),Ut=BigInt(7),Mt=BigInt(256),$t=BigInt(113);for(let e=0,t=Pt,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],Dt.push(2*(5*r+n)),Lt.push((e+1)*(e+2)/2%64);let s=Vt;for(let e=0;e<7;e++)t=(t<<Pt^(t>>Ut)*$t)%Mt,t&Ft&&(s^=Pt<<(Pt<<BigInt(e))-Pt);Rt.push(s)}const[Ht,zt]=Nt(Rt,!0),jt=(e,t,n)=>n>32?((e,t,n)=>t<<n-32|e>>>64-n)(e,t,n):((e,t,n)=>e<<n|t>>>32-n)(e,t,n),qt=(e,t,n)=>n>32?((e,t,n)=>e<<n-32|t>>>64-n)(e,t,n):((e,t,n)=>t<<n|e>>>32-n)(e,t,n);class Kt extends _t{constructor(e,t,n,r=!1,s=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=r,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,it(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");var a;this.state=new Uint8Array(200),this.state32=(a=this.state,new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4)))}keccak(){ft||gt(this.state32),function(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let t=0;t<10;t++)n[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const r=(t+8)%10,s=(t+2)%10,a=n[s],i=n[s+1],o=jt(a,i,1)^n[r],c=qt(a,i,1)^n[r+1];for(let n=0;n<50;n+=10)e[t+n]^=o,e[t+n+1]^=c}let t=e[2],s=e[3];for(let n=0;n<24;n++){const r=Lt[n],a=jt(t,s,r),i=qt(t,s,r),o=Dt[n];t=e[o],s=e[o+1],e[o]=a,e[o+1]=i}for(let t=0;t<50;t+=10){for(let r=0;r<10;r++)n[r]=e[t+r];for(let r=0;r<10;r++)e[t+r]^=~n[(r+2)%10]&n[(r+4)%10]}e[0]^=Ht[r],e[1]^=zt[r]}n.fill(0)}(this.state32,this.rounds),ft||gt(this.state32),this.posOut=0,this.pos=0}update(e){ct(this);const{blockLen:t,state:n}=this,r=(e=yt(e)).length;for(let s=0;s<r;){const a=Math.min(t-this.pos,r-s);for(let t=0;t<a;t++)n[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:r}=this;e[n]^=t,128&t&&n===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}writeInto(e){ct(this,!1),ot(e),this.finish();const t=this.state,{blockLen:n}=this;for(let r=0,s=e.length;r<s;){this.posOut>=n&&this.keccak();const a=Math.min(n-this.posOut,s-r);e.set(t.subarray(this.posOut,this.posOut+a),r),this.posOut+=a,r+=a}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return it(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(lt(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:r,rounds:s,enableXOF:a}=this;return e||(e=new Kt(t,n,r,a,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=r,e.enableXOF=a,e.destroyed=this.destroyed,e}}const Wt=((e,t,n)=>wt(()=>new Kt(t,e,n)))(1,136,32),Zt=BigInt(0),Yt=BigInt(1),Gt=BigInt(2),Xt=BigInt(3),Jt=BigInt(4),Qt=BigInt(5),en=BigInt(8);function tn(e,t){const n=e%t;return n>=Zt?n:t+n}function nn(e,t,n){if(t<Zt)throw new Error("invalid exponent, negatives unsupported");if(n<=Zt)throw new Error("invalid modulus");if(n===Yt)return Zt;let r=Yt;for(;t>Zt;)t&Yt&&(r=r*e%n),e=e*e%n,t>>=Yt;return r}function rn(e,t,n){let r=e;for(;t-- >Zt;)r*=r,r%=n;return r}function sn(e,t){if(e===Zt)throw new Error("invert: expected non-zero number");if(t<=Zt)throw new Error("invert: expected positive modulus, got "+t);let n=tn(e,t),r=t,s=Zt,a=Yt,i=Yt,o=Zt;for(;n!==Zt;){const e=r/n,t=r%n,c=s-i*e,l=a-o*e;r=n,n=t,s=i,a=o,i=c,o=l}if(r!==Yt)throw new Error("invert: does not exist");return tn(s,t)}const an=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function on(e){return st(e,an.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function cn(e,t,n){if(n<Zt)throw new Error("invalid exponent, negatives unsupported");if(n===Zt)return e.ONE;if(n===Yt)return t;let r=e.ONE,s=t;for(;n>Zt;)n&Yt&&(r=e.mul(r,s)),s=e.sqr(s),n>>=Yt;return r}function ln(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function dn(e,t,n=!1,r={}){if(e<=Zt)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:s,nByteLength:a}=ln(e,t);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let i;const o=Object.freeze({ORDER:e,BITS:s,BYTES:a,MASK:Qe(s),ZERO:Zt,ONE:Yt,create:t=>tn(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return Zt<=t&&t<e},is0:e=>e===Zt,isOdd:e=>(e&Yt)===Yt,neg:t=>tn(-t,e),eql:(e,t)=>e===t,sqr:t=>tn(t*t,e),add:(t,n)=>tn(t+n,e),sub:(t,n)=>tn(t-n,e),mul:(t,n)=>tn(t*n,e),pow:(e,t)=>cn(o,e,t),div:(t,n)=>tn(t*sn(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>sn(t,e),sqrt:r.sqrt||(t=>(i||(i=function(e){if(e%Jt===Xt){const t=(e+Yt)/Jt;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%en===Qt){const t=(e-Qt)/en;return function(e,n){const r=e.mul(n,Gt),s=e.pow(r,t),a=e.mul(n,s),i=e.mul(e.mul(a,Gt),s),o=e.mul(a,e.sub(i,e.ONE));if(!e.eql(e.sqr(o),n))throw new Error("Cannot find square root");return o}}return function(e){const t=(e-Yt)/Gt;let n,r,s;for(n=e-Yt,r=0;n%Gt===Zt;n/=Gt,r++);for(s=Gt;s<e&&nn(s,t,e)!==e-Yt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===r){const t=(e+Yt)/Jt;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const a=(n+Yt)/Gt;return function(e,i){if(e.pow(i,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let o=r,c=e.pow(e.mul(e.ONE,s),n),l=e.pow(i,a),d=e.pow(i,n);for(;!e.eql(d,e.ONE);){if(e.eql(d,e.ZERO))return e.ZERO;let t=1;for(let n=e.sqr(d);t<o&&!e.eql(n,e.ONE);t++)n=e.sqr(n);const n=e.pow(c,Yt<<BigInt(o-t-1));c=e.sqr(n),l=e.mul(l,n),d=e.mul(d,c),o=t}return l}}(e)}(e)),i(o,t))),invertBatch:e=>function(e,t){const n=new Array(t.length),r=t.reduce((t,r,s)=>e.is0(r)?t:(n[s]=t,e.mul(t,r)),e.ONE),s=e.inv(r);return t.reduceRight((t,r,s)=>e.is0(r)?t:(n[s]=e.mul(t,n[s]),e.mul(t,r)),s),n}(o,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?qe(e,a):je(e,a),fromBytes:e=>{if(e.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+e.length);return n?ze(e):He(e)}});return Object.freeze(o)}function un(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function hn(e){const t=un(e);return t+Math.ceil(t/2)}function fn(e){const{Fp:t,mds:n,reversePartialPowIdx:r,roundConstants:s}=e,{roundsFull:a,roundsPartial:i,sboxPower:o,t:c}=e;on(t);for(const t of["t","roundsFull","roundsPartial"])if("number"!=typeof e[t]||!Number.isSafeInteger(e[t]))throw new Error("invalid number "+t);if(!Array.isArray(n)||n.length!==c)throw new Error("Poseidon: invalid MDS matrix");const l=n.map(e=>{if(!Array.isArray(e)||e.length!==c)throw new Error("invalid MDS matrix row: "+e);return e.map(e=>{if("bigint"!=typeof e)throw new Error("invalid MDS matrix bigint: "+e);return t.create(e)})});if(void 0!==r&&"boolean"!=typeof r)throw new Error("invalid param reversePartialPowIdx="+r);if(1&a)throw new Error("roundsFull is not even"+a);const d=a+i;if(!Array.isArray(s)||s.length!==d)throw new Error("Poseidon: invalid round constants");const u=s.map(e=>{if(!Array.isArray(e)||e.length!==c)throw new Error("invalid round constants");return e.map(e=>{if("bigint"!=typeof e||!t.isValid(e))throw new Error("invalid round constant");return t.create(e)})});if(!o||![3,5,7].includes(o))throw new Error("invalid sboxPower");const h=BigInt(o);let f=e=>cn(t,e,h);return 3===o?f=e=>t.mul(t.sqrN(e),e):5===o&&(f=e=>t.mul(t.sqrN(t.sqrN(e)),e)),Object.freeze({...e,rounds:d,sboxFn:f,roundConstants:u,mds:l})}function pn(e,t){if("number"!=typeof t)throw new Error("poseidonSplitConstants: invalid t");if(!Array.isArray(e)||e.length%t)throw new Error("poseidonSplitConstants: invalid rc");const n=[];let r=[];for(let s=0;s<e.length;s++)r.push(e[s]),r.length===t&&(n.push(r),r=[]);return n}function gn(e){const t=fn(e),{Fp:n,mds:r,roundConstants:s,rounds:a,roundsPartial:i,sboxFn:o,t:c}=t,l=t.roundsFull/2,d=t.reversePartialPowIdx?c-1:0,u=(e,t,a)=>(e=e.map((e,t)=>n.add(e,s[a][t])),t?e=e.map(e=>o(e)):e[d]=o(e[d]),e=r.map(t=>t.reduce((t,r,s)=>n.add(t,n.mulN(r,e[s])),n.ZERO))),h=function(e){if(!Array.isArray(e)||e.length!==c)throw new Error("invalid values, expected array of bigints with length "+c);e=e.map(e=>{if("bigint"!=typeof e)throw new Error("invalid bigint="+e);return n.create(e)});let t=0;for(let n=0;n<l;n++)e=u(e,!0,t++);for(let n=0;n<i;n++)e=u(e,!1,t++);for(let n=0;n<l;n++)e=u(e,!0,t++);if(t!==a)throw new Error("invalid number of rounds");return e};return h.roundConstants=s,h}const mn=BigInt(0),yn=BigInt(1);function _n(e,t){const n=t.negate();return e?n:t}function wn(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function bn(e,t){return wn(e,t),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}const vn=new WeakMap,En=new WeakMap;function An(e){return En.get(e)||1}function kn(e){return on(e.Fp),st(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ln(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function Sn(e){void 0!==e.lowS&&Le("lowS",e.lowS),void 0!==e.prehash&&Le("prehash",e.prehash)}const{Ph:Tn,aT:xn}=r,In={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{const{Err:n}=In;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&t.length)throw new n("tlv.encode: unpadded data");const r=t.length/2,s=Pe(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const a=r>127?Pe(s.length/2|128):"";return Pe(e)+a+s+t},decode(e,t){const{Err:n}=In;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const s=t[r++];let a=0;if(128&s){const e=127&s;if(!e)throw new n("tlv.decode(long): indefinite length not supported");if(e>4)throw new n("tlv.decode(long): byte length is too big");const i=t.subarray(r,r+e);if(i.length!==e)throw new n("tlv.decode: length bytes not complete");if(0===i[0])throw new n("tlv.decode(long): zero leftmost byte");for(const e of i)a=a<<8|e;if(r+=e,a<128)throw new n("tlv.decode(long): not minimal encoding")}else a=s;const i=t.subarray(r,r+a);if(i.length!==a)throw new n("tlv.decode: wrong value length");return{v:i,l:t.subarray(r+a)}}},_int:{encode(e){const{Err:t}=In;if(e<Cn)throw new t("integer: negative integers are not allowed");let n=Pe(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=In;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return Tn(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=In,s="string"==typeof e?xn(e):e;De(s);const{v:a,l:i}=r.decode(48,s);if(i.length)throw new t("invalid signature: left bytes after parsing");const{v:o,l:c}=r.decode(2,a),{v:l,l:d}=r.decode(2,c);if(d.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(o),s:n.decode(l)}},hexFromSig(e){const{_tlv:t,_int:n}=In,r=t.encode(2,n.encode(e.r))+t.encode(2,n.encode(e.s));return t.encode(48,r)}},Cn=BigInt(0),Bn=BigInt(1),On=BigInt(2),Nn=BigInt(3),Dn=BigInt(4);function Ln(e){const t=function(e){const t=kn(e);st(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=t;if(n){if(!r.eql(s,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:n}=t,r=dn(t.n,t.nBitLength),s=t.toBytes||((e,t,r)=>{const s=t.toAffine();return Ze(Uint8Array.from([4]),n.toBytes(s.x),n.toBytes(s.y))}),a=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function i(e){const{a:r,b:s}=t,a=n.sqr(e),i=n.mul(a,e);return n.add(n.add(i,n.mul(e,r)),s)}if(!n.eql(n.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function o(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:s,n:a}=t;if(n&&"bigint"!=typeof e){if(Ne(e)&&(e=Ve(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*r,"0")}let i;try{i="bigint"==typeof e?e:He(We("private key",e,r))}catch(t){throw new Error("invalid private key, expected hex or "+r+" bytes, got "+typeof e)}return s&&(i=tn(i,a)),Xe("private key",i,Bn,a),i}function c(e){if(!(e instanceof u))throw new Error("ProjectivePoint expected")}const l=at((e,t)=>{const{px:r,py:s,pz:a}=e;if(n.eql(a,n.ONE))return{x:r,y:s};const i=e.is0();null==t&&(t=i?n.ONE:n.inv(a));const o=n.mul(r,t),c=n.mul(s,t),l=n.mul(a,t);if(i)return{x:n.ZERO,y:n.ZERO};if(!n.eql(l,n.ONE))throw new Error("invZ was invalid");return{x:o,y:c}}),d=at(e=>{if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:r,y:s}=e.toAffine();if(!n.isValid(r)||!n.isValid(s))throw new Error("bad point: x or y not FE");const a=n.sqr(s),o=i(r);if(!n.eql(a,o))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class u{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required");Object.freeze(this)}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof u)throw new Error("projective point not allowed");const s=e=>n.eql(e,n.ZERO);return s(t)&&s(r)?u.ZERO:new u(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map(e=>e.pz));return e.map((e,n)=>e.toAffine(t[n])).map(u.fromAffine)}static fromHex(e){const t=u.fromAffine(a(We("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return u.BASE.multiply(o(e))}static msm(e,t){return function(e,t,n,r){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)})}(n,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}(r,t),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=e.ZERO,a=Je(BigInt(n.length)),i=a>12?a-3:a>4?a-2:a?2:1,o=(1<<i)-1,c=new Array(o+1).fill(s);let l=s;for(let e=Math.floor((t.BITS-1)/i)*i;e>=0;e-=i){c.fill(s);for(let t=0;t<r.length;t++){const s=r[t],a=Number(s>>BigInt(e)&BigInt(o));c[a]=c[a].add(n[t])}let t=s;for(let e=c.length-1,n=s;e>0;e--)n=n.add(c[e]),t=t.add(n);if(l=l.add(t),0!==e)for(let e=0;e<i;e++)l=l.double()}return l}(u,r,e,t)}_setWindowSize(e){f.setWindowSize(this,e)}assertValidity(){d(this)}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){c(e);const{px:t,py:r,pz:s}=this,{px:a,py:i,pz:o}=e,l=n.eql(n.mul(t,o),n.mul(a,s)),d=n.eql(n.mul(r,o),n.mul(i,s));return l&&d}negate(){return new u(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,s=n.mul(r,Nn),{px:a,py:i,pz:o}=this;let c=n.ZERO,l=n.ZERO,d=n.ZERO,h=n.mul(a,a),f=n.mul(i,i),p=n.mul(o,o),g=n.mul(a,i);return g=n.add(g,g),d=n.mul(a,o),d=n.add(d,d),c=n.mul(e,d),l=n.mul(s,p),l=n.add(c,l),c=n.sub(f,l),l=n.add(f,l),l=n.mul(c,l),c=n.mul(g,c),d=n.mul(s,d),p=n.mul(e,p),g=n.sub(h,p),g=n.mul(e,g),g=n.add(g,d),d=n.add(h,h),h=n.add(d,h),h=n.add(h,p),h=n.mul(h,g),l=n.add(l,h),p=n.mul(i,o),p=n.add(p,p),h=n.mul(p,g),c=n.sub(c,h),d=n.mul(p,f),d=n.add(d,d),d=n.add(d,d),new u(c,l,d)}add(e){c(e);const{px:r,py:s,pz:a}=this,{px:i,py:o,pz:l}=e;let d=n.ZERO,h=n.ZERO,f=n.ZERO;const p=t.a,g=n.mul(t.b,Nn);let m=n.mul(r,i),y=n.mul(s,o),_=n.mul(a,l),w=n.add(r,s),b=n.add(i,o);w=n.mul(w,b),b=n.add(m,y),w=n.sub(w,b),b=n.add(r,a);let v=n.add(i,l);return b=n.mul(b,v),v=n.add(m,_),b=n.sub(b,v),v=n.add(s,a),d=n.add(o,l),v=n.mul(v,d),d=n.add(y,_),v=n.sub(v,d),f=n.mul(p,b),d=n.mul(g,_),f=n.add(d,f),d=n.sub(y,f),f=n.add(y,f),h=n.mul(d,f),y=n.add(m,m),y=n.add(y,m),_=n.mul(p,_),b=n.mul(g,b),y=n.add(y,_),_=n.sub(m,_),_=n.mul(p,_),b=n.add(b,_),m=n.mul(y,b),h=n.add(h,m),m=n.mul(v,b),d=n.mul(w,d),d=n.sub(d,m),m=n.mul(w,y),f=n.mul(v,f),f=n.add(f,m),new u(d,h,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(u.ZERO)}wNAF(e){return f.wNAFCached(this,e,u.normalizeZ)}multiplyUnsafe(e){const{endo:r,n:s}=t;Xe("scalar",e,Cn,s);const a=u.ZERO;if(e===Cn)return a;if(this.is0()||e===Bn)return this;if(!r||f.hasPrecomputes(this))return f.wNAFCachedUnsafe(this,e,u.normalizeZ);let{k1neg:i,k1:o,k2neg:c,k2:l}=r.splitScalar(e),d=a,h=a,p=this;for(;o>Cn||l>Cn;)o&Bn&&(d=d.add(p)),l&Bn&&(h=h.add(p)),p=p.double(),o>>=Bn,l>>=Bn;return i&&(d=d.negate()),c&&(h=h.negate()),h=new u(n.mul(h.px,r.beta),h.py,h.pz),d.add(h)}multiply(e){const{endo:r,n:s}=t;let a,i;if(Xe("scalar",e,Bn,s),r){const{k1neg:t,k1:s,k2neg:o,k2:c}=r.splitScalar(e);let{p:l,f:d}=this.wNAF(s),{p:h,f:p}=this.wNAF(c);l=f.constTimeNegate(t,l),h=f.constTimeNegate(o,h),h=new u(n.mul(h.px,r.beta),h.py,h.pz),a=l.add(h),i=d.add(p)}else{const{p:t,f:n}=this.wNAF(e);a=t,i=n}return u.normalizeZ([a,i])[0]}multiplyAndAddUnsafe(e,t,n){const r=u.BASE,s=(e,t)=>t!==Cn&&t!==Bn&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),a=s(this,t).add(s(e,n));return a.is0()?void 0:a}toAffine(e){return l(this,e)}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===Bn)return!0;if(n)return n(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===Bn?this:n?n(u,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return Le("isCompressed",e),this.assertValidity(),s(u,this,e)}toHex(e=!0){return Le("isCompressed",e),Ve(this.toRawBytes(e))}}u.BASE=new u(t.Gx,t.Gy,n.ONE),u.ZERO=new u(n.ZERO,n.ONE,n.ZERO);const h=t.nBitLength,f=(p=u,g=t.endo?Math.ceil(h/2):h,{constTimeNegate:_n,hasPrecomputes:e=>1!==An(e),unsafeLadder(e,t,n=p.ZERO){let r=e;for(;t>mn;)t&yn&&(n=n.add(r)),r=r.double(),t>>=yn;return n},precomputeWindow(e,t){const{windows:n,windowSize:r}=bn(t,g),s=[];let a=e,i=a;for(let e=0;e<n;e++){i=a,s.push(i);for(let e=1;e<r;e++)i=i.add(a),s.push(i);a=i.double()}return s},wNAF(e,t,n){const{windows:r,windowSize:s}=bn(e,g);let a=p.ZERO,i=p.BASE;const o=BigInt(2**e-1),c=2**e,l=BigInt(e);for(let e=0;e<r;e++){const r=e*s;let d=Number(n&o);n>>=l,d>s&&(d-=c,n+=yn);const u=r,h=r+Math.abs(d)-1,f=e%2!=0,p=d<0;0===d?i=i.add(_n(f,t[u])):a=a.add(_n(p,t[h]))}return{p:a,f:i}},wNAFUnsafe(e,t,n,r=p.ZERO){const{windows:s,windowSize:a}=bn(e,g),i=BigInt(2**e-1),o=2**e,c=BigInt(e);for(let e=0;e<s;e++){const s=e*a;if(n===mn)break;let l=Number(n&i);if(n>>=c,l>a&&(l-=o,n+=yn),0===l)continue;let d=t[s+Math.abs(l)-1];l<0&&(d=d.negate()),r=r.add(d)}return r},getPrecomputes(e,t,n){let r=vn.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&vn.set(t,n(r))),r},wNAFCached(e,t,n){const r=An(e);return this.wNAF(r,this.getPrecomputes(r,e,n),t)},wNAFCachedUnsafe(e,t,n,r){const s=An(e);return 1===s?this.unsafeLadder(e,t,r):this.wNAFUnsafe(s,this.getPrecomputes(s,e,n),t,r)},setWindowSize(e,t){wn(t,g),En.set(e,t),vn.delete(e)}});var p,g;return{CURVE:t,ProjectivePoint:u,normPrivateKeyToScalar:o,weierstrassEquation:i,isWithinCurveOrder:function(e){return Ge(e,Bn,t.n)}}}function Rn(e){const t=function(e){const t=kn(e);return st(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:n,n:r}=t,s=n.BYTES+1,a=2*n.BYTES+1;function i(e){return tn(e,r)}function o(e){return sn(e,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:d,isWithinCurveOrder:u}=Ln({...t,toBytes(e,t,r){const s=t.toAffine(),a=n.toBytes(s.x),i=Ze;return Le("isCompressed",r),r?i(Uint8Array.from([t.hasEvenY()?2:3]),a):i(Uint8Array.from([4]),a,n.toBytes(s.y))},fromBytes(e){const t=e.length,r=e[0],i=e.subarray(1);if(t!==s||2!==r&&3!==r){if(t===a&&4===r)return{x:n.fromBytes(i.subarray(0,n.BYTES)),y:n.fromBytes(i.subarray(n.BYTES,2*n.BYTES))};throw new Error("invalid Point, expected length of "+s+", or uncompressed "+a+", got "+t)}{const e=He(i);if(!Ge(e,Bn,n.ORDER))throw new Error("Point is not on curve");const t=d(e);let s;try{s=n.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("Point is not on curve"+t)}return!(1&~r)!=((s&Bn)===Bn)&&(s=n.neg(s)),{x:e,y:s}}}}),h=e=>Ve(je(e,t.nByteLength));function f(e){return e>r>>Bn}const p=(e,t,n)=>He(e.slice(t,n));class g{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=We("compactSignature",e,2*n),new g(p(e,0,n),p(e,n,2*n))}static fromDER(e){const{r:t,s:n}=In.toSig(We("DER",e));return new g(t,n)}assertValidity(){Xe("r",this.r,Bn,r),Xe("s",this.s,Bn,r)}addRecoveryBit(e){return new g(this.r,this.s,e)}recoverPublicKey(e){const{r,s,recovery:a}=this,l=w(We("msgHash",e));if(null==a||![0,1,2,3].includes(a))throw new Error("recovery id invalid");const d=2===a||3===a?r+t.n:r;if(d>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const u=1&a?"03":"02",f=c.fromHex(u+h(d)),p=o(d),g=i(-l*p),m=i(s*p),y=c.BASE.multiplyAndAddUnsafe(f,g,m);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return $e(this.toDERHex())}toDERHex(){return In.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return $e(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const m={isValidPrivateKey(e){try{return l(e),!0}catch(e){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const e=hn(t.n);return function(e,t,n=!1){const r=e.length,s=un(t),a=hn(t);if(r<16||r<a||r>1024)throw new Error("expected "+a+"-1024 bytes of input, got "+r);const i=tn(n?He(e):ze(e),t-Yt)+Yt;return n?qe(i,s):je(i,s)}(t.randomBytes(e),t.n)},precompute:(e=8,t=c.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function y(e){const t=Ne(e),n="string"==typeof e,r=(t||n)&&e.length;return t?r===s||r===a:n?r===2*s||r===2*a:e instanceof c}const _=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const n=He(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},w=t.bits2int_modN||function(e){return i(_(e))},b=Qe(t.nBitLength);function v(e){return Xe("num < 2^"+t.nBitLength,e,Cn,b),je(e,t.nByteLength)}const E={lowS:t.lowS,prehash:!1},A={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,n=!0){if(y(e))throw new Error("first arg must be private key");if(!y(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(l(e)).toRawBytes(n)},sign:function(e,r,s=E){const{seed:a,k2sig:d}=function(e,r,s=E){if(["recovered","canonical"].some(e=>e in s))throw new Error("sign() legacy options not supported");const{hash:a,randomBytes:d}=t;let{lowS:h,prehash:p,extraEntropy:m}=s;null==h&&(h=!0),e=We("msgHash",e),Sn(s),p&&(e=We("prehashed msgHash",a(e)));const y=w(e),b=l(r),A=[v(b),v(y)];if(null!=m&&!1!==m){const e=!0===m?d(n.BYTES):m;A.push(We("extraEntropy",e))}const k=Ze(...A),S=y;return{seed:k,k2sig:function(e){const t=_(e);if(!u(t))return;const n=o(t),r=c.BASE.multiply(t).toAffine(),s=i(r.x);if(s===Cn)return;const a=i(n*i(S+s*b));if(a===Cn)return;let l=(r.x===s?0:2)|Number(r.y&Bn),d=a;return h&&f(a)&&(d=function(e){return f(e)?i(-e):e}(a),l^=1),new g(s,d,l)}}}(e,r,s),h=t;return nt(h.hash.outputLen,h.nByteLength,h.hmac)(a,d)},verify:function(e,n,r,s=A){const a=e;n=We("msgHash",n),r=We("publicKey",r);const{lowS:l,prehash:d,format:u}=s;if(Sn(s),"strict"in s)throw new Error("options.strict was renamed to lowS");if(void 0!==u&&"compact"!==u&&"der"!==u)throw new Error("format must be compact or der");const h="string"==typeof a||Ne(a),f=!h&&!u&&"object"==typeof a&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!h&&!f)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let p,m;try{if(f&&(p=new g(a.r,a.s)),h){try{"compact"!==u&&(p=g.fromDER(a))}catch(e){if(!(e instanceof In.Err))throw e}p||"der"===u||(p=g.fromCompact(a))}m=c.fromHex(r)}catch(e){return!1}if(!p)return!1;if(l&&p.hasHighS())return!1;d&&(n=t.hash(n));const{r:y,s:_}=p,b=w(n),v=o(_),E=i(b*v),k=i(y*v),S=c.BASE.multiplyAndAddUnsafe(m,E,k)?.toAffine();return!!S&&i(S.x)===y},ProjectivePoint:c,Signature:g,utils:m}}function Vn(e,t){const n=e.ORDER;let r=Cn;for(let e=n-Bn;e%On===Cn;e/=On)r+=Bn;const s=r,a=On<<s-Bn-Bn,i=a*On,o=(n-Bn)/i,c=(o-Bn)/On,l=i-Bn,d=a,u=e.pow(t,o),h=e.pow(t,(o+Bn)/On);let f=(t,n)=>{let r=u,a=e.pow(n,l),i=e.sqr(a);i=e.mul(i,n);let o=e.mul(t,i);o=e.pow(o,c),o=e.mul(o,a),a=e.mul(o,n),i=e.mul(o,t);let f=e.mul(i,a);o=e.pow(f,d);let p=e.eql(o,e.ONE);a=e.mul(i,h),o=e.mul(f,r),i=e.cmov(a,i,p),f=e.cmov(o,f,p);for(let t=s;t>Bn;t--){let n=t-On;n=On<<n-Bn;let s=e.pow(f,n);const o=e.eql(s,e.ONE);a=e.mul(i,r),r=e.mul(r,r),s=e.mul(f,r),i=e.cmov(a,i,o),f=e.cmov(s,f,o)}return{isValid:p,value:i}};if(e.ORDER%Dn===Nn){const n=(e.ORDER-Nn)/Dn,r=e.sqrt(e.neg(t));f=(t,s)=>{let a=e.sqr(s);const i=e.mul(t,s);a=e.mul(a,i);let o=e.pow(a,n);o=e.mul(o,i);const c=e.mul(o,r),l=e.mul(e.sqr(o),s),d=e.eql(l,t);return{isValid:d,value:e.cmov(c,o,d)}}}return f}function Pn(e,t){if(on(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=Vn(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let s,a,i,o,c,l,d,u;s=e.sqr(r),s=e.mul(s,t.Z),a=e.sqr(s),a=e.add(a,s),i=e.add(a,e.ONE),i=e.mul(i,t.B),o=e.cmov(t.Z,e.neg(a),!e.eql(a,e.ZERO)),o=e.mul(o,t.A),a=e.sqr(i),l=e.sqr(o),c=e.mul(l,t.A),a=e.add(a,c),a=e.mul(a,i),l=e.mul(l,o),c=e.mul(l,t.B),a=e.add(a,c),d=e.mul(s,i);const{isValid:h,value:f}=n(a,l);u=e.mul(s,r),u=e.mul(u,f),d=e.cmov(d,i,h),u=e.cmov(u,f,h);const p=e.isOdd(r)===e.isOdd(u);return u=e.cmov(e.neg(u),u,p),d=e.div(d,o),{x:d,y:u}}}class Fn extends _t{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");it(e.outputLen),it(e.blockLen)}(e);const n=yt(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,s=new Uint8Array(r);s.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),s.fill(0)}update(e){return ct(this),this.iHash.update(e),this}digestInto(e){ct(this),ot(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:s,blockLen:a,outputLen:i}=this;return e.finished=r,e.destroyed=s,e.blockLen=a,e.outputLen=i,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Un=(e,t,n)=>new Fn(e,t).update(n).digest();function Mn(e){return{hash:e,hmac:(t,...n)=>Un(e,t,function(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];ot(r),t+=r.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const s=e[t];n.set(s,r),r+=s.length}return n}(...n)),randomBytes:bt}}Un.create=(e,t)=>new Fn(e,t);const $n=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),Hn=BigInt("0x800000000000000000000000000000000000000000000000000000000000000");function zn(e){for(;0===e[0];)e=e.subarray(1);const t=8*e.length-252,n=He(e);return t>0?n>>BigInt(t):n}function jn(e){return"string"==typeof e&&1&(e=ir(e)).length&&(e="0"+e),$e(e)}const qn=Rn({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:dn(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:$n,nBitLength:252,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...Mn(It),bits2int:zn,bits2int_modN:e=>{const t=He(e).toString(16);return 63===t.length&&(e=jn(t+"0")),tn(zn(e),$n)}}),Kn=qn;function Wn(e){return We("","string"==typeof e?jn(e):e)}function Zn(e){return Ve(Wn(e)).padStart(64,"0")}function Yn(e,t=!1){return qn.getPublicKey(Zn(e),t)}function Gn(e,t){return qn.getSharedSecret(Zn(e),t)}function Xn(e){const{r:t,s:n}=e;if(t<0n||t>=Hn)throw new Error(`Signature.r should be [1, ${Hn})`);const r=sn(n,$n);if(r<0n||r>=Hn)throw new Error(`inv(Signature.s) should be [1, ${Hn})`)}function Jn(e){const t=Wn(e);if(He(t)>=Hn)throw new Error(`msgHash should be [0, ${Hn})`);return t}function Qn(e,t,n){const r=qn.sign(Jn(e),Zn(t),n);return Xn(r),r}function er(e,t,n){if(!(e instanceof rr)){const t=Wn(e);try{e=rr.fromDER(t)}catch(n){if(!(n instanceof In.Err))throw n;e=rr.fromCompact(t)}}return Xn(e),qn.verify(e,Jn(t),Wn(n))}const{CURVE:tr,ProjectivePoint:nr,Signature:rr,utils:sr}=qn;function ar(e){return`0x${Ve(e.subarray(1)).replace(/^0+/gm,"")}`}function ir(e){return e.replace(/^0x/i,"")}function or(e){const t=Wn(e),n=2n**256n,r=n-tn(n,$n);for(let e=0;;e++){const n=vr(Ze(t,Ke(BigInt(e))));if(n<r)return tn(n,$n).toString(16);if(1e5===e)throw new Error("grindKey is broken: tried 100k vals")}}function cr(e){return ar(Yn(e,!0))}function lr(e){if(130!==(e=ir(e)).length)throw new Error("Wrong ethereum signature");return or(e.substring(0,64))}const dr=e=>Number(2147483647n&e);function ur(e,t,n,r){const s=dr(vr(e)),a=dr(vr(t)),i=Fe(ir(n));return`m/2645'/${s}'/${a}'/${dr(i)}'/${dr(i>>31n)}'/${r}`}const hr=[new nr(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new nr(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new nr(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new nr(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new nr(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function fr(e,t){const n=[];let r=e;for(let e=0;e<248;e++)n.push(r),r=r.double();r=t;for(let e=0;e<4;e++)n.push(r),r=r.double();return n}const pr=fr(hr[1],hr[2]),gr=fr(hr[3],hr[4]);function mr(e,t,n){let r=function(e){let t;if("bigint"==typeof e)t=e;else if("number"==typeof e){if(!Number.isSafeInteger(e))throw new Error(`Invalid pedersenArg: ${e}`);t=BigInt(e)}else t=He(Wn(e));if(!(0n<=t&&t<qn.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${t}`);return t}(t);for(let t=0;t<252;t++){const s=n[t];if(!s)throw new Error("invalid constant index");if(s.equals(e))throw new Error("Same point");0n!=(1n&r)&&(e=e.add(s)),r>>=1n}return e}function yr(e,t){let n=hr[0];return n=mr(n,e,pr),n=mr(n,t,gr),ar(n.toRawBytes(!0))}const _r=(e,t=yr)=>[0,...e,e.length].reduce((e,n)=>t(e,n)),wr=Qe(250),br=e=>He(Wt(e))&wr,vr=e=>He(It(e)),Er=dn(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function Ar(e,t,n){const r=e.fromBytes(It(mt(`${t}${n}`)));return e.create(r)}function kr(e,t,n,r=0){const s=[],a=[];for(let i=0;i<n;i++)s.push(Ar(e,`${t}x`,r*n+i)),a.push(Ar(e,`${t}y`,r*n+i));if(new Set([...s,...a]).size!==2*n)throw new Error("X and Y values are not distinct");return s.map(t=>a.map(n=>e.inv(e.sub(t,n))))}const Sr=[[3,1,1],[1,-1,1],[1,1,-2]].map(e=>e.map(BigInt));function Tr(e,t){if(on(e.Fp),!Number.isSafeInteger(e.rate)||!Number.isSafeInteger(e.capacity))throw new Error(`Wrong poseidon opts: ${e}`);const n=e.rate+e.capacity,r=e.roundsFull+e.roundsPartial,s=[];for(let t=0;t<r;t++){const r=[];for(let s=0;s<n;s++)r.push(Ar(e.Fp,"Hades",n*t+s));s.push(r)}const a=gn({...e,t:n,sboxPower:3,reversePartialPowIdx:!0,mds:t,roundConstants:s});return a.m=n,a.rate=e.rate,a.capacity=e.capacity,a}function xr(e,t=0){const n=e.rate+e.capacity;if(!Number.isSafeInteger(t))throw new Error(`Wrong mdsAttempt=${t}`);return Tr(e,kr(e.Fp,"HadesMDS",n,t))}const Ir=Tr({Fp:Er,rate:2,capacity:1,roundsFull:8,roundsPartial:83},Sr);function Cr(e,t,n=Ir){return n([e,t,2n])[0]}function Br(e,t,n=Ir){return Ke(Cr(He(e),He(t),n))}function Or(e,t=Ir){return t([e,0n,1n])[0]}function Nr(e,t=Ir){const{m:n,rate:r}=t;if(!Array.isArray(e))throw new Error("bigint array expected in values");const s=Array.from(e);for(s.push(1n);s.length%r!==0;)s.push(0n);let a=new Array(n).fill(0n);for(let e=0;e<s.length;e+=r){for(let t=0;t<r;t++){const n=s[e+t];if(void 0===n)throw new Error("invalid index");if(void 0===a[t])throw new Error("state[j] is undefined");a[t]=a[t]+n}a=t(a)}return a[0]}function Dr(e){let t=e.length;for(;--t>=0;)e[t]=0}const Lr=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Rr=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Vr=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Pr=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fr=new Array(576);Dr(Fr);const Ur=new Array(60);Dr(Ur);const Mr=new Array(512);Dr(Mr);const $r=new Array(256);Dr($r);const Hr=new Array(29);Dr(Hr);const zr=new Array(30);function jr(e,t,n,r,s){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=s,this.has_stree=e&&e.length}let qr,Kr,Wr;function Zr(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Dr(zr);const Yr=e=>e<256?Mr[e]:Mr[256+(e>>>7)],Gr=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Xr=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,Gr(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Jr=(e,t,n)=>{Xr(e,n[2*t],n[2*t+1])},Qr=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},es=(e,t,n)=>{const r=new Array(16);let s,a,i=0;for(s=1;s<=15;s++)i=i+n[s-1]<<1,r[s]=i;for(a=0;a<=t;a++){let t=e[2*a+1];0!==t&&(e[2*a]=Qr(r[t]++,t))}},ts=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},ns=e=>{e.bi_valid>8?Gr(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},rs=(e,t,n,r)=>{const s=2*t,a=2*n;return e[s]<e[a]||e[s]===e[a]&&r[t]<=r[n]},ss=(e,t,n)=>{const r=e.heap[n];let s=n<<1;for(;s<=e.heap_len&&(s<e.heap_len&&rs(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!rs(t,r,e.heap[s],e.depth));)e.heap[n]=e.heap[s],n=s,s<<=1;e.heap[n]=r},as=(e,t,n)=>{let r,s,a,i,o=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+o++],r+=(255&e.pending_buf[e.sym_buf+o++])<<8,s=e.pending_buf[e.sym_buf+o++],0===r?Jr(e,s,t):(a=$r[s],Jr(e,a+256+1,t),i=Lr[a],0!==i&&(s-=Hr[a],Xr(e,s,i)),r--,a=Yr(r),Jr(e,a,n),i=Rr[a],0!==i&&(r-=zr[a],Xr(e,r,i)))}while(o<e.sym_next);Jr(e,256,t)},is=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.elems;let i,o,c,l=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<a;i++)0!==n[2*i]?(e.heap[++e.heap_len]=l=i,e.depth[i]=0):n[2*i+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,s&&(e.static_len-=r[2*c+1]);for(t.max_code=l,i=e.heap_len>>1;i>=1;i--)ss(e,n,i);c=a;do{i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],ss(e,n,1),o=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=o,n[2*c]=n[2*i]+n[2*o],e.depth[c]=(e.depth[i]>=e.depth[o]?e.depth[i]:e.depth[o])+1,n[2*i+1]=n[2*o+1]=c,e.heap[1]=c++,ss(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,i=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,c=t.stat_desc.max_length;let l,d,u,h,f,p,g=0;for(h=0;h<=15;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)d=e.heap[l],h=n[2*n[2*d+1]+1]+1,h>c&&(h=c,g++),n[2*d+1]=h,d>r||(e.bl_count[h]++,f=0,d>=o&&(f=i[d-o]),p=n[2*d],e.opt_len+=p*(h+f),a&&(e.static_len+=p*(s[2*d+1]+f)));if(0!==g){do{for(h=c-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,g-=2}while(g>0);for(h=c;0!==h;h--)for(d=e.bl_count[h];0!==d;)u=e.heap[--l],u>r||(n[2*u+1]!==h&&(e.opt_len+=(h-n[2*u+1])*n[2*u],n[2*u+1]=h),d--)}})(e,t),es(n,l,e.bl_count)},os=(e,t,n)=>{let r,s,a=-1,i=t[1],o=0,c=7,l=4;for(0===i&&(c=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)s=i,i=t[2*(r+1)+1],++o<c&&s===i||(o<l?e.bl_tree[2*s]+=o:0!==s?(s!==a&&e.bl_tree[2*s]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,a=s,0===i?(c=138,l=3):s===i?(c=6,l=3):(c=7,l=4))},cs=(e,t,n)=>{let r,s,a=-1,i=t[1],o=0,c=7,l=4;for(0===i&&(c=138,l=3),r=0;r<=n;r++)if(s=i,i=t[2*(r+1)+1],!(++o<c&&s===i)){if(o<l)do{Jr(e,s,e.bl_tree)}while(0!==--o);else 0!==s?(s!==a&&(Jr(e,s,e.bl_tree),o--),Jr(e,16,e.bl_tree),Xr(e,o-3,2)):o<=10?(Jr(e,17,e.bl_tree),Xr(e,o-3,3)):(Jr(e,18,e.bl_tree),Xr(e,o-11,7));o=0,a=s,0===i?(c=138,l=3):s===i?(c=6,l=3):(c=7,l=4)}};let ls=!1;const ds=(e,t,n,r)=>{Xr(e,0+(r?1:0),3),ns(e),Gr(e,n),Gr(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var us={_tr_init:e=>{ls||((()=>{let e,t,n,r,s;const a=new Array(16);for(n=0,r=0;r<28;r++)for(Hr[r]=n,e=0;e<1<<Lr[r];e++)$r[n++]=r;for($r[n-1]=r,s=0,r=0;r<16;r++)for(zr[r]=s,e=0;e<1<<Rr[r];e++)Mr[s++]=r;for(s>>=7;r<30;r++)for(zr[r]=s<<7,e=0;e<1<<Rr[r]-7;e++)Mr[256+s++]=r;for(t=0;t<=15;t++)a[t]=0;for(e=0;e<=143;)Fr[2*e+1]=8,e++,a[8]++;for(;e<=255;)Fr[2*e+1]=9,e++,a[9]++;for(;e<=279;)Fr[2*e+1]=7,e++,a[7]++;for(;e<=287;)Fr[2*e+1]=8,e++,a[8]++;for(es(Fr,287,a),e=0;e<30;e++)Ur[2*e+1]=5,Ur[2*e]=Qr(e,5);qr=new jr(Fr,Lr,257,286,15),Kr=new jr(Ur,Rr,0,30,15),Wr=new jr(new Array(0),Vr,0,19,7)})(),ls=!0),e.l_desc=new Zr(e.dyn_ltree,qr),e.d_desc=new Zr(e.dyn_dtree,Kr),e.bl_desc=new Zr(e.bl_tree,Wr),e.bi_buf=0,e.bi_valid=0,ts(e)},_tr_stored_block:ds,_tr_flush_block:(e,t,n,r)=>{let s,a,i=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),is(e,e.l_desc),is(e,e.d_desc),i=(e=>{let t;for(os(e,e.dyn_ltree,e.l_desc.max_code),os(e,e.dyn_dtree,e.d_desc.max_code),is(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Pr[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),s=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=s&&(s=a)):s=a=n+5,n+4<=s&&-1!==t?ds(e,t,n,r):4===e.strategy||a===s?(Xr(e,2+(r?1:0),3),as(e,Fr,Ur)):(Xr(e,4+(r?1:0),3),((e,t,n,r)=>{let s;for(Xr(e,t-257,5),Xr(e,n-1,5),Xr(e,r-4,4),s=0;s<r;s++)Xr(e,e.bl_tree[2*Pr[s]+1],3);cs(e,e.dyn_ltree,t-1),cs(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),as(e,e.dyn_ltree,e.dyn_dtree)),ts(e),r&&ns(e)},_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*($r[n]+256+1)]++,e.dyn_dtree[2*Yr(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{Xr(e,2,3),Jr(e,256,Fr),(e=>{16===e.bi_valid?(Gr(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},hs=(e,t,n,r)=>{let s=65535&e,a=e>>>16&65535,i=0;for(;0!==n;){i=n>2e3?2e3:n,n-=i;do{s=s+t[r++]|0,a=a+s|0}while(--i);s%=65521,a%=65521}return s|a<<16};const fs=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var ps=(e,t,n,r)=>{const s=fs,a=r+n;e^=-1;for(let n=r;n<a;n++)e=e>>>8^s[255&(e^t[n])];return-1^e},gs={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ms={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ys,_tr_stored_block:_s,_tr_flush_block:ws,_tr_tally:bs,_tr_align:vs}=us,{Z_NO_FLUSH:Es,Z_PARTIAL_FLUSH:As,Z_FULL_FLUSH:ks,Z_FINISH:Ss,Z_BLOCK:Ts,Z_OK:xs,Z_STREAM_END:Is,Z_STREAM_ERROR:Cs,Z_DATA_ERROR:Bs,Z_BUF_ERROR:Os,Z_DEFAULT_COMPRESSION:Ns,Z_FILTERED:Ds,Z_HUFFMAN_ONLY:Ls,Z_RLE:Rs,Z_FIXED:Vs,Z_DEFAULT_STRATEGY:Ps,Z_UNKNOWN:Fs,Z_DEFLATED:Us}=ms,Ms=258,$s=262,Hs=42,zs=113,js=666,qs=(e,t)=>(e.msg=gs[t],t),Ks=e=>2*e-(e>4?9:0),Ws=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Zs=e=>{let t,n,r,s=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=s?n-s:0}while(--t);t=s,r=t;do{n=e.prev[--r],e.prev[r]=n>=s?n-s:0}while(--t)};let Ys=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Gs=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Xs=(e,t)=>{ws(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Gs(e.strm)},Js=(e,t)=>{e.pending_buf[e.pending++]=t},Qs=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},ea=(e,t,n,r)=>{let s=e.avail_in;return s>r&&(s=r),0===s?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),n),1===e.state.wrap?e.adler=hs(e.adler,t,s,n):2===e.state.wrap&&(e.adler=ps(e.adler,t,s,n)),e.next_in+=s,e.total_in+=s,s)},ta=(e,t)=>{let n,r,s=e.max_chain_length,a=e.strstart,i=e.prev_length,o=e.nice_match;const c=e.strstart>e.w_size-$s?e.strstart-(e.w_size-$s):0,l=e.window,d=e.w_mask,u=e.prev,h=e.strstart+Ms;let f=l[a+i-1],p=l[a+i];e.prev_length>=e.good_match&&(s>>=2),o>e.lookahead&&(o=e.lookahead);do{if(n=t,l[n+i]===p&&l[n+i-1]===f&&l[n]===l[a]&&l[++n]===l[a+1]){a+=2,n++;do{}while(l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&a<h);if(r=Ms-(h-a),a=h-Ms,r>i){if(e.match_start=t,i=r,r>=o)break;f=l[a+i-1],p=l[a+i]}}}while((t=u[t&d])>c&&0!==--s);return i<=e.lookahead?i:e.lookahead},na=e=>{const t=e.w_size;let n,r,s;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-$s)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Zs(e),r+=t),0===e.strm.avail_in)break;if(n=ea(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=Ys(e,e.ins_h,e.window[s+1]);e.insert&&(e.ins_h=Ys(e,e.ins_h,e.window[s+3-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<$s&&0!==e.strm.avail_in)},ra=(e,t)=>{let n,r,s,a=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,i=0,o=e.strm.avail_in;do{if(n=65535,s=e.bi_valid+42>>3,e.strm.avail_out<s)break;if(s=e.strm.avail_out-s,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>s&&(n=s),n<a&&(0===n&&t!==Ss||t===Es||n!==r+e.strm.avail_in))break;i=t===Ss&&n===r+e.strm.avail_in?1:0,_s(e,0,0,i),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Gs(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(ea(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===i);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),i?4:t!==Es&&t!==Ss&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(s=e.window_size-e.strstart,e.strm.avail_in>s&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,s+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),s>e.strm.avail_in&&(s=e.strm.avail_in),s&&(ea(e.strm,e.window,e.strstart,s),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.high_water<e.strstart&&(e.high_water=e.strstart),s=e.bi_valid+42>>3,s=e.pending_buf_size-s>65535?65535:e.pending_buf_size-s,a=s>e.w_size?e.w_size:s,r=e.strstart-e.block_start,(r>=a||(r||t===Ss)&&t!==Es&&0===e.strm.avail_in&&r<=s)&&(n=r>s?s:r,i=t===Ss&&0===e.strm.avail_in&&n===r?1:0,_s(e,e.block_start,n,i),e.block_start+=n,Gs(e.strm)),i?3:1)},sa=(e,t)=>{let n,r;for(;;){if(e.lookahead<$s){if(na(e),e.lookahead<$s&&t===Es)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Ys(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-$s&&(e.match_length=ta(e,n)),e.match_length>=3)if(r=bs(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Ys(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Ys(e,e.ins_h,e.window[e.strstart+1]);else r=bs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Xs(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Ss?(Xs(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Xs(e,!1),0===e.strm.avail_out)?1:2},aa=(e,t)=>{let n,r,s;for(;;){if(e.lookahead<$s){if(na(e),e.lookahead<$s&&t===Es)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Ys(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-$s&&(e.match_length=ta(e,n),e.match_length<=5&&(e.strategy===Ds||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,r=bs(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=Ys(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(Xs(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=bs(e,0,e.window[e.strstart-1]),r&&Xs(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=bs(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Ss?(Xs(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Xs(e,!1),0===e.strm.avail_out)?1:2};function ia(e,t,n,r,s){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=s}const oa=[new ia(0,0,0,0,ra),new ia(4,4,8,4,sa),new ia(4,5,16,8,sa),new ia(4,6,32,32,sa),new ia(4,4,16,16,aa),new ia(8,16,32,32,aa),new ia(8,16,128,128,aa),new ia(8,32,128,256,aa),new ia(32,128,258,1024,aa),new ia(32,258,258,4096,aa)];function ca(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Us,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Ws(this.dyn_ltree),Ws(this.dyn_dtree),Ws(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Ws(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Ws(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const la=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Hs&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==zs&&t.status!==js?1:0},da=e=>{if(la(e))return qs(e,Cs);e.total_in=e.total_out=0,e.data_type=Fs;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Hs:zs,e.adler=2===t.wrap?0:1,t.last_flush=-2,ys(t),xs},ua=e=>{const t=da(e);var n;return t===xs&&((n=e.state).window_size=2*n.w_size,Ws(n.head),n.max_lazy_match=oa[n.level].max_lazy,n.good_match=oa[n.level].good_length,n.nice_match=oa[n.level].nice_length,n.max_chain_length=oa[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},ha=(e,t,n,r,s,a)=>{if(!e)return Cs;let i=1;if(t===Ns&&(t=6),r<0?(i=0,r=-r):r>15&&(i=2,r-=16),s<1||s>9||n!==Us||r<8||r>15||t<0||t>9||a<0||a>Vs||8===r&&1!==i)return qs(e,Cs);8===r&&(r=9);const o=new ca;return e.state=o,o.strm=e,o.status=Hs,o.wrap=i,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=s+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<s+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=a,o.method=n,ua(e)};var fa=ha,pa=(e,t)=>la(e)||2!==e.state.wrap?Cs:(e.state.gzhead=t,xs),ga=(e,t)=>{if(la(e)||t>Ts||t<0)return e?qs(e,Cs):Cs;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===js&&t!==Ss)return qs(e,0===e.avail_out?Os:Cs);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(Gs(e),0===e.avail_out)return n.last_flush=-1,xs}else if(0===e.avail_in&&Ks(t)<=Ks(r)&&t!==Ss)return qs(e,Os);if(n.status===js&&0!==e.avail_in)return qs(e,Os);if(n.status===Hs&&0===n.wrap&&(n.status=zs),n.status===Hs){let t=Us+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=Ls||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,Qs(n,t),0!==n.strstart&&(Qs(n,e.adler>>>16),Qs(n,65535&e.adler)),e.adler=1,n.status=zs,Gs(e),0!==n.pending)return n.last_flush=-1,xs}if(57===n.status)if(e.adler=0,Js(n,31),Js(n,139),Js(n,8),n.gzhead)Js(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Js(n,255&n.gzhead.time),Js(n,n.gzhead.time>>8&255),Js(n,n.gzhead.time>>16&255),Js(n,n.gzhead.time>>24&255),Js(n,9===n.level?2:n.strategy>=Ls||n.level<2?4:0),Js(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Js(n,255&n.gzhead.extra.length),Js(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=ps(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(Js(n,0),Js(n,0),Js(n,0),Js(n,0),Js(n,0),Js(n,9===n.level?2:n.strategy>=Ls||n.level<2?4:0),Js(n,3),n.status=zs,Gs(e),0!==n.pending)return n.last_flush=-1,xs;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let s=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+s),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=ps(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=s,Gs(e),0!==n.pending)return n.last_flush=-1,xs;t=0,r-=s}let s=new Uint8Array(n.gzhead.extra);n.pending_buf.set(s.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=ps(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=ps(e.adler,n.pending_buf,n.pending-r,r)),Gs(e),0!==n.pending)return n.last_flush=-1,xs;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Js(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=ps(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=ps(e.adler,n.pending_buf,n.pending-r,r)),Gs(e),0!==n.pending)return n.last_flush=-1,xs;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Js(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=ps(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Gs(e),0!==n.pending))return n.last_flush=-1,xs;Js(n,255&e.adler),Js(n,e.adler>>8&255),e.adler=0}if(n.status=zs,Gs(e),0!==n.pending)return n.last_flush=-1,xs}if(0!==e.avail_in||0!==n.lookahead||t!==Es&&n.status!==js){let r=0===n.level?ra(n,t):n.strategy===Ls?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(na(e),0===e.lookahead)){if(t===Es)return 1;break}if(e.match_length=0,n=bs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Xs(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Ss?(Xs(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Xs(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===Rs?((e,t)=>{let n,r,s,a;const i=e.window;for(;;){if(e.lookahead<=Ms){if(na(e),e.lookahead<=Ms&&t===Es)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(s=e.strstart-1,r=i[s],r===i[++s]&&r===i[++s]&&r===i[++s])){a=e.strstart+Ms;do{}while(r===i[++s]&&r===i[++s]&&r===i[++s]&&r===i[++s]&&r===i[++s]&&r===i[++s]&&r===i[++s]&&r===i[++s]&&s<a);e.match_length=Ms-(a-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=bs(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=bs(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Xs(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Ss?(Xs(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Xs(e,!1),0===e.strm.avail_out)?1:2})(n,t):oa[n.level].func(n,t);if(3!==r&&4!==r||(n.status=js),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),xs;if(2===r&&(t===As?vs(n):t!==Ts&&(_s(n,0,0,!1),t===ks&&(Ws(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Gs(e),0===e.avail_out))return n.last_flush=-1,xs}return t!==Ss?xs:n.wrap<=0?Is:(2===n.wrap?(Js(n,255&e.adler),Js(n,e.adler>>8&255),Js(n,e.adler>>16&255),Js(n,e.adler>>24&255),Js(n,255&e.total_in),Js(n,e.total_in>>8&255),Js(n,e.total_in>>16&255),Js(n,e.total_in>>24&255)):(Qs(n,e.adler>>>16),Qs(n,65535&e.adler)),Gs(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?xs:Is)},ma=e=>{if(la(e))return Cs;const t=e.state.status;return e.state=null,t===zs?qs(e,Bs):xs},ya=(e,t)=>{let n=t.length;if(la(e))return Cs;const r=e.state,s=r.wrap;if(2===s||1===s&&r.status!==Hs||r.lookahead)return Cs;if(1===s&&(e.adler=hs(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===s&&(Ws(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const a=e.avail_in,i=e.next_in,o=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,na(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=Ys(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,na(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=i,e.input=o,e.avail_in=a,r.wrap=s,xs};const _a=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var wa=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)_a(n,t)&&(e[t]=n[t])}}return e},ba=e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,s=e.length;t<s;t++){let s=e[t];n.set(s,r),r+=s.length}return n};let va=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){va=!1}const Ea=new Uint8Array(256);for(let e=0;e<256;e++)Ea[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Ea[254]=Ea[254]=1;var Aa=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,s,a,i=e.length,o=0;for(s=0;s<i;s++)n=e.charCodeAt(s),55296==(64512&n)&&s+1<i&&(r=e.charCodeAt(s+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),s++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(o),a=0,s=0;a<o;s++)n=e.charCodeAt(s),55296==(64512&n)&&s+1<i&&(r=e.charCodeAt(s+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),s++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},ka=(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,s;const a=new Array(2*n);for(s=0,r=0;r<n;){let t=e[r++];if(t<128){a[s++]=t;continue}let i=Ea[t];if(i>4)a[s++]=65533,r+=i-1;else{for(t&=2===i?31:3===i?15:7;i>1&&r<n;)t=t<<6|63&e[r++],i--;i>1?a[s++]=65533:t<65536?a[s++]=t:(t-=65536,a[s++]=55296|t>>10&1023,a[s++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&va)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(a,s)},Sa=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+Ea[e[n]]>t?n:t},Ta=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const xa=Object.prototype.toString,{Z_NO_FLUSH:Ia,Z_SYNC_FLUSH:Ca,Z_FULL_FLUSH:Ba,Z_FINISH:Oa,Z_OK:Na,Z_STREAM_END:Da,Z_DEFAULT_COMPRESSION:La,Z_DEFAULT_STRATEGY:Ra,Z_DEFLATED:Va}=ms;function Pa(e){this.options=wa({level:La,method:Va,chunkSize:16384,windowBits:15,memLevel:8,strategy:Ra},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ta,this.strm.avail_out=0;let n=fa(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Na)throw new Error(gs[n]);if(t.header&&pa(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?Aa(t.dictionary):"[object ArrayBuffer]"===xa.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=ya(this.strm,e),n!==Na)throw new Error(gs[n]);this._dict_set=!0}}function Fa(e,t){const n=new Pa(t);if(n.push(e,!0),n.err)throw n.msg||gs[n.err];return n.result}Pa.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let s,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?Oa:Ia,"string"==typeof e?n.input=Aa(e):"[object ArrayBuffer]"===xa.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(a===Ca||a===Ba)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(s=ga(n,a),s===Da)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),s=ma(this.strm),this.onEnd(s),this.ended=!0,s===Na;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Pa.prototype.onData=function(e){this.chunks.push(e)},Pa.prototype.onEnd=function(e){e===Na&&(this.result=ba(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Ua={Deflate:Pa,deflate:Fa,deflateRaw:function(e,t){return(t=t||{}).raw=!0,Fa(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,Fa(e,t)},constants:ms};const Ma=16209;var $a=function(e,t){let n,r,s,a,i,o,c,l,d,u,h,f,p,g,m,y,_,w,b,v,E,A,k,S;const T=e.state;n=e.next_in,k=e.input,r=n+(e.avail_in-5),s=e.next_out,S=e.output,a=s-(t-e.avail_out),i=s+(e.avail_out-257),o=T.dmax,c=T.wsize,l=T.whave,d=T.wnext,u=T.window,h=T.hold,f=T.bits,p=T.lencode,g=T.distcode,m=(1<<T.lenbits)-1,y=(1<<T.distbits)-1;e:do{f<15&&(h+=k[n++]<<f,f+=8,h+=k[n++]<<f,f+=8),_=p[h&m];t:for(;;){if(w=_>>>24,h>>>=w,f-=w,w=_>>>16&255,0===w)S[s++]=65535&_;else{if(!(16&w)){if(64&w){if(32&w){T.mode=16191;break e}e.msg="invalid literal/length code",T.mode=Ma;break e}_=p[(65535&_)+(h&(1<<w)-1)];continue t}for(b=65535&_,w&=15,w&&(f<w&&(h+=k[n++]<<f,f+=8),b+=h&(1<<w)-1,h>>>=w,f-=w),f<15&&(h+=k[n++]<<f,f+=8,h+=k[n++]<<f,f+=8),_=g[h&y];;){if(w=_>>>24,h>>>=w,f-=w,w=_>>>16&255,16&w){if(v=65535&_,w&=15,f<w&&(h+=k[n++]<<f,f+=8,f<w&&(h+=k[n++]<<f,f+=8)),v+=h&(1<<w)-1,v>o){e.msg="invalid distance too far back",T.mode=Ma;break e}if(h>>>=w,f-=w,w=s-a,v>w){if(w=v-w,w>l&&T.sane){e.msg="invalid distance too far back",T.mode=Ma;break e}if(E=0,A=u,0===d){if(E+=c-w,w<b){b-=w;do{S[s++]=u[E++]}while(--w);E=s-v,A=S}}else if(d<w){if(E+=c+d-w,w-=d,w<b){b-=w;do{S[s++]=u[E++]}while(--w);if(E=0,d<b){w=d,b-=w;do{S[s++]=u[E++]}while(--w);E=s-v,A=S}}}else if(E+=d-w,w<b){b-=w;do{S[s++]=u[E++]}while(--w);E=s-v,A=S}for(;b>2;)S[s++]=A[E++],S[s++]=A[E++],S[s++]=A[E++],b-=3;b&&(S[s++]=A[E++],b>1&&(S[s++]=A[E++]))}else{E=s-v;do{S[s++]=S[E++],S[s++]=S[E++],S[s++]=S[E++],b-=3}while(b>2);b&&(S[s++]=S[E++],b>1&&(S[s++]=S[E++]))}break}if(64&w){e.msg="invalid distance code",T.mode=Ma;break e}_=g[(65535&_)+(h&(1<<w)-1)]}}break}}while(n<r&&s<i);b=f>>3,n-=b,f-=b<<3,h&=(1<<f)-1,e.next_in=n,e.next_out=s,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=s<i?i-s+257:257-(s-i),T.hold=h,T.bits=f};const Ha=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),za=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ja=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),qa=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Ka=(e,t,n,r,s,a,i,o)=>{const c=o.bits;let l,d,u,h,f,p,g=0,m=0,y=0,_=0,w=0,b=0,v=0,E=0,A=0,k=0,S=null;const T=new Uint16Array(16),x=new Uint16Array(16);let I,C,B,O=null;for(g=0;g<=15;g++)T[g]=0;for(m=0;m<r;m++)T[t[n+m]]++;for(w=c,_=15;_>=1&&0===T[_];_--);if(w>_&&(w=_),0===_)return s[a++]=20971520,s[a++]=20971520,o.bits=1,0;for(y=1;y<_&&0===T[y];y++);for(w<y&&(w=y),E=1,g=1;g<=15;g++)if(E<<=1,E-=T[g],E<0)return-1;if(E>0&&(0===e||1!==_))return-1;for(x[1]=0,g=1;g<15;g++)x[g+1]=x[g]+T[g];for(m=0;m<r;m++)0!==t[n+m]&&(i[x[t[n+m]]++]=m);if(0===e?(S=O=i,p=20):1===e?(S=Ha,O=za,p=257):(S=ja,O=qa,p=0),k=0,m=0,g=y,f=a,b=w,v=0,u=-1,A=1<<w,h=A-1,1===e&&A>852||2===e&&A>592)return 1;for(;;){I=g-v,i[m]+1<p?(C=0,B=i[m]):i[m]>=p?(C=O[i[m]-p],B=S[i[m]-p]):(C=96,B=0),l=1<<g-v,d=1<<b,y=d;do{d-=l,s[f+(k>>v)+d]=I<<24|C<<16|B}while(0!==d);for(l=1<<g-1;k&l;)l>>=1;if(0!==l?(k&=l-1,k+=l):k=0,m++,0===--T[g]){if(g===_)break;g=t[n+i[m]]}if(g>w&&(k&h)!==u){for(0===v&&(v=w),f+=y,b=g-v,E=1<<b;b+v<_&&(E-=T[b+v],!(E<=0));)b++,E<<=1;if(A+=1<<b,1===e&&A>852||2===e&&A>592)return 1;u=k&h,s[u]=w<<24|b<<16|f-a}}return 0!==k&&(s[f+k]=g-v<<24|64<<16),o.bits=w,0};const{Z_FINISH:Wa,Z_BLOCK:Za,Z_TREES:Ya,Z_OK:Ga,Z_STREAM_END:Xa,Z_NEED_DICT:Ja,Z_STREAM_ERROR:Qa,Z_DATA_ERROR:ei,Z_MEM_ERROR:ti,Z_BUF_ERROR:ni,Z_DEFLATED:ri}=ms,si=16180,ai=16190,ii=16191,oi=16192,ci=16194,li=16199,di=16200,ui=16206,hi=16209,fi=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function pi(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const gi=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<si||t.mode>16211?1:0},mi=e=>{if(gi(e))return Qa;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=si,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Ga},yi=e=>{if(gi(e))return Qa;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,mi(e)},_i=(e,t)=>{let n;if(gi(e))return Qa;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Qa:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,yi(e))},wi=(e,t)=>{if(!e)return Qa;const n=new pi;e.state=n,n.strm=e,n.window=null,n.mode=si;const r=_i(e,t);return r!==Ga&&(e.state=null),r};let bi,vi,Ei=!0;const Ai=e=>{if(Ei){bi=new Int32Array(512),vi=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ka(1,e.lens,0,288,bi,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ka(2,e.lens,0,32,vi,0,e.work,{bits:5}),Ei=!1}e.lencode=bi,e.lenbits=9,e.distcode=vi,e.distbits=5},ki=(e,t,n,r)=>{let s;const a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(s=a.wsize-a.wnext,s>r&&(s=r),a.window.set(t.subarray(n-r,n-r+s),a.wnext),(r-=s)?(a.window.set(t.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0};var Si=yi,Ti=wi,xi=(e,t)=>{let n,r,s,a,i,o,c,l,d,u,h,f,p,g,m,y,_,w,b,v,E,A,k=0;const S=new Uint8Array(4);let T,x;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(gi(e)||!e.output||!e.input&&0!==e.avail_in)return Qa;n=e.state,n.mode===ii&&(n.mode=oi),i=e.next_out,s=e.output,c=e.avail_out,a=e.next_in,r=e.input,o=e.avail_in,l=n.hold,d=n.bits,u=o,h=c,A=Ga;e:for(;;)switch(n.mode){case si:if(0===n.wrap){n.mode=oi;break}for(;d<16;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}if(2&n.wrap&&35615===l){0===n.wbits&&(n.wbits=15),n.check=0,S[0]=255&l,S[1]=l>>>8&255,n.check=ps(n.check,S,2,0),l=0,d=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=hi;break}if((15&l)!==ri){e.msg="unknown compression method",n.mode=hi;break}if(l>>>=4,d-=4,E=8+(15&l),0===n.wbits&&(n.wbits=E),E>15||E>n.wbits){e.msg="invalid window size",n.mode=hi;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&l?16189:ii,l=0,d=0;break;case 16181:for(;d<16;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}if(n.flags=l,(255&n.flags)!==ri){e.msg="unknown compression method",n.mode=hi;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=hi;break}n.head&&(n.head.text=l>>8&1),512&n.flags&&4&n.wrap&&(S[0]=255&l,S[1]=l>>>8&255,n.check=ps(n.check,S,2,0)),l=0,d=0,n.mode=16182;case 16182:for(;d<32;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}n.head&&(n.head.time=l),512&n.flags&&4&n.wrap&&(S[0]=255&l,S[1]=l>>>8&255,S[2]=l>>>16&255,S[3]=l>>>24&255,n.check=ps(n.check,S,4,0)),l=0,d=0,n.mode=16183;case 16183:for(;d<16;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&n.flags&&4&n.wrap&&(S[0]=255&l,S[1]=l>>>8&255,n.check=ps(n.check,S,2,0)),l=0,d=0,n.mode=16184;case 16184:if(1024&n.flags){for(;d<16;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}n.length=l,n.head&&(n.head.extra_len=l),512&n.flags&&4&n.wrap&&(S[0]=255&l,S[1]=l>>>8&255,n.check=ps(n.check,S,2,0)),l=0,d=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(f=n.length,f>o&&(f=o),f&&(n.head&&(E=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+f),E)),512&n.flags&&4&n.wrap&&(n.check=ps(n.check,r,f,a)),o-=f,a+=f,n.length-=f),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===o)break e;f=0;do{E=r[a+f++],n.head&&E&&n.length<65536&&(n.head.name+=String.fromCharCode(E))}while(E&&f<o);if(512&n.flags&&4&n.wrap&&(n.check=ps(n.check,r,f,a)),o-=f,a+=f,E)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===o)break e;f=0;do{E=r[a+f++],n.head&&E&&n.length<65536&&(n.head.comment+=String.fromCharCode(E))}while(E&&f<o);if(512&n.flags&&4&n.wrap&&(n.check=ps(n.check,r,f,a)),o-=f,a+=f,E)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;d<16;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}if(4&n.wrap&&l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=hi;break}l=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=ii;break;case 16189:for(;d<32;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}e.adler=n.check=fi(l),l=0,d=0,n.mode=ai;case ai:if(0===n.havedict)return e.next_out=i,e.avail_out=c,e.next_in=a,e.avail_in=o,n.hold=l,n.bits=d,Ja;e.adler=n.check=1,n.mode=ii;case ii:if(t===Za||t===Ya)break e;case oi:if(n.last){l>>>=7&d,d-=7&d,n.mode=ui;break}for(;d<3;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}switch(n.last=1&l,l>>>=1,d-=1,3&l){case 0:n.mode=16193;break;case 1:if(Ai(n),n.mode=li,t===Ya){l>>>=2,d-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=hi}l>>>=2,d-=2;break;case 16193:for(l>>>=7&d,d-=7&d;d<32;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=hi;break}if(n.length=65535&l,l=0,d=0,n.mode=ci,t===Ya)break e;case ci:n.mode=16195;case 16195:if(f=n.length,f){if(f>o&&(f=o),f>c&&(f=c),0===f)break e;s.set(r.subarray(a,a+f),i),o-=f,a+=f,c-=f,i+=f,n.length-=f;break}n.mode=ii;break;case 16196:for(;d<14;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}if(n.nlen=257+(31&l),l>>>=5,d-=5,n.ndist=1+(31&l),l>>>=5,d-=5,n.ncode=4+(15&l),l>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=hi;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;d<3;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}n.lens[I[n.have++]]=7&l,l>>>=3,d-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},A=Ka(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,A){e.msg="invalid code lengths set",n.mode=hi;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;k=n.lencode[l&(1<<n.lenbits)-1],m=k>>>24,y=k>>>16&255,_=65535&k,!(m<=d);){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}if(_<16)l>>>=m,d-=m,n.lens[n.have++]=_;else{if(16===_){for(x=m+2;d<x;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}if(l>>>=m,d-=m,0===n.have){e.msg="invalid bit length repeat",n.mode=hi;break}E=n.lens[n.have-1],f=3+(3&l),l>>>=2,d-=2}else if(17===_){for(x=m+3;d<x;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}l>>>=m,d-=m,E=0,f=3+(7&l),l>>>=3,d-=3}else{for(x=m+7;d<x;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}l>>>=m,d-=m,E=0,f=11+(127&l),l>>>=7,d-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=hi;break}for(;f--;)n.lens[n.have++]=E}}if(n.mode===hi)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=hi;break}if(n.lenbits=9,T={bits:n.lenbits},A=Ka(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,A){e.msg="invalid literal/lengths set",n.mode=hi;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},A=Ka(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,A){e.msg="invalid distances set",n.mode=hi;break}if(n.mode=li,t===Ya)break e;case li:n.mode=di;case di:if(o>=6&&c>=258){e.next_out=i,e.avail_out=c,e.next_in=a,e.avail_in=o,n.hold=l,n.bits=d,$a(e,h),i=e.next_out,s=e.output,c=e.avail_out,a=e.next_in,r=e.input,o=e.avail_in,l=n.hold,d=n.bits,n.mode===ii&&(n.back=-1);break}for(n.back=0;k=n.lencode[l&(1<<n.lenbits)-1],m=k>>>24,y=k>>>16&255,_=65535&k,!(m<=d);){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}if(y&&!(240&y)){for(w=m,b=y,v=_;k=n.lencode[v+((l&(1<<w+b)-1)>>w)],m=k>>>24,y=k>>>16&255,_=65535&k,!(w+m<=d);){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}l>>>=w,d-=w,n.back+=w}if(l>>>=m,d-=m,n.back+=m,n.length=_,0===y){n.mode=16205;break}if(32&y){n.back=-1,n.mode=ii;break}if(64&y){e.msg="invalid literal/length code",n.mode=hi;break}n.extra=15&y,n.mode=16201;case 16201:if(n.extra){for(x=n.extra;d<x;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;k=n.distcode[l&(1<<n.distbits)-1],m=k>>>24,y=k>>>16&255,_=65535&k,!(m<=d);){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}if(!(240&y)){for(w=m,b=y,v=_;k=n.distcode[v+((l&(1<<w+b)-1)>>w)],m=k>>>24,y=k>>>16&255,_=65535&k,!(w+m<=d);){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}l>>>=w,d-=w,n.back+=w}if(l>>>=m,d-=m,n.back+=m,64&y){e.msg="invalid distance code",n.mode=hi;break}n.offset=_,n.extra=15&y,n.mode=16203;case 16203:if(n.extra){for(x=n.extra;d<x;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=hi;break}n.mode=16204;case 16204:if(0===c)break e;if(f=h-c,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=hi;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),g=n.window}else g=s,p=i-n.offset,f=n.length;f>c&&(f=c),c-=f,n.length-=f;do{s[i++]=g[p++]}while(--f);0===n.length&&(n.mode=di);break;case 16205:if(0===c)break e;s[i++]=n.length,c--,n.mode=di;break;case ui:if(n.wrap){for(;d<32;){if(0===o)break e;o--,l|=r[a++]<<d,d+=8}if(h-=c,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?ps(n.check,s,h,i-h):hs(n.check,s,h,i-h)),h=c,4&n.wrap&&(n.flags?l:fi(l))!==n.check){e.msg="incorrect data check",n.mode=hi;break}l=0,d=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;d<32;){if(0===o)break e;o--,l+=r[a++]<<d,d+=8}if(4&n.wrap&&l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=hi;break}l=0,d=0}n.mode=16208;case 16208:A=Xa;break e;case hi:A=ei;break e;case 16210:return ti;default:return Qa}return e.next_out=i,e.avail_out=c,e.next_in=a,e.avail_in=o,n.hold=l,n.bits=d,(n.wsize||h!==e.avail_out&&n.mode<hi&&(n.mode<ui||t!==Wa))&&ki(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?ps(n.check,s,h,e.next_out-h):hs(n.check,s,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===ii?128:0)+(n.mode===li||n.mode===ci?256:0),(0===u&&0===h||t===Wa)&&A===Ga&&(A=ni),A},Ii=e=>{if(gi(e))return Qa;let t=e.state;return t.window&&(t.window=null),e.state=null,Ga},Ci=(e,t)=>{if(gi(e))return Qa;const n=e.state;return 2&n.wrap?(n.head=t,t.done=!1,Ga):Qa},Bi=(e,t)=>{const n=t.length;let r,s,a;return gi(e)?Qa:(r=e.state,0!==r.wrap&&r.mode!==ai?Qa:r.mode===ai&&(s=1,s=hs(s,t,n,0),s!==r.check)?ei:(a=ki(e,t,n,n),a?(r.mode=16210,ti):(r.havedict=1,Ga)))},Oi=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Ni=Object.prototype.toString,{Z_NO_FLUSH:Di,Z_FINISH:Li,Z_OK:Ri,Z_STREAM_END:Vi,Z_NEED_DICT:Pi,Z_STREAM_ERROR:Fi,Z_DATA_ERROR:Ui,Z_MEM_ERROR:Mi}=ms;function $i(e){this.options=wa({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ta,this.strm.avail_out=0;let n=Ti(this.strm,t.windowBits);if(n!==Ri)throw new Error(gs[n]);if(this.header=new Oi,Ci(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Aa(t.dictionary):"[object ArrayBuffer]"===Ni.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Bi(this.strm,t.dictionary),n!==Ri)))throw new Error(gs[n])}function Hi(e,t){const n=new $i(t);if(n.push(e),n.err)throw n.msg||gs[n.err];return n.result}$i.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,s=this.options.dictionary;let a,i,o;if(this.ended)return!1;for(i=t===~~t?t:!0===t?Li:Di,"[object ArrayBuffer]"===Ni.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=xi(n,i),a===Pi&&s&&(a=Bi(n,s),a===Ri?a=xi(n,i):a===Ui&&(a=Pi));n.avail_in>0&&a===Vi&&n.state.wrap>0&&0!==e[n.next_in];)Si(n),a=xi(n,i);switch(a){case Fi:case Ui:case Pi:case Mi:return this.onEnd(a),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(0===n.avail_out||a===Vi))if("string"===this.options.to){let e=Sa(n.output,n.next_out),t=n.next_out-e,s=ka(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(s)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(a!==Ri||0!==o){if(a===Vi)return a=Ii(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},$i.prototype.onData=function(e){this.chunks.push(e)},$i.prototype.onEnd=function(e){e===Ri&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ba(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var zi={Inflate:$i,inflate:Hi,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Hi(e,t)},ungzip:Hi,constants:ms};const{Deflate:ji,deflate:qi,deflateRaw:Ki,gzip:Wi}=Ua,{Inflate:Zi,inflate:Yi,inflateRaw:Gi,ungzip:Xi}=zi;var Ji=Wi,Qi=Xi;const eo=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),to=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),no=BigInt(1),ro=BigInt(2),so=(e,t)=>(e+t/ro)/t;const ao=dn(eo,void 0,void 0,{sqrt:function(e){const t=eo,n=BigInt(3),r=BigInt(6),s=BigInt(11),a=BigInt(22),i=BigInt(23),o=BigInt(44),c=BigInt(88),l=e*e*e%t,d=l*l*e%t,u=rn(d,n,t)*d%t,h=rn(u,n,t)*d%t,f=rn(h,ro,t)*l%t,p=rn(f,s,t)*f%t,g=rn(p,a,t)*p%t,m=rn(g,o,t)*g%t,y=rn(m,c,t)*m%t,_=rn(y,o,t)*g%t,w=rn(_,n,t)*d%t,b=rn(w,i,t)*p%t,v=rn(b,r,t)*l%t,E=rn(v,ro,t);if(!ao.eql(ao.sqr(E),e))throw new Error("Cannot find square root");return E}}),io=function(e,t){const n=t=>Rn({...e,...Mn(t)});return Object.freeze({...n(t),create:n})}({a:BigInt(0),b:BigInt(7),Fp:ao,n:to,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=to,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-no*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=n,i=BigInt("0x100000000000000000000000000000000"),o=so(a*e,t),c=so(-r*e,t);let l=tn(e-o*n-c*s,t),d=tn(-o*r-c*a,t);const u=l>i,h=d>i;if(u&&(l=t-l),h&&(d=t-d),l>i||d>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:u,k1:l,k2neg:h,k2:d}}}},It);BigInt(0),io.ProjectivePoint;const oo=(e,t,n=[])=>{const r=Object.getOwnPropertyDescriptors(t);for(let e of n)delete r[e];Object.defineProperties(e,r)},co=(e,t=[e])=>{const n=Object.getPrototypeOf(e);return null===n?t:co(n,[...t,n])},lo=(e,t,n=[])=>{var r;const s=null!==(r=((...e)=>{if(0===e.length)return;let t;const n=e.map(e=>co(e));for(;n.every(e=>e.length>0);){const e=n.map(e=>e.pop()),r=e[0];if(!e.every(e=>e===r))break;t=r}return t})(...e))&&void 0!==r?r:Object.prototype,a=Object.create(s),i=co(s);for(let t of e){let e=co(t);for(let t=e.length-1;t>=0;t--){let r=e[t];-1===i.indexOf(r)&&(oo(a,r,["constructor",...n]),i.push(r))}}return a.constructor=t,a},uo=e=>e.filter((t,n)=>e.indexOf(t)==n),ho=new WeakMap,fo=e=>ho.get(e),po=(e,t)=>{var n,r;const s=uo([...Object.getOwnPropertyNames(e),...Object.getOwnPropertyNames(t)]),a={};for(let i of s)a[i]=uo([...null!==(n=null==e?void 0:e[i])&&void 0!==n?n:[],...null!==(r=null==t?void 0:t[i])&&void 0!==r?r:[]]);return a},go=(e,t)=>{var n,r,s,a;return{property:po(null!==(n=null==e?void 0:e.property)&&void 0!==n?n:{},null!==(r=null==t?void 0:t.property)&&void 0!==r?r:{}),method:po(null!==(s=null==e?void 0:e.method)&&void 0!==s?s:{},null!==(a=null==t?void 0:t.method)&&void 0!==a?a:{})}},mo=(e,t)=>{var n,r,s,a,i,o;return{class:uo([...null!==(n=null==e?void 0:e.class)&&void 0!==n?n:[],...null!==(r=null==t?void 0:t.class)&&void 0!==r?r:[]]),static:go(null!==(s=null==e?void 0:e.static)&&void 0!==s?s:{},null!==(a=null==t?void 0:t.static)&&void 0!==a?a:{}),instance:go(null!==(i=null==e?void 0:e.instance)&&void 0!==i?i:{},null!==(o=null==t?void 0:t.instance)&&void 0!==o?o:{})}},yo=new Map;function _o(...e){var t,n,r;const s=e.map(e=>e.prototype);function a(...t){for(const n of e)oo(this,new n(...t))}a.prototype=lo(s,a),Object.setPrototypeOf(a,lo(e,null,["prototype"]));let i=a;{const s=((...e)=>{const t=((...e)=>{var t;const n=new Set,r=new Set([...e]);for(;r.size>0;)for(let e of r){const s=[...co(e.prototype).map(e=>e.constructor),...null!==(t=fo(e))&&void 0!==t?t:[]].filter(e=>!n.has(e));for(let e of s)r.add(e);n.add(e),r.delete(e)}return[...n]})(...e).map(e=>yo.get(e)).filter(e=>!!e);return 0==t.length?{}:1==t.length?t[0]:t.reduce((e,t)=>mo(e,t))})(...e);for(let e of null!==(t=null==s?void 0:s.class)&&void 0!==t?t:[]){const t=e(i);t&&(i=t)}wo(null!==(n=null==s?void 0:s.static)&&void 0!==n?n:{},i),wo(null!==(r=null==s?void 0:s.instance)&&void 0!==r?r:{},i.prototype)}var o,c;return o=i,c=e,ho.set(o,c),i}const wo=(e,t)=>{const n=e.property,r=e.method;if(n)for(let e in n)for(let r of n[e])r(t,e);if(r)for(let e in r)for(let n of r[e])n(t,e,Object.getOwnPropertyDescriptor(t,e))};var bo=Object.defineProperty,vo=Object.getOwnPropertyDescriptor,Eo=Object.getOwnPropertyNames,Ao=Object.prototype.hasOwnProperty,ko=(e,t)=>{for(var n in t)bo(e,n,{get:t[n],enumerable:!0})},So=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of Eo(t))Ao.call(e,s)||s===n||bo(e,s,{get:()=>t[s],enumerable:!(r=vo(t,s))||r.enumerable});return e},To={};ko(To,{ADDR_BOUND:()=>Qo,API_VERSION:()=>Go,BaseUrl:()=>dc,DEFAULT_GLOBAL_CONFIG:()=>gc,HARDENING_4BYTES:()=>lc,HARDENING_BYTE:()=>cc,IS_BROWSER:()=>Bo,MASK_250:()=>Zo,MASK_31:()=>Yo,MAX_STORAGE_ITEM_SIZE:()=>Jo,NetworkName:()=>uc,OutsideExecutionCallerAny:()=>ac,PAYMASTER_RPC_NODES:()=>yc,PRIME:()=>Xo,RANGE_FELT:()=>tc,RANGE_I128:()=>nc,RANGE_U128:()=>rc,RPC_DEFAULT_NODES:()=>mc,SNIP9_V1_INTERFACE_ID:()=>ic,SNIP9_V2_INTERFACE_ID:()=>oc,SYSTEM_MESSAGES:()=>_c,StarknetChainId:()=>hc,SupportedRpcVersion:()=>pc,TEXT_TO_FELT_MAX_LEN:()=>qo,TRANSACTION_VERSION:()=>Ko,TransactionHashPrefix:()=>fc,UDC:()=>sc,ZERO:()=>Wo});var xo={};ko(xo,{JRPC:()=>Io,PAYMASTER_API:()=>u,RPCSPEC07:()=>o,RPCSPEC08:()=>l});var Io={};So(xo,l,"default");var Co={};ko(Co,{IS_BROWSER:()=>Bo,addHexPrefix:()=>Fo,arrayBufferToString:()=>No,atobUniversal:()=>Lo,btoaUniversal:()=>Ro,buf2hex:()=>Vo,calcByteLength:()=>Mo,concatenateArrayBuffer:()=>jo,padLeft:()=>Uo,pascalToSnake:()=>zo,removeHexPrefix:()=>Po,sanitizeBytes:()=>$o,sanitizeHex:()=>Ho,utf8ToArray:()=>Do});var Bo="undefined"!=typeof window,Oo="0";function No(e){return new Uint8Array(e).reduce((e,t)=>e+String.fromCharCode(t),"")}function Do(e){return(new TextEncoder).encode(e)}function Lo(e){return N.decode(e)}function Ro(e){return N.encode(new Uint8Array(e))}function Vo(e){return e.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"")}function Po(e){return e.replace(/^0x/i,"")}function Fo(e){return`0x${Po(e)}`}function Uo(e,t,n=Oo){return function(e,t,n,r=Oo){const s=t-e.length;let a=e;if(s>0){const t=r.repeat(s);a=n?t+e:e+t}return a}(e,t,!0,n)}function Mo(e,t=8){const{length:n}=e,r=n%t;return r?(n-r)/t*t+t:n}function $o(e,t=8,n=Oo){return Uo(e,Mo(e,t),n)}function Ho(e){const t=$o(Po(e),2);return t?Fo(t):t}var zo=e=>/[a-z]/.test(e)?e.split(/(?=[A-Z])/).join("_").toUpperCase():e;function jo(e){const t=e.reduce((e,t)=>e+t.byteLength,0),n=new Uint8Array(t);let r=0;return e.forEach(e=>{n.set(e,r),r+=e.byteLength}),n}var qo=31,{ETransactionVersion:Ko}=l,Wo=0n,Zo=2n**250n-1n,Yo=2n**31n-1n,Go=Wo,Xo=2n**251n+17n*2n**192n+1n,Jo=256n,Qo=2n**251n-Jo,ec=(e,t)=>({min:e,max:t}),tc=ec(Wo,Xo-1n),nc=ec(-(2n**127n),2n**127n-1n),rc=ec(Wo,2n**128n-1n),sc={ADDRESS:"0x041a78e741e5af2fec34b695679bc6891742439f7afb8484ecd7766661ad02bf",ENTRYPOINT:"deployContract"},ac="0x414e595f43414c4c4552",ic="0x68cfd18b92d1907b8ba3cc324900277f5a3622099431ea85dd8089255e4181",oc="0x1d1144bb2138366ff28d8e9ab57456b1d332ac42196230c3a602003c89872",cc=128,lc=2147483648n,dc={SN_MAIN:"https://alpha-mainnet.starknet.io",SN_SEPOLIA:"https://alpha-sepolia.starknet.io"},uc={SN_MAIN:"SN_MAIN",SN_SEPOLIA:"SN_SEPOLIA"},hc={SN_MAIN:"0x534e5f4d41494e",SN_SEPOLIA:"0x534e5f5345504f4c4941"},fc={DECLARE:"0x6465636c617265",DEPLOY:"0x6465706c6f79",DEPLOY_ACCOUNT:"0x6465706c6f795f6163636f756e74",INVOKE:"0x696e766f6b65",L1_HANDLER:"0x6c315f68616e646c6572"},pc={"0.7.1":"0.7.1","0.8.1":"0.8.1",v0_7_1:"0.7.1",v0_8_1:"0.8.1"},gc={legacyMode:!1,rpcVersion:"0.8.1",transactionVersion:xo.ETransactionVersion.V3,logLevel:"INFO",feeMarginPercentage:{bounds:{l1_gas:{max_amount:50,max_price_per_unit:50},l1_data_gas:{max_amount:50,max_price_per_unit:50},l2_gas:{max_amount:50,max_price_per_unit:50}},maxFee:50},fetch:void 0,websocket:void 0},mc={SN_MAIN:["https://starknet-mainnet.public.blastapi.io/rpc/"],SN_SEPOLIA:["https://starknet-sepolia.public.blastapi.io/rpc/"]},yc={SN_MAIN:["https://starknet.paymaster.avnu.fi"],SN_SEPOLIA:["https://sepolia.paymaster.avnu.fi"]},_c={legacyTxWarningMessage:"You are using a deprecated transaction version (V0,V1,V2)!\nUpdate to the latest V3 transactions!",legacyTxRPC08Message:"RPC 0.8 do not support legacy transactions",SWOldV3:"RPC 0.7 V3 tx (improper resource bounds) not supported in RPC 0.8",channelVersionMismatch:"Channel specification version is not compatible with the connected node Specification Version",unsupportedSpecVersion:"The connected node specification version is not supported by this library",maxFeeInV3:"maxFee is not supported in V3 transactions, use resourceBounds instead"},wc=class e{static instance;config;constructor(){this.initialize()}initialize(){this.config={...gc}}static getInstance(){return e.instance||(e.instance=new e),e.instance}get(e,t){return this.config[e]??t}set(e,t){this.config[e]=t}update(e){this.config={...this.config,...e}}getAll(){return{...this.config}}reset(){this.initialize()}delete(e){delete this.config[e]}hasKey(e){return e in this.config}}.getInstance(),bc={DEBUG:5,INFO:4,WARN:3,ERROR:2,FATAL:1,OFF:0},vc=class e{static instance;config;constructor(){this.config=wc}static getInstance(){return e.instance||(e.instance=new e),e.instance}getTimestamp(){return(new Date).toISOString()}shouldLog(e){const t=this.config.get("logLevel","INFO");return e<=bc[t]}formatMessage(e){const{level:t,message:n,timestamp:r,data:s}=e;let a=`[${r}] ${t}: ${n}`;if(s)try{a+=`\n${JSON.stringify(s,null,2)}`}catch(e){a+=`\n[JSON.stringify Error/Circular]: ${e}`}return a}log(e,t,n){if(!this.shouldLog(bc[e]))return;const r={level:e,message:t,timestamp:this.getTimestamp(),data:n},s=this.formatMessage(r);switch(e){case"DEBUG":console.debug(s);break;case"INFO":console.info(s);break;case"WARN":console.warn(s);break;case"ERROR":case"FATAL":console.error(s);break;case"OFF":break;default:console.log(s)}}debug(e,t){this.log("DEBUG",e,t)}info(e,t){this.log("INFO",e,t)}warn(e,t){this.log("WARN",e,t)}error(e,t){this.log("ERROR",e,t)}fatal(e,t){this.log("FATAL",e,t)}setLogLevel(e){this.config.set("logLevel",e)}getLogLevel(){return this.config.get("logLevel","INFO")}getEnabledLogLevels(){return Object.keys(bc).filter(e=>this.shouldLog(bc[e])&&"OFF"!==e)}}.getInstance(),Ec={};ko(Ec,{RpcChannel:()=>af});var Ac={};ko(Ac,{BlockStatus:()=>Ic,BlockTag:()=>Cc,EDAMode:()=>Lc,EDataAvailabilityMode:()=>Dc,ETH_ADDRESS:()=>Hc,ETransactionExecutionStatus:()=>Fc,ETransactionStatus:()=>Pc,ETransactionVersion:()=>Bc,ETransactionVersion2:()=>Oc,ETransactionVersion3:()=>Nc,EntryPointType:()=>kc,Literal:()=>$c,NON_ZERO_PREFIX:()=>zc,OutsideExecutionTypesV1:()=>jc,OutsideExecutionTypesV2:()=>qc,OutsideExecutionVersion:()=>Kc,RPC:()=>xo,TransactionExecutionStatus:()=>xc,TransactionFinalityStatus:()=>Tc,TransactionType:()=>Sc,TypedDataRevision:()=>U.K,Uint:()=>Mc,ValidateType:()=>Uc,isRPC08_FeeEstimate:()=>Rc,isRPC08_ResourceBounds:()=>Vc});var kc={EXTERNAL:"EXTERNAL",L1_HANDLER:"L1_HANDLER",CONSTRUCTOR:"CONSTRUCTOR"},Sc={DECLARE:"DECLARE",DEPLOY:"DEPLOY",DEPLOY_ACCOUNT:"DEPLOY_ACCOUNT",INVOKE:"INVOKE_FUNCTION"},Tc={NOT_RECEIVED:"NOT_RECEIVED",RECEIVED:"RECEIVED",ACCEPTED_ON_L2:"ACCEPTED_ON_L2",ACCEPTED_ON_L1:"ACCEPTED_ON_L1"},xc={REJECTED:"REJECTED",REVERTED:"REVERTED",SUCCEEDED:"SUCCEEDED"},Ic={PENDING:"PENDING",ACCEPTED_ON_L1:"ACCEPTED_ON_L1",ACCEPTED_ON_L2:"ACCEPTED_ON_L2",REJECTED:"REJECTED"},Cc={PENDING:"pending",LATEST:"latest"},{ETransactionVersion:Bc}=l,{ETransactionVersion2:Oc}=l,{ETransactionVersion3:Nc}=l,{EDataAvailabilityMode:Dc}=l,{EDAMode:Lc}=l;function Rc(e){return"l1_data_gas_consumed"in e}function Vc(e){return"l1_data_gas"in e}var{ETransactionStatus:Pc}=l,{ETransactionExecutionStatus:Fc}=l,Uc={DEPLOY:"DEPLOY",CALL:"CALL",INVOKE:"INVOKE"},Mc={u8:"core::integer::u8",u16:"core::integer::u16",u32:"core::integer::u32",u64:"core::integer::u64",u128:"core::integer::u128",u256:"core::integer::u256",u512:"core::integer::u512"},$c={ClassHash:"core::starknet::class_hash::ClassHash",ContractAddress:"core::starknet::contract_address::ContractAddress",Secp256k1Point:"core::starknet::secp256k1::Secp256k1Point",U96:"core::internal::bounded_int::BoundedInt::<0, 79228162514264337593543950335>"},Hc="core::starknet::eth_address::EthAddress",zc="core::zeroable::NonZero::",jc={StarkNetDomain:[{name:"name",type:"felt"},{name:"version",type:"felt"},{name:"chainId",type:"felt"}],OutsideExecution:[{name:"caller",type:"felt"},{name:"nonce",type:"felt"},{name:"execute_after",type:"felt"},{name:"execute_before",type:"felt"},{name:"calls_len",type:"felt"},{name:"calls",type:"OutsideCall*"}],OutsideCall:[{name:"to",type:"felt"},{name:"selector",type:"felt"},{name:"calldata_len",type:"felt"},{name:"calldata",type:"felt*"}]},qc={StarknetDomain:[{name:"name",type:"shortstring"},{name:"version",type:"shortstring"},{name:"chainId",type:"shortstring"},{name:"revision",type:"shortstring"}],OutsideExecution:[{name:"Caller",type:"ContractAddress"},{name:"Nonce",type:"felt"},{name:"Execute After",type:"u128"},{name:"Execute Before",type:"u128"},{name:"Calls",type:"Call*"}],Call:[{name:"To",type:"ContractAddress"},{name:"Selector",type:"selector"},{name:"Calldata",type:"felt*"}]},Kc={UNSUPPORTED:"0",V1:"1",V2:"2"},Wc={};ko(Wc,{parse:()=>Yc,parseAlwaysAsBig:()=>Gc,stringify:()=>Xc});var Zc=e=>{if(!M(e))return parseFloat(e);const t=parseInt(e,10);return Number.isSafeInteger(t)?t:BigInt(e)},Yc=e=>G(String(e),void 0,Zc),Gc=e=>G(String(e),void 0,Z),Xc=(e,t,n,r)=>Ie(e,t,n,r),Jc=class{nodeUrl;headers;interval;requestId=0;pendingRequests={};batchPromises={};delayTimer;delayPromise;delayPromiseResolve;baseFetch;constructor(e){this.nodeUrl=e.nodeUrl,this.headers=e.headers,this.interval=e.interval,this.baseFetch=e.baseFetch}async wait(){return this.delayPromise&&this.delayPromiseResolve||(this.delayPromise=new Promise(e=>{this.delayPromiseResolve=e})),this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=void 0),this.delayTimer=setTimeout(()=>{this.delayPromiseResolve&&(this.delayPromiseResolve(),this.delayPromise=void 0,this.delayPromiseResolve=void 0)},this.interval),this.delayPromise}addPendingRequest(e,t,n){const r={id:n??`batched_${this.requestId+=1}`,jsonrpc:"2.0",method:e,params:t??void 0};return this.pendingRequests[r.id]=r,r.id}async sendBatch(e){return(await this.baseFetch(this.nodeUrl,{method:"POST",body:Xc(e),headers:this.headers})).json()}async fetch(e,t,n){const r=this.addPendingRequest(e,t,n);await this.wait();const s=this.pendingRequests;if(this.pendingRequests={},!this.batchPromises[r]){const e=this.sendBatch(Object.values(s));Object.keys(s).forEach(t=>{this.batchPromises[t]=e})}const a=await this.batchPromises[r];delete this.batchPromises[r];const i=a.find(e=>e.id===r);if(!i)throw new Error(`Couldn't find the result for the request. Method: ${e}`);return i}};function Qc(e,t){if(!e)throw new Error(t||"Assertion failure")}function el(e,t){if(!e){if(0!==t.length)throw new Error("AssertionX failure: message function should not require arguments");t()}}var tl={};ko(tl,{addPercent:()=>Tl,assertInRange:()=>yl,bigNumberishArrayToDecimalStringArray:()=>_l,bigNumberishArrayToHexadecimalStringArray:()=>wl,cleanHex:()=>ml,getDecimalString:()=>vl,getHexString:()=>El,getHexStringArray:()=>Al,hexToBytes:()=>Sl,hexToDecimalString:()=>gl,isBigNumberish:()=>Il,isHex:()=>cl,isStringWholeNumber:()=>bl,stringToSha256ToArrayBuff4:()=>xl,toBigInt:()=>ll,toCairoBool:()=>kl,toHex:()=>ul,toHex64:()=>pl,toHexString:()=>hl,toStorageKey:()=>fl,tryToBigInt:()=>dl});var nl=e=>void 0===e||void 0===e;function rl(e){return"number"==typeof e}function sl(e){return"boolean"==typeof e}function al(e){return"bigint"==typeof e}function il(e){return"string"==typeof e}function ol(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function cl(e){return/^0x[0-9a-f]*$/i.test(e)}function ll(e){return BigInt(e)}function dl(e){return e?BigInt(e):void 0}function ul(e){return Fo(ll(e).toString(16))}var hl=ul;function fl(e){return Fo(ll(e).toString(16).padStart(64,"0"))}function pl(e){const t=Fo(ll(e).toString(16).padStart(64,"0"));if(66!==t.length)throw TypeError("number is too big for hex 0x(64) representation");return t}function gl(e){return BigInt(Fo(e)).toString(10)}function ml(e){return e.toLowerCase().replace(/^(0x)0+/,"$1")}function yl(e,t,n,r=""){const s=""===r?"invalid length":`invalid ${r} length`,a=BigInt(e),i=BigInt(t),o=BigInt(n);Qc(a>=i&&a<=o,`Message not signable, ${s}.`)}function _l(e){return e.map(e=>ll(e).toString(10))}function wl(e){return e.map(e=>ul(e))}function bl(e){return/^\d+$/.test(e)}function vl(e){if(cl(e))return gl(e);if(bl(e))return e;throw new Error(`${e} needs to be a hex-string or whole-number-string`)}function El(e){if(cl(e))return e;if(bl(e))return hl(e);throw new Error(`${e} needs to be a hex-string or whole-number-string`)}function Al(e){return e.map(El)}function kl(e){return(+e).toString()}function Sl(e){if(!cl(e))throw new Error(`${e} needs to be a hex-string`);let t=Po(e);return t.length%2!=0&&(t=`0${t}`),$e(t)}function Tl(e,t){const n=BigInt(e);return n+n*BigInt(t)/100n}function xl(e){var t;return Sl(ul((t=BigInt(Fo(Vo(It(e)))),Number(t&Yo))))}function Il(e){return rl(e)||al(e)||il(e)&&(cl(e)||bl(e))}var Cl={};function Bl(e){const t=Po(ul(BigInt(e))),n=t.length%2==0?t:`0${t}`;return Fo(br(Sl(Fo(n))).toString(16))}function Ol(e){const t=BigInt(function(e){return Fo(br(Do(e)).toString(16))}(e));return t&Zo}function Nl(e){return ul(Ol(e))}function Dl(e){return rl(e)||al(e)?ul(e):cl(e)?e:bl(e)?ul(e):Nl(e)}function Ll(e){const t=Fo(e.reduce((e,t)=>e+Po(ul(t)).padStart(64,"0"),""));return Fo(Ve(Wt(Sl(t))))}function Rl(e,t,n,r,s){return Ll([e,t,s,n,r.length,...r])}function Vl(e,t,n){return Ll([e,t,n.length,...n])}ko(Cl,{getL1MessageHash:()=>Vl,getL2MessageHash:()=>Rl,getSelector:()=>Dl,getSelectorFromName:()=>Nl,keccakBn:()=>Bl,solidityUint256PackedKeccak256:()=>Ll,starknetKeccak:()=>Ol});var Pl={};function Fl(e){return/^[\x00-\x7F]*$/.test(e)}function Ul(e){return e.length<=qo}function Ml(e){return/^[0-9]*$/i.test(e)}function $l(e){return il(e)&&!cl(e)&&!bl(e)}ko(Pl,{decodeShortString:()=>Kl,encodeShortString:()=>ql,isASCII:()=>Fl,isDecimalString:()=>Ml,isLongText:()=>zl,isShortString:()=>Ul,isShortText:()=>Hl,isText:()=>$l,splitLongString:()=>jl});var Hl=e=>$l(e)&&Ul(e),zl=e=>$l(e)&&!Ul(e);function jl(e){const t=RegExp(`[^]{1,${qo}}`,"g");return e.match(t)||[]}function ql(e){if(!Fl(e))throw new Error(`${e} is not an ASCII string`);if(!Ul(e))throw new Error(`${e} is too long`);return Fo(e.replace(/./g,e=>e.charCodeAt(0).toString(16)))}function Kl(e){if(!Fl(e))throw new Error(`${e} is not an ASCII string`);if(cl(e))return Po(e).replace(/.{2}/g,e=>String.fromCharCode(parseInt(e,16)));if(Ml(e))return Kl("0X".concat(BigInt(e).toString(16)));throw new Error(`${e} is not Hex or decimal`)}var Wl={};function Zl(e){const t=0n===BigInt(e.pending_word)?"":Kl(ul(e.pending_word));return e.data.reduce((e,t)=>e+(0n===BigInt(t)?"":Kl(ul(t))),"")+t}function Yl(e){const t=jl(e),n=t[t.length-1],r=t.map(ql),[s,a]=void 0===n||31===n.length?["0x00",0]:[r.pop(),n.length];return{data:0===r.length?[]:r,pending_word:s,pending_word_len:a}}ko(Wl,{byteArrayFromString:()=>Yl,stringFromByteArray:()=>Zl});var Gl={};function Xl(e){if(al(e)||Number.isInteger(e))return e.toString();if(il(e)){if(cl(e))return BigInt(e).toString();if($l(e)){if(!Ul(e))throw new Error(`${e} is a long string > 31 chars. Please split it into an array of short strings.`);return BigInt(ql(e)).toString()}if(bl(e))return e}if(sl(e))return""+ +e;throw new Error(`${e} can't be computed by felt()`)}ko(Gl,{felt:()=>Pd,getAbiContractVersion:()=>Dd,getArrayType:()=>Bd,isCairo1Abi:()=>Od,isCairo1Type:()=>Cd,isLen:()=>dd,isTypeArray:()=>hd,isTypeBool:()=>Ed,isTypeByteArray:()=>Td,isTypeBytes31:()=>Sd,isTypeContractAddress:()=>Ad,isTypeEnum:()=>md,isTypeEthAddress:()=>kd,isTypeFelt:()=>ud,isTypeLiteral:()=>vd,isTypeNamedTuple:()=>pd,isTypeNonZero:()=>Nd,isTypeOption:()=>yd,isTypeResult:()=>_d,isTypeSecp256k1Point:()=>Id,isTypeStruct:()=>gd,isTypeTuple:()=>fd,isTypeU96:()=>xd,isTypeUint:()=>wd,isTypeUint256:()=>bd,tuple:()=>Vd,uint256:()=>Ld,uint512:()=>Rd});var Jl=(1n<<128n)-1n,Ql=(1n<<256n)-1n,ed=0n,td=340282366920938463463374607431768211455n,nd=340282366920938463463374607431768211455n,rd=0n,sd=0n,ad=class e{low;high;static abiSelector="core::integer::u256";constructor(...t){if("object"==typeof t[0]&&1===t.length&&"low"in t[0]&&"high"in t[0]){const n=e.validateProps(t[0].low,t[0].high);this.low=n.low,this.high=n.high}else if(1===t.length){const n=e.validate(t[0]);this.low=n&Jl,this.high=n>>128n}else{if(2!==t.length)throw Error("Incorrect constructor parameters");{const n=e.validateProps(t[0],t[1]);this.low=n.low,this.high=n.high}}}static validate(e){const t=BigInt(e);if(t<ed)throw Error("bigNumberish is smaller than UINT_256_MIN");if(t>Ql)throw new Error("bigNumberish is bigger than UINT_256_MAX");return t}static validateProps(e,t){const n=BigInt(e),r=BigInt(t);if(n<rd||n>td)throw new Error("low is out of range UINT_256_LOW_MIN - UINT_256_LOW_MAX");if(r<sd||r>nd)throw new Error("high is out of range UINT_256_HIGH_MIN - UINT_256_HIGH_MAX");return{low:n,high:r}}static is(t){try{e.validate(t)}catch(e){return!1}return!0}static isAbiType(t){return t===e.abiSelector}toBigInt(){return(this.high<<128n)+this.low}toUint256HexString(){return{low:Fo(this.low.toString(16)),high:Fo(this.high.toString(16))}}toUint256DecimalString(){return{low:this.low.toString(10),high:this.high.toString(10)}}toApiRequest(){return[Xl(this.low),Xl(this.high)]}},id=(1n<<512n)-1n,od=0n,cd=0n,ld=class e{limb0;limb1;limb2;limb3;static abiSelector="core::integer::u512";constructor(...t){if("object"==typeof t[0]&&1===t.length&&"limb0"in t[0]&&"limb1"in t[0]&&"limb2"in t[0]&&"limb3"in t[0]){const n=e.validateProps(t[0].limb0,t[0].limb1,t[0].limb2,t[0].limb3);this.limb0=n.limb0,this.limb1=n.limb1,this.limb2=n.limb2,this.limb3=n.limb3}else if(1===t.length){const n=e.validate(t[0]);this.limb0=n&Jl,this.limb1=(n&Jl<<128n)>>128n,this.limb2=(n&Jl<<256n)>>256n,this.limb3=n>>384n}else{if(4!==t.length)throw Error("Incorrect Uint512 constructor parameters");{const n=e.validateProps(t[0],t[1],t[2],t[3]);this.limb0=n.limb0,this.limb1=n.limb1,this.limb2=n.limb2,this.limb3=n.limb3}}}static validate(e){const t=BigInt(e);if(t<od)throw Error("bigNumberish is smaller than UINT_512_MIN.");if(t>id)throw Error("bigNumberish is bigger than UINT_512_MAX.");return t}static validateProps(e,t,n,r){const s=BigInt(e),a=BigInt(t),i=BigInt(n),o=BigInt(r);return[s,a,i,o].forEach((e,t)=>{if(e<cd||e>Jl)throw Error(`limb${t} is not in the range of a u128 number`)}),{limb0:s,limb1:a,limb2:i,limb3:o}}static is(t){try{e.validate(t)}catch(e){return!1}return!0}static isAbiType(t){return t===e.abiSelector}toBigInt(){return(this.limb3<<384n)+(this.limb2<<256n)+(this.limb1<<128n)+this.limb0}toUint512HexString(){return{limb0:Fo(this.limb0.toString(16)),limb1:Fo(this.limb1.toString(16)),limb2:Fo(this.limb2.toString(16)),limb3:Fo(this.limb3.toString(16))}}toUint512DecimalString(){return{limb0:this.limb0.toString(10),limb1:this.limb1.toString(10),limb2:this.limb2.toString(10),limb3:this.limb3.toString(10)}}toApiRequest(){return[Xl(this.limb0),Xl(this.limb1),Xl(this.limb2),Xl(this.limb3)]}},dd=e=>/_len$/.test(e),ud=e=>"felt"===e||"core::felt252"===e,hd=e=>/\*/.test(e)||e.startsWith("core::array::Array::")||e.startsWith("core::array::Span::"),fd=e=>/^\(.*\)$/i.test(e),pd=e=>/\(.*\)/i.test(e)&&e.includes(":"),gd=(e,t)=>e in t,md=(e,t)=>e in t,yd=e=>e.startsWith("core::option::Option::"),_d=e=>e.startsWith("core::result::Result::"),wd=e=>Object.values(Mc).includes(e),bd=e=>ad.isAbiType(e),vd=e=>Object.values($c).includes(e),Ed=e=>"core::bool"===e,Ad=e=>e===$c.ContractAddress,kd=e=>e===Hc,Sd=e=>"core::bytes_31::bytes31"===e,Td=e=>"core::byte_array::ByteArray"===e,xd=e=>"core::internal::bounded_int::BoundedInt::<0, 79228162514264337593543950335>"===e,Id=e=>e===$c.Secp256k1Point,Cd=e=>e.includes("::"),Bd=e=>Cd(e)?e.substring(e.indexOf("<")+1,e.lastIndexOf(">")):e.replace("*","");function Od(e){const{cairo:t}=Dd(e);if(void 0===t)throw Error("Unable to determine Cairo version");return"1"===t}function Nd(e){return e.startsWith(zc)}function Dd(e){if(e.find(e=>"interface"===e.type))return{cairo:"1",compiler:"2"};const t=e.find(e=>("function"===e.type||"constructor"===e.type)&&(e.inputs.length||e.outputs.length));if(!t)return{cairo:void 0,compiler:void 0};const n=t.inputs.length?t.inputs:t.outputs;return Cd(n[0].type)?{cairo:"1",compiler:"1"}:{cairo:"0",compiler:"0"}}var Ld=e=>new ad(e).toUint256DecimalString(),Rd=e=>new ld(e).toUint512DecimalString(),Vd=(...e)=>({...e});function Pd(e){return Xl(e)}var Fd=class{variant;constructor(e){const t=Object.values(e);if(0===t.length)throw new Error("This Enum must have at least 1 variant");if(1!==t.filter(e=>!nl(e)).length)throw new Error("This Enum must have exactly one active variant");this.variant=e}unwrap(){return Object.values(this.variant).find(e=>!nl(e))}activeVariant(){const e=Object.entries(this.variant).find(e=>!nl(e[1]));return nl(e)?"":e[0]}},Ud={Some:0,None:1},Md=class{Some;None;constructor(e,t){if(!(e in Object.values(Ud)))throw new Error("Wrong variant! It should be CairoOptionVariant.Some or .None.");if(e===Ud.Some){if(nl(t))throw new Error('The creation of a Cairo Option with "Some" variant needs a content as input.');this.Some=t,this.None=void 0}else this.Some=void 0,this.None=!0}unwrap(){return this.None?void 0:this.Some}isSome(){return!nl(this.Some)}isNone(){return!0===this.None}},$d={Ok:0,Err:1},Hd=class{Ok;Err;constructor(e,t){if(!(e in Object.values($d)))throw new Error("Wrong variant! It should be CairoResultVariant.Ok or .Err.");e===$d.Ok?(this.Ok=t,this.Err=void 0):(this.Ok=void 0,this.Err=t)}unwrap(){if(!nl(this.Ok))return this.Ok;if(!nl(this.Err))return this.Err;throw new Error("Both Result.Ok and .Err are undefined. Not authorized.")}isOk(){return!nl(this.Ok)}isErr(){return!nl(this.Err)}},zd=(e,t,n)=>{if(!al(e[n]))throw new Error(`Data and formatter mismatch on ${n}:${t[n]}, expected response data ${n}:${e[n]} to be BN instead it is ${typeof e[n]}`)};function jd(e,t,n){return Object.entries(e).reduce((r,[s,a])=>{const i=n??t[s];if(!(s in t)&&!n)return r[s]=a,r;if("string"===i){if(Array.isArray(e[s])){const t=jd(e[s],e[s].map(e=>i));return r[s]=Object.values(t).join(""),r}return zd(e,t,s),r[s]=Kl(a),r}if("number"===i)return zd(e,t,s),r[s]=Number(a),r;if("function"==typeof i)return r[s]=i(a),r;if(Array.isArray(i)){const t=jd(e[s],i,i[0]);return r[s]=Object.values(t),r}return ol(i)?(r[s]=jd(e[s],i),r):(((e,t,n)=>{throw new Error(`Unhandled formatter type on ${n}:${t[n]} for data ${n}:${e[n]}`)})(e,t,s),r)},{})}var qd=class{abi;constructor(e){this.abi=e}methodInputsLength(e){return e.inputs.reduce((e,t)=>dd(t.name)?e:e+1,0)}getMethod(e){return this.abi.find(t=>t.name===e)}getLegacyFormat(){return this.abi}},Kd=class{abi;constructor(e){this.abi=e}methodInputsLength(e){return e.inputs.length}getMethod(e){const t=this.abi.find(e=>"interface"===e.type);return t?.items?.find(t=>t.name===e)}getLegacyFormat(){return this.abi.flatMap(e=>"interface"===e.type?e.items:e)}};function Wd(e){const t=function(e){return e.find(e=>"interface"===e.type)?2:Od(e)?1:0}(e);if(0===t||1===t)return new qd(e);if(2===t)return new Kd(e);throw Error(`Unsupported ABI version ${t}`)}function Zd(e,t,n){return"constructor"===e&&!n&&!t.length}function Yd(e,t,n){for(let r=0,s=0;r<e.length;r++)if(e[r]===t)s++;else if(e[r]===n&&0===--s)return r;return Number.POSITIVE_INFINITY}function Gd(e){return Cd(e)?function(e){const t=e.slice(1,-1),n=[];let r,s=0;for(;s<t.length;){switch(!0){case"("===t[s]:r=s+Yd(t.slice(s),"(",")")+1;break;case t.startsWith("core::result::Result::<",s)||t.startsWith("core::array::Array::<",s)||t.startsWith("core::option::Option::<",s):r=s+Yd(t.slice(s),"<",">")+1;break;default:{const e=t.indexOf(",",s);r=-1!==e?e:Number.POSITIVE_INFINITY}}n.push(t.slice(s,r)),s=r+2}return n}(e):function(e){const t=e.replace(/\s/g,"").slice(1,-1),{subTuple:n,result:r}=function(e){if(!e.includes("("))return{subTuple:[],result:e};const t=[];let n="",r=0;for(;r<e.length;){if("("===e[r]){let s=1;const a=r;for(r++;s;)")"===e[r]&&s--,"("===e[r]&&s++,r++;t.push(e.substring(a,r)),n+=" ",r--}else n+=e[r];r++}return{subTuple:t,result:n}}(t);let s=r.split(",").map(e=>n.length?e.replace(" ",n.shift()):e);return pd(e)&&(s=s.reduce((e,t)=>e.concat(function(e){const t=e.substring(0,e.indexOf(":"));return{name:t,type:e.substring(t.length+1)}}(t)),[])),s}(e)}var Xd=class e{content;arrayType;constructor(t,n){Qc(e.isTypeFixedArray(n),`The type ${n} is not a Cairo fixed array. Needs [type; length].`);try{e.getFixedArrayType(n)}catch{throw new Error(`The type ${n} do not includes any content type. Needs [type; length].`)}try{e.getFixedArraySize(n)}catch{throw new Error(`The type ${n} type do not includes any length. Needs [type; length].`)}Qc(e.getFixedArraySize(n)===t.length,`The ABI type ${n} is expecting ${e.getFixedArraySize(n)} items. ${t.length} items provided.`),this.content=t,this.arrayType=n}static getFixedArraySize(e){const t=e.match(/(?<=; )\d+(?=\])/);if(null===t)throw new Error(`ABI type ${e} do not includes a valid number after ';' character.`);return Number(t[0])}getFixedArraySize(){return e.getFixedArraySize(this.arrayType)}static getFixedArrayType=e=>{const t=e.match(/(?<=\[).+(?=;)/);if(null===t)throw new Error(`ABI type ${e} do not includes a valid type of data.`);return t[0]};getFixedArrayType(){return e.getFixedArrayType(this.arrayType)}static compile(e){return e.reduce((e,t,n)=>(e[n]=t,e),{})}compile(){return e.compile(this.content)}static isTypeFixedArray(e){return/^\[.*;\s.*\]$/.test(e)&&/(?<=\[).+(?=;)/.test(e)&&/(?<=; )\d+(?=\])/.test(e)}};function Jd(e,t){switch(!0){case ad.isAbiType(e):return new ad(t).toApiRequest();case ld.isAbiType(e):return new ld(t).toApiRequest();case Sd(e):return ql(t.toString());case Id(e):{const e=Po(ul(t)).padStart(128,"0"),n=Ld(Fo(e.slice(-64))),r=Ld(Fo(e.slice(0,-64)));return[Pd(r.low),Pd(r.high),Pd(n.low),Pd(n.high)]}default:return Pd(t)}}function Qd(e,t,n,r){if(void 0===e)throw Error(`Missing parameter for type ${t}`);if(Xd.isTypeFixedArray(t)){const s=Xd.getFixedArrayType(t);let a=[];if(Array.isArray(e))a=new Xd(e,t).content;else{if("object"!=typeof e)throw new Error(`ABI type ${t}: not an Array representing a cairo.fixedArray() provided.`);a=Object.values(e),Qc(a.length===Xd.getFixedArraySize(t),`ABI type ${t}: object provided do not includes  ${Xd.getFixedArraySize(t)} items. ${a.length} items provided.`)}return a.reduce((e,t)=>e.concat(Qd(t,s,n,r)),[])}if(Array.isArray(e)){const s=[];s.push(Pd(e.length));const a=Bd(t);return e.reduce((e,t)=>e.concat(Qd(t,a,n,r)),s)}if(n[t]&&n[t].members.length){if(ad.isAbiType(t))return new ad(e).toApiRequest();if(ld.isAbiType(t))return new ld(e).toApiRequest();if(kd(t))return Jd(t,e);if(Td(t))return function(e){const t=Yl(e);return[t.data.length.toString(),...t.data.map(e=>e.toString()),t.pending_word.toString(),t.pending_word_len.toString()]}(e);const{members:s}=n[t],a=e;return s.reduce((e,t)=>e.concat(Qd(a[t.name],t.type,n,r)),[])}if(fd(t)){const s=function(e,t){const n=Gd(t),r=Object.values(e);if(r.length!==n.length)throw Error(`ParseTuple: provided and expected abi tuple size do not match.\n      provided: ${r}\n      expected: ${n}`);return n.map((e,t)=>({element:r[t],type:e.type??e}))}(e,t);return s.reduce((e,t)=>{const s=Qd(t.element,t.type,n,r);return e.concat(s)},[])}if(ad.isAbiType(t))return new ad(e).toApiRequest();if(ld.isAbiType(t))return new ld(e).toApiRequest();if(md(t,r)){const{variants:s}=r[t];if(yd(t)){const t=e;if(t.isSome()){const e=s.find(e=>"Some"===e.name);if(nl(e))throw Error("Error in abi : Option has no 'Some' variant.");const a=e.type;if("()"===a)return Ud.Some.toString();const i=Qd(t.unwrap(),a,n,r);return Array.isArray(i)?[Ud.Some.toString(),...i]:[Ud.Some.toString(),i]}return Ud.None.toString()}if(_d(t)){const t=e;if(t.isOk()){const e=s.find(e=>"Ok"===e.name);if(nl(e))throw Error("Error in abi : Result has no 'Ok' variant.");const a=e.type;if("()"===a)return $d.Ok.toString();const i=Qd(t.unwrap(),a,n,r);return Array.isArray(i)?[$d.Ok.toString(),...i]:[$d.Ok.toString(),i]}const a=s.find(e=>"Err"===e.name);if(nl(a))throw Error("Error in abi : Result has no 'Err' variant.");const i=a.type;if("()"===i)return $d.Err.toString();const o=Qd(t.unwrap(),i,n,r);return Array.isArray(o)?[$d.Err.toString(),...o]:[$d.Err.toString(),o]}const a=e,i=a.activeVariant(),o=s.find(e=>e.name===i);if(nl(o))throw Error(`Not find in abi : Enum has no '${i}' variant.`);const c=o.type,l=s.findIndex(e=>e.name===i);if("()"===c)return l.toString();const d=Qd(a.unwrap(),c,n,r);return Array.isArray(d)?[l.toString(),...d]:[l.toString(),d]}if(Nd(t))return Jd(Bd(t),e);if("object"==typeof e)throw Error(`Parameter ${e} do not align with abi parameter ${t}`);return Jd(t,e)}function eu(e,t,n,r){const{name:s,type:a}=t;let{value:i}=e.next();switch(!0){case Xd.isTypeFixedArray(a):if(!Array.isArray(i)&&"object"!=typeof i)throw Error(`ABI expected parameter ${s} to be an array or an object, got ${i}`);return Qd(i,t.type,n,r);case hd(a):if(!Array.isArray(i)&&!$l(i))throw Error(`ABI expected parameter ${s} to be array or long string, got ${i}`);return il(i)&&(i=jl(i)),Qd(i,t.type,n,r);case Nd(a):return Jd(Bd(a),i);case kd(a):return Jd(a,i);case gd(a,n)||fd(a)||ad.isAbiType(a):case md(a,r):return Qd(i,a,n,r);default:return Jd(a,i)}}function tu(e,t){let n;switch(!0){case Ed(e):return n=t.next().value,Boolean(BigInt(n));case ad.isAbiType(e):const r=t.next().value,s=t.next().value;return new ad(r,s).toBigInt();case ld.isAbiType(e):const a=t.next().value,i=t.next().value,o=t.next().value,c=t.next().value;return new ld(a,i,o,c).toBigInt();case kd(e):return n=t.next().value,BigInt(n);case Sd(e):return n=t.next().value,Kl(n);case Id(e):const l=Po(t.next().value).padStart(32,"0"),d=Po(t.next().value).padStart(32,"0"),u=Po(t.next().value).padStart(32,"0"),h=Po(t.next().value).padStart(32,"0");return BigInt(Fo(d+l+h+u));default:return n=t.next().value,BigInt(n)}}function nu(e,t,n,r){if("()"===t.type)return{};if(ad.isAbiType(t.type)){const t=e.next().value,n=e.next().value;return new ad(t,n).toBigInt()}if(ld.isAbiType(t.type)){const t=e.next().value,n=e.next().value,r=e.next().value,s=e.next().value;return new ld(t,n,r,s).toBigInt()}if(Td(t.type)){const t=[],n=BigInt(e.next().value);for(;t.length<n;)t.push(ul(e.next().value));return Zl({data:t,pending_word:ul(e.next().value),pending_word_len:BigInt(e.next().value)})}if(Xd.isTypeFixedArray(t.type)){const s=[],a={name:"",type:Xd.getFixedArrayType(t.type)},i=Xd.getFixedArraySize(t.type);for(;s.length<i;)s.push(nu(e,a,n,r));return s}if(hd(t.type)){const s=[],a={name:"",type:Bd(t.type)},i=BigInt(e.next().value);for(;s.length<i;)s.push(nu(e,a,n,r));return s}if(Nd(t.type)){const s={name:"",type:Bd(t.type)};return nu(e,s,n,r)}if(n&&t.type in n&&n[t.type])return kd(t.type)?tu(t.type,e):n[t.type].members.reduce((t,s)=>(t[s.name]=nu(e,s,n,r),t),{});if(r&&t.type in r&&r[t.type]){const s=Number(e.next().value),a=r[t.type].variants.reduce((t,a,i)=>i===s?(t[a.name]=nu(e,{name:"",type:a.type},n,r),t):(t[a.name]=void 0,t),{});if(t.type.startsWith("core::option::Option")){const e=s===Ud.Some?a.Some:void 0;return new Md(s,e)}if(t.type.startsWith("core::result::Result")){let e;return e=s===$d.Ok?a.Ok:a.Err,new Hd(s,e)}return new Fd(a)}if(fd(t.type))return Gd(t.type).reduce((t,s,a)=>{const i=s?.name?s.name:a,o={name:i,type:s?.type?s.type:s};return t[i]=nu(e,o,n,r),t},{});if(hd(t.type)){const s=[],a={name:"",type:Bd(t.type)},i=BigInt(e.next().value);for(;s.length<i;)s.push(nu(e,a,n,r));return s}return tu(t.type,e)}function ru(e,t,n,r,s){const{name:a,type:i}=t;let o;switch(!0){case dd(a):return o=e.next().value,BigInt(o);case n&&i in n||fd(i):case r&&md(i,r):case Xd.isTypeFixedArray(i):return nu(e,t,n,r);case hd(i):if(Cd(i))return nu(e,t,n,r);const c=[];if(s&&s[`${a}_len`]){const i=s[`${a}_len`];for(;c.length<i;)c.push(nu(e,{name:a,type:t.type.replace("*","")},n,r))}return c;case Nd(i):return nu(e,t,n,r);default:return tu(i,e)}}var su=(e,t)=>{if(Qc(il(e)||rl(e)||al(e),`Validate: arg ${t.name} should be a felt typed as (String, Number or BigInt)`),il(e)&&!cl(e))return;const n=BigInt(e.toString(10));Qc(n>=0n&&n<=2n**252n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^252-1]`)},au=(e,t)=>{let n;switch(rl(e)&&Qc(e<=Number.MAX_SAFE_INTEGER,"Validation: Parameter is too large to be typed as Number use (BigInt or String)"),Qc(il(e)||rl(e)||al(e)||ol(e)&&"low"in e&&"high"in e||ol(e)&&["limb0","limb1","limb2","limb3"].every(t=>t in e),`Validate: arg ${t.name} of cairo type ${t.type} should be type (String, Number or BigInt), but is ${typeof e} ${e}.`),t.type){case Mc.u256:n=new ad(e).toBigInt();break;case Mc.u512:n=new ld(e).toBigInt();break;default:n=ll(e)}switch(t.type){case Mc.u8:Qc(n>=0n&&n<=255n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0 - 255]`);break;case Mc.u16:Qc(n>=0n&&n<=65535n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 65535]`);break;case Mc.u32:Qc(n>=0n&&n<=4294967295n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 4294967295]`);break;case Mc.u64:Qc(n>=0n&&n<=2n**64n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^64-1]`);break;case Mc.u128:Qc(n>=0n&&n<=2n**128n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^128-1]`);break;case Mc.u256:Qc(n>=0n&&n<=2n**256n-1n,`Validate: arg ${t.name} is ${t.type} should be in range 0 - 2^256-1`);break;case Mc.u512:Qc(ld.is(n),`Validate: arg ${t.name} is ${t.type} should be in range 0 - 2^512-1`);break;case $c.ClassHash:case $c.ContractAddress:Qc(n>=0n&&n<=2n**252n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^252-1]`);break;case $c.Secp256k1Point:Qc(n>=0n&&n<=2n**512n-1n,`Validate: arg ${t.name} must be ${t.type} : a 512 bits number.`);break;case $c.U96:Qc(n>=0n&&n<=2n**96n-1n,`Validate: arg ${t.name} must be ${t.type} : a 96 bits number.`)}},iu=(e,t)=>{Qc(sl(e),`Validate: arg ${t.name} of cairo type ${t.type} should be type (Boolean)`)},ou=(e,t,n)=>{if(t.type!==Mc.u256&&t.type!==Mc.u512){if(kd(t.type)){Qc(!ol(e),`EthAddress type is waiting a BigNumberish. Got "${e}"`);const n=BigInt(e.toString(10));return void Qc(n>=0n&&n<=2n**160n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^160-1]`)}Qc(ol(e),`Validate: arg ${t.name} is cairo type struct (${t.type}), and should be defined as a js object (not array)`),n[t.type].members.forEach(({name:n})=>{Qc(Object.keys(e).includes(n),`Validate: arg ${t.name} should have a property ${n}`)})}else au(e,t)},cu=(e,t)=>{Qc(ol(e),`Validate: arg ${t.name} is cairo type Enum (${t.type}), and should be defined as a js object (not array)`);const n=Object.getOwnPropertyNames(Object.getPrototypeOf(e)),r=[...Object.getOwnPropertyNames(e),...n];if(!(yd(t.type)&&r.includes("isSome")&&r.includes("isNone")||_d(t.type)&&r.includes("isOk")&&r.includes("isErr")||r.includes("variant")&&r.includes("activeVariant")))throw new Error(`Validate Enum: argument ${t.name}, type ${t.type}, value received "${e}", is not an Enum.`)},lu=(e,t)=>{Qc(ol(e),`Validate: arg ${t.name} should be a tuple (defined as object)`)},du=(e,t,n,r)=>{const s=hd(t.type),a=s?Bd(t.type):Xd.getFixedArrayType(t.type);if(s&&ud(a)&&zl(e))return;let i=[];if(s)Qc(Array.isArray(e),`Validate: arg ${t.name} should be an Array`),i=e;else switch(!0){case Array.isArray(e):i=e;break;case"object"==typeof e:i=Object.values(e);break;default:throw new Error(`Validate: arg ${t.name} should be an Array or an object.`)}switch(!0){case ud(a):i.forEach(e=>su(e,t));break;case fd(a):i.forEach(e=>lu(e,{name:t.name,type:a}));break;case hd(a):i.forEach(e=>du(e,{name:"",type:a},n,r));break;case gd(a,n):i.forEach(e=>ou(e,{name:t.name,type:a},n));break;case md(a,r):i.forEach(e=>cu(e,{name:t.name,type:a}));break;case wd(a)||vd(a):i.forEach(e=>au(e,{name:"",type:a}));break;case Ed(a):i.forEach(e=>iu(e,t));break;default:throw new Error(`Validate Unhandled: argument ${t.name}, type ${t.type}, value ${i}`)}};function uu(e,t,n,r){e.inputs.reduce((e,s)=>{const a=t[e];switch(!0){case dd(s.name):return e;case ud(s.type):su(a,s);break;case Sd(s.type):((e,t)=>{Qc(il(e),`Validate: arg ${t.name} should be a string.`),Qc(e.length<32,`Validate: arg ${t.name} cairo typed ${t.type} should be a string of less than 32 characters.`)})(a,s);break;case wd(s.type)||vd(s.type):au(a,s);break;case Ed(s.type):iu(a,s);break;case Td(s.type):((e,t)=>{Qc(il(e),`Validate: arg ${t.name} should be a string.`)})(a,s);break;case hd(s.type)||Xd.isTypeFixedArray(s.type):du(a,s,n,r);break;case gd(s.type,n):ou(a,s,n);break;case md(s.type,r):cu(a,s);break;case fd(s.type):lu(a,s);break;case Nd(s.type):((e,t)=>{const n=Bd(t.type);switch(Qc(wd(n)&&n!==ld.abiSelector||ud(n),`Validate: ${t.name} type is not authorized for NonZero type.`),!0){case ud(n):su(e,t),Qc(BigInt(e.toString(10))>0,"Validate: value 0 is not authorized in NonZero felt252 type.");break;case wd(n):au(e,{name:"",type:n}),n===Mc.u256?Qc(new ad(e).toBigInt()>0,"Validate: value 0 is not authorized in NonZero uint256 type."):Qc(ll(e)>0,"Validate: value 0 is not authorized in NonZero uint type.");break;default:throw new Error(`Validate Unhandled: argument ${t.name}, type ${t.type}, value "${e}"`)}})(a,s);break;default:throw new Error(`Validate Unhandled: argument ${s.name}, type ${s.type}, value ${a}`)}return e+1},0)}var hu=class e{abi;parser;structs;enums;constructor(t){this.structs=e.getAbiStruct(t),this.enums=e.getAbiEnum(t),this.parser=Wd(t),this.abi=this.parser.getLegacyFormat()}validate(e,t,n=[]){e!==Uc.DEPLOY&&Qc(this.abi.filter(t=>{if("function"!==t.type)return!1;const n="view"===t.stateMutability||"view"===t.state_mutability;return e===Uc.INVOKE?!n:n}).map(e=>e.name).includes(t),(e===Uc.INVOKE?"invocable":"viewable")+" method not found in abi");const r=this.abi.find(n=>e===Uc.DEPLOY?n.name===t&&"constructor"===n.type:n.name===t&&"function"===n.type);if(Zd(t,n,r))return;const s=this.parser.methodInputsLength(r);if(n.length!==s)throw Error(`Invalid number of arguments, expected ${s} arguments, but got ${n.length}`);uu(r,n,this.structs,this.enums)}compile(e,t){const n=this.abi.find(t=>t.name===e);if(Zd(e,t,n))return[];let r;if(Array.isArray(t))r=t;else{const e=function(e,t,n,r){const s=(e,t)=>{if(Xd.isTypeFixedArray(t))return function(e,t){const n=Xd.getFixedArrayType(t),r=Xd.getFixedArraySize(t);if(Array.isArray(e)){if(r!==e.length)throw new Error(`ABI type ${t}: array provided do not includes  ${r} items. ${e.length} items provided.`);return e.map(e=>s(e,n))}if(r!==Object.keys(e).length)throw new Error(`ABI type ${t}: object provided do not includes  ${r} properties. ${Object.keys(e).length} items provided.`);return s(e,n)}(e,t);if(hd(t))return function(e,t){const n=Bd(t);return il(e)?e:e.map(e=>s(e,n))}(e,t);if(md(t,r)){const n=r[t];return i(e,n)}if(fd(t))return function(e,t){const n=Gd(t).reduce((t,n,r)=>{const a=Object.keys(e),i=n?.type?n.type:n;return o=s(e[a[r]],i),Object.defineProperty(t,r.toString(),{enumerable:!0,value:o??e[a[r]]}),t;var o},{});return n}(e,t);if(kd(t))return e;if(Nd(t))return e;if(Td(t))return e;if(xd(t))return e;if(Id(t))return e;if(ad.isAbiType(t)){const n=e;if("object"!=typeof n)return n;if(!("low"in n)||!("high"in n))throw Error(`Your object includes the property : ${t}, containing an Uint256 object without the 'low' and 'high' keys.`);return{low:n.low,high:n.high}}if(ld.isAbiType(t)){const n=e;if("object"!=typeof n)return n;if(!["limb0","limb1","limb2","limb3"].every(e=>e in n))throw Error(`Your object includes the property : ${t}, containing an Uint512 object without the 'limb0' to 'limb3' keys.`);return{limb0:n.limb0,limb1:n.limb1,limb2:n.limb2,limb3:n.limb3}}if(gd(t,n)){const r=n[t].members;return a(e,r)}return e},a=(e,t)=>t.reduce((t,n)=>{if("undefined"===e[n.name]&&(Cd(n.type)||!dd(n.name)))throw Error(`Your object needs a property with key : ${n.name} .`);var r;return r=s(e[n.name],n.type),Object.defineProperty(t,n.name,{enumerable:!0,value:r??e[n.name]}),t},{}),i=(e,t)=>{if(_d(t.name)){const n=e,r=t.name.substring(t.name.indexOf("<")+1,t.name.lastIndexOf(",")),a=t.name.substring(t.name.indexOf(",")+1,t.name.lastIndexOf(">"));return n.isOk()?new Hd($d.Ok,s(e.unwrap(),r)):new Hd($d.Err,s(e.unwrap(),a))}if(yd(t.name)){const n=e,r=t.name.substring(t.name.indexOf("<")+1,t.name.lastIndexOf(">"));return n.isSome()?new Md(Ud.Some,s(n.unwrap(),r)):new Md(Ud.None,{})}const n=e,r=Object.entries(n.variant).map(e=>{if(nl(e[1]))return e;const r=t.type.substring(t.type.lastIndexOf("<")+1,t.type.lastIndexOf(">"));return"()"===r?e:[e[0],s(n.unwrap(),r)]});return new Fd(Object.fromEntries(r))};return t.reduce((t,n)=>{return dd(n.name)&&!Cd(n.type)||(r=s(e[n.name],n.type),Object.defineProperty(t,n.name,{enumerable:!0,value:r})),t;var r},{})}(t,n.inputs,this.structs,this.enums);r=Object.values(e),uu(n,r,this.structs,this.enums)}const s=r[Symbol.iterator](),a=n.inputs.reduce((e,t)=>dd(t.name)&&!Cd(t.type)?e:e.concat(eu(s,t,this.structs,this.enums)),[]);return Object.defineProperty(a,"__compiled__",{enumerable:!1,writable:!1,value:!0}),a}static compile(e){const t=e=>{const t=(e,n=".")=>{const r=Array.isArray(e)?[e.length.toString(),...e]:e;return Object.entries(r).flatMap(([e,s])=>{let a=s;"entrypoint"===e?a=Nl(a):zl(a)&&(a=Yl(a));const i=Array.isArray(r)&&"0"===e?"$$len":e;if(al(a))return[[`${n}${i}`,Pd(a)]];if(Object(a)===a){const e=Object.getOwnPropertyNames(Object.getPrototypeOf(a)),r=[...Object.getOwnPropertyNames(a),...e];if(r.includes("isSome")&&r.includes("isNone")){const e=a,r=e.isSome()?Ud.Some:Ud.None;return e.isSome()?t({0:r,1:e.unwrap()},`${n}${i}.`):[[`${n}${i}`,Pd(r)]]}if(r.includes("isOk")&&r.includes("isErr")){const e=a,r=e.isOk()?$d.Ok:$d.Err;return t({0:r,1:e.unwrap()},`${n}${i}.`)}if(r.includes("variant")&&r.includes("activeVariant")){const e=a,r=e.activeVariant(),s=Object.keys(e.variant).findIndex(e=>e===r);return"object"==typeof e.unwrap()&&0===Object.keys(e.unwrap()).length?[[`${n}${i}`,Pd(s)]]:t({0:s,1:e.unwrap()},`${n}${i}.`)}return t(a,`${n}${i}.`)}return[[`${n}${i}`,Pd(a)]]})};return Object.fromEntries(t(e))};let n;if(Array.isArray(e)){const r=t({...e});n=Object.values(r)}else{const r=t(e);n=Object.values(r)}return Object.defineProperty(n,"__compiled__",{enumerable:!1,writable:!1,value:!0}),n}parse(e,t){const{outputs:n}=this.abi.find(t=>t.name===e),r=t.flat()[Symbol.iterator](),s=n.flat().reduce((e,t,n)=>{const s=t.name??n;return e[s]=ru(r,t,this.structs,this.enums,e),e[s]&&e[`${s}_len`]&&delete e[`${s}_len`],e},{});return 1===Object.keys(s).length&&0 in s?s[0]:s}format(e,t,n){return jd(this.parse(e,t),n)}static getAbiStruct(e){return e.filter(e=>"struct"===e.type).reduce((e,t)=>({...e,[t.name]:t}),{})}static getAbiEnum(e){const t=e.filter(e=>"enum"===e.type).reduce((e,t)=>({...e,[t.name]:t}),{});return delete t["core::bool"],t}static toCalldata(t=[]){return e.compile(t)}static toHex(t=[]){return e.compile(t).map(e=>ul(e))}decodeParameters(e,t){const n=Array.isArray(e)?e:[e],r=t.flat()[Symbol.iterator](),s=n.map(e=>ru(r,{name:"",type:e},this.structs,this.enums));return 1===s.length?s[0]:s}},fu={};ko(fu,{calculateContractAddressFromHash:()=>Zu,calculateDeclareTransactionHash:()=>$u,calculateDeployAccountTransactionHash:()=>Hu,calculateInvokeTransactionHash:()=>Mu,calculateL2MessageTxHash:()=>vu,computeCompiledClassHash:()=>th,computeContractClassHash:()=>sh,computeHashOnElements:()=>qu,computeHintedClassHash:()=>Xu,computeLegacyContractClassHash:()=>Ju,computePedersenHash:()=>zu,computePedersenHashOnElements:()=>Ku,computePoseidonHash:()=>ju,computePoseidonHashOnElements:()=>Wu,computeSierraContractClassHash:()=>rh,formatSpaces:()=>Gu,getL1MessageHash:()=>Vl,getL2MessageHash:()=>Rl,getSelector:()=>Dl,getSelectorFromName:()=>Nl,hashByteCodeSegments:()=>eh,keccakBn:()=>Bl,poseidon:()=>s,solidityUint256PackedKeccak256:()=>Ll,starknetKeccak:()=>Ol});var pu={};ko(pu,{calculateDeclareTransactionHash:()=>_u,calculateDeployAccountTransactionHash:()=>wu,calculateL2MessageTxHash:()=>vu,calculateTransactionHash:()=>bu,calculateTransactionHashCommon:()=>yu,computeHashOnElements:()=>mu});var gu={};function mu(e){return[...e,e.length].reduce((e,t)=>yr(ll(e),ll(t)),0).toString()}function yu(e,t,n,r,s,a,i,o=[]){const c=mu(s);return mu([e,t,n,r,c,a,i,...o])}function _u(e,t,n,r,s,a,i){return yu(fc.DECLARE,n,t,0,[e],r,s,[a,...i?[i]:[]])}function wu(e,t,n,r,s,a,i,o){const c=[t,r,...n];return yu(fc.DEPLOY_ACCOUNT,s,e,0,c,a,i,[o])}function bu(e,t,n,r,s,a){return yu(fc.INVOKE,t,e,0,n,r,s,[a])}function vu(e,t,n,r,s,a){const i=[e,...r];return yu(fc.L1_HANDLER,0,t,Dl(n),i,0,s,[a])}ko(gu,{starkCurve:()=>i,weierstrass:()=>a});var Eu={};ko(Eu,{calculateDeclareTransactionHash:()=>Fu,calculateDeployAccountTransactionHash:()=>Pu,calculateInvokeTransactionHash:()=>Uu,calculateTransactionHashCommon:()=>Vu,encodeDataResourceBoundsL1:()=>Du,encodeResourceBoundsL1:()=>Ou,encodeResourceBoundsL2:()=>Nu,hashDAMode:()=>Bu,hashFeeField:()=>Lu,hashFeeFieldV3B3:()=>Ru});var Au=e=>e.map(e=>BigInt(e)),ku=32n,Su=128n,Tu=64n+Su,xu=BigInt(ql("L1_GAS")),Iu=BigInt(ql("L2_GAS")),Cu=BigInt(ql("L1_DATA"));function Bu(e,t){return(BigInt(e)<<ku)+BigInt(t)}function Ou(e){return(xu<<Tu)+(BigInt(e.l1_gas.max_amount)<<Su)+BigInt(e.l1_gas.max_price_per_unit)}function Nu(e){return(Iu<<Tu)+(BigInt(e.l2_gas.max_amount)<<Su)+BigInt(e.l2_gas.max_price_per_unit)}function Du(e){return(Cu<<Tu)+(BigInt(e.l1_data_gas.max_amount)<<Su)+BigInt(e.l1_data_gas.max_price_per_unit)}function Lu(e,t){const n=Ou(t),r=Nu(t);return Nr([BigInt(e),n,r])}function Ru(e,t){const n=Ou(t),r=Nu(t),s=Du(t);return Nr([BigInt(e),n,r,s])}function Vu(e,t,n,r,s,a,i,o,c,l,d=[]){const u=Vc(l)?Ru(a,l):Lu(a,l),h=Bu(o,c),f=Au([e,t,n,u,Nr(Au(i)),r,s,h,...Au(d)]);return ul(Nr(f))}function Pu(e,t,n,r,s,a,i,o,c,l,d,u){return Vu(fc.DEPLOY_ACCOUNT,s,e,a,i,d,u,o,c,l,[Nr(Au(n)),t,r])}function Fu(e,t,n,r,s,a,i,o,c,l,d,u){return Vu(fc.DECLARE,r,n,s,a,d,Au(u),o,c,l,[Nr(Au(i)),e,t])}function Uu(e,t,n,r,s,a,i,o,c,l,d){return Vu(fc.INVOKE,t,e,r,s,l,d,i,o,c,[Nr(Au(a)),Nr(Au(n))])}function Mu(e){return function(e){return[xo.ETransactionVersion.V3,xo.ETransactionVersion.F3].includes(e.version)}(e)?Uu(e.senderAddress,e.version,e.compiledCalldata,e.chainId,e.nonce,e.accountDeploymentData,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData):bu(e.senderAddress,e.version,e.compiledCalldata,e.maxFee,e.chainId,e.nonce)}function $u(e){return function(e){return[xo.ETransactionVersion.V3,xo.ETransactionVersion.F3].includes(e.version)}(e)?Fu(e.classHash,e.compiledClassHash,e.senderAddress,e.version,e.chainId,e.nonce,e.accountDeploymentData,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData):_u(e.classHash,e.senderAddress,e.version,e.maxFee,e.chainId,e.nonce,e.compiledClassHash)}function Hu(e){return function(e){return[xo.ETransactionVersion.V3,xo.ETransactionVersion.F3].includes(e.version)}(e)?Pu(e.contractAddress,e.classHash,e.compiledConstructorCalldata,e.salt,e.version,e.chainId,e.nonce,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData):wu(e.contractAddress,e.classHash,e.constructorCalldata,e.salt,e.version,e.maxFee,e.chainId,e.nonce)}function zu(e,t){return yr(BigInt(e),BigInt(t))}function ju(e,t){return ul(Cr(BigInt(e),BigInt(t)))}function qu(e){return[...e,e.length].reduce((e,t)=>yr(BigInt(e),BigInt(t)),0).toString()}var Ku=qu;function Wu(e){return ul(Nr(e.map(e=>BigInt(e))))}function Zu(e,t,n,r){const s=qu(hu.compile(n)),a=qu([Pd("0x535441524b4e45545f434f4e54524143545f41444452455353"),r,e,t,s]);return ul(BigInt(a)%Qo)}function Yu(e,t){return"attributes"===e||"accessible_scopes"===e?Array.isArray(t)&&0===t.length?void 0:t:"debug_info"===e?null:null===t?void 0:t}function Gu(e){let t=!1;const n=[];for(const r of e)'"'===r&&0==(n.length>0&&"\\"===n.slice(-1)[0])&&(t=!t),t?n.push(r):n.push(":"===r?": ":","===r?", ":r);return n.join("")}function Xu(e){const{abi:t,program:n}=e,r=Gu(Xc({abi:t,program:n},Yu));return Fo(br(Do(r)).toString(16))}function Ju(e){const t=il(e)?Yc(e):e,n=ul(Go),r=qu(t.entry_points_by_type.EXTERNAL.flatMap(e=>[e.selector,e.offset])),s=qu(t.entry_points_by_type.L1_HANDLER.flatMap(e=>[e.selector,e.offset])),a=qu(t.entry_points_by_type.CONSTRUCTOR.flatMap(e=>[e.selector,e.offset])),i=qu(t.program.builtins.map(e=>ql(e))),o=Xu(t),c=qu(t.program.data);return qu([n,r,s,a,i,o,c])}function Qu(e){const t=e.flatMap(e=>{return[BigInt(e.selector),BigInt(e.offset),(t=e.builtins,Nr(t.flatMap(e=>BigInt(ql(e)))))];var t});return Nr(t)}function eh(e){const t=e.bytecode.map(e=>BigInt(e)),n=e.bytecode_segment_lengths??[];let r=0;const s=n.flatMap(e=>{const n=t.slice(r,r+=e);return[BigInt(e),Nr(n)]});return 1n+Nr(s)}function th(e){const t=BigInt(ql("COMPILED_CLASS_V1")),n=Qu(e.entry_points_by_type.EXTERNAL),r=Qu(e.entry_points_by_type.L1_HANDLER),s=Qu(e.entry_points_by_type.CONSTRUCTOR),a=e.bytecode_segment_lengths?eh(e):Nr(e.bytecode.map(e=>BigInt(e)));return ul(Nr([t,n,r,s,a]))}function nh(e){return Nr(e.flatMap(e=>[BigInt(e.selector),BigInt(e.function_idx)]))}function rh(e){const t=BigInt(ql("CONTRACT_CLASS_V0.1.0")),n=nh(e.entry_points_by_type.EXTERNAL),r=nh(e.entry_points_by_type.L1_HANDLER),s=nh(e.entry_points_by_type.CONSTRUCTOR),a=function(e){const t=Gu(Xc(e.abi,null));return BigInt(Fo(br(Do(t)).toString(16)))}(e),i=Nr(e.sierra_program.map(e=>BigInt(e)));return ul(Nr([t,n,r,s,a,i]))}function sh(e){const t=il(e)?Yc(e):e;return"sierra_program"in t?rh(t):Ju(t)}var ah={};function ih(e){const t=e.version?ul(e.version):Bc.V3;return t===Bc.V3||t===Bc.F3}function oh(e,t){const n=e.split("."),r=t.split(".");return n.every((e,t)=>"*"===e||e===r[t])}function ch(e,t={allowAnyPatchVersion:!1}){return Object.values(pc).some(n=>oh(t.allowAnyPatchVersion?lh(n):n,e))}function lh(e){const t=e.split(".");return t.length<3?e:`${t[0]}.${t[1]}.*`}function dh(e){const[t,n]=e.replace(/^v/,"").split(".");return`v${t}_${n}`}function uh(e){return"PENDING"===e.status}function hh(e){return!("block_hash"in e)}function fh(e){return!("block_hash"in e)}function ph(e){const t=il(e)?e:Xc(e);return Ro(Ji(t))}function gh(e){if(Array.isArray(e))return e;const t=No(Qi(Lo(e)));return Yc(t)}function mh(){return cr(sr.randomPrivateKey())}function yh(e){if(!e)throw Error("formatSignature: provided signature is undefined");if(Array.isArray(e))return e.map(e=>ul(e));try{const{r:t,s:n}=e;return[ul(t),ul(n)]}catch(e){throw new Error("Signature need to be weierstrass.SignatureType or an array for custom")}}function _h(e){return _l(yh(e))}function wh(e){return wl(yh(e))}function bh(e,t=wc.get("feeMarginPercentage").maxFee){return Tl(e,t)}function vh(e,t=wc.get("feeMarginPercentage").bounds,n){return al(e)?{l2_gas:{max_amount:"0x0",max_price_per_unit:"0x0"},l1_gas:{max_amount:"0x0",max_price_per_unit:"0x0"},...n&&oh("0.8",n)&&{l1_data_gas:{max_amount:"0x0",max_price_per_unit:"0x0"}}}:Rc(e)?function(e,t){return{l2_gas:{max_amount:ul(Tl(e.l2_gas_consumed,t.l2_gas.max_amount)),max_price_per_unit:ul(Tl(e.l2_gas_price,t.l2_gas.max_price_per_unit))},l1_gas:{max_amount:ul(Tl(e.l1_gas_consumed,t.l1_gas.max_amount)),max_price_per_unit:ul(Tl(e.l1_gas_price,t.l1_gas.max_price_per_unit))},l1_data_gas:{max_amount:ul(Tl(e.l1_data_gas_consumed,t.l1_data_gas.max_amount)),max_price_per_unit:ul(Tl(e.l1_data_gas_price,t.l1_data_gas.max_price_per_unit))}}}(e,t):function(e,t){return{l2_gas:{max_amount:"0x0",max_price_per_unit:"0x0"},l1_gas:{max_amount:void 0!==e.data_gas_consumed&&void 0!==e.data_gas_price?ul(Tl(BigInt(e.overall_fee)/BigInt(e.gas_price),t.l1_gas.max_amount)):ul(Tl(e.gas_consumed,t.l1_gas.max_amount)),max_price_per_unit:ul(Tl(e.gas_price,t.l1_gas.max_price_per_unit))}}}(e,t)}function Eh(e){return{l1_gas_consumed:0n,l1_gas_price:0n,l1_data_gas_consumed:0n,l1_data_gas_price:0n,l2_gas_consumed:0n,l2_gas_price:0n,overall_fee:Wo,unit:"FRI",suggestedMaxFee:Wo,resourceBounds:vh(Wo,void 0,e)}}function Ah(e){if(e===Dc.L1)return Lc.L1;if(e===Dc.L2)return Lc.L2;throw Error("EDAM conversion")}function kh(e,t){const n=t?ul(t):void 0,r=ul(e);if(t&&!Object.values(Bc).includes(n))throw Error(`providedVersion ${t} is not ETransactionVersion`);if(!Object.values(Bc).includes(r))throw Error(`defaultVersion ${e} is not ETransactionVersion`);return t?n:r}function Sh(e){if(!e)return;const t=ul(e);if(t===Bc.V0)return Bc.F0;if(t===Bc.V1)return Bc.F1;if(t===Bc.V2)return Bc.F2;if(t===Bc.V3)return Bc.F3;throw Error(`toFeeVersion: ${t} is not supported`)}function Th(e,t){return{tip:e.tip||0,paymasterData:e.paymasterData||[],accountDeploymentData:e.accountDeploymentData||[],nonceDataAvailabilityMode:e.nonceDataAvailabilityMode||Dc.L1,feeDataAvailabilityMode:e.feeDataAvailabilityMode||Dc.L1,resourceBounds:e.resourceBounds??vh(Wo,void 0,t)}}function xh(e){return e===Bc.F2?Bc.F1:e===Bc.V2?Bc.V1:e}function Ih(e){return Fo(Vo(Yn(ul(e),!1)))}function Ch(e){return"sierra_program"in(il(e)?Yc(e):e)}function Bh(e){const t={...e};if(Ch(e.contract)&&(!e.compiledClassHash&&e.casm&&(t.compiledClassHash=th(e.casm)),!t.compiledClassHash))throw new Error("Extract compiledClassHash failed, provide (CairoAssembly).casm file or compiledClassHash");if(t.classHash=e.classHash??sh(e.contract),!t.classHash)throw new Error("Extract classHash failed, provide (CompiledContract).json file or classHash");return t}function Oh(e){if(Ch(e))throw Error("ContractClassResponse need to be LegacyContractClass (cairo0 response class)");const t=e;return{...t,program:gh(t.program)}}ko(ah,{ZEROFee:()=>Eh,compressProgram:()=>ph,decompressProgram:()=>gh,estimateFeeToBounds:()=>vh,estimatedFeeToMaxFee:()=>bh,formatSignature:()=>yh,getFullPublicKey:()=>Ih,intDAM:()=>Ah,randomAddress:()=>mh,reduceV2:()=>xh,signatureToDecimalArray:()=>_h,signatureToHexArray:()=>wh,toFeeVersion:()=>Sh,toTransactionVersion:()=>kh,v3Details:()=>Th});var Nh={FAILED_TO_RECEIVE_TXN:1,NO_TRACE_AVAILABLE:10,CONTRACT_NOT_FOUND:20,ENTRYPOINT_NOT_FOUND:21,BLOCK_NOT_FOUND:24,INVALID_TXN_INDEX:27,CLASS_HASH_NOT_FOUND:28,TXN_HASH_NOT_FOUND:29,PAGE_SIZE_TOO_BIG:31,NO_BLOCKS:32,INVALID_CONTINUATION_TOKEN:33,TOO_MANY_KEYS_IN_FILTER:34,CONTRACT_ERROR:40,TRANSACTION_EXECUTION_ERROR:41,STORAGE_PROOF_NOT_SUPPORTED:42,CLASS_ALREADY_DECLARED:51,INVALID_TRANSACTION_NONCE:52,INSUFFICIENT_RESOURCES_FOR_VALIDATE:53,INSUFFICIENT_ACCOUNT_BALANCE:54,VALIDATION_FAILURE:55,COMPILATION_FAILED:56,CONTRACT_CLASS_SIZE_IS_TOO_LARGE:57,NON_ACCOUNT:58,DUPLICATE_TX:59,COMPILED_CLASS_HASH_MISMATCH:60,UNSUPPORTED_TX_VERSION:61,UNSUPPORTED_CONTRACT_CLASS_VERSION:62,UNEXPECTED_ERROR:63,INVALID_SUBSCRIPTION_ID:66,TOO_MANY_ADDRESSES_IN_FILTER:67,TOO_MANY_BLOCKS_BACK:68,COMPILATION_ERROR:100,INVALID_ADDRESS:150,TOKEN_NOT_SUPPORTED:151,INVALID_SIGNATURE:153,MAX_AMOUNT_TOO_LOW:154,CLASS_HASH_NOT_SUPPORTED:155,PAYMASTER_TRANSACTION_EXECUTION_ERROR:156,INVALID_TIME_BOUNDS:157,INVALID_DEPLOYMENT_DATA:158,INVALID_CLASS_HASH:159,INVALID_ID:160,UNKNOWN_ERROR:163},Dh=class extends Error{name;constructor(e){super(e),Object.defineProperty(this,"name",{value:new.target.name,enumerable:!1,configurable:!0}),function(e,t){const{setPrototypeOf:n}=Object;n?n(e,t):e.__proto__=t}(this,new.target.prototype),function(e,t=e.constructor){const{captureStackTrace:n}=Error;n&&n(e,t)}(this)}},Lh=class extends Dh{},Rh=class extends Lh{constructor(e,t,n){super(`RPC: ${t} with params ${Xc(n,null,2)}\n\n      ${e.code}: ${e.message}: ${Xc(e.data)}`),this.baseError=e,this.request={method:t,params:n}}request;get code(){return this.baseError.code}isType(e){return Nh[e]===this.code}},Vh=class extends Lh{constructor(e){super(e),this.name="TimeoutError"}},Ph=class extends Lh{constructor(e){super(e),this.name="WebSocketNotConnectedError"}},Fh={};function Uh(){return Ho(Vo(io.utils.randomPrivateKey()))}function Mh(e){yl(e,Wo,2n**160n-1n,"Ethereum Address ");const t=Fo(Po(ul(e)).padStart(40,"0"));return Qc(Boolean(t.match(/^(0x)?[0-9a-f]{40}$/)),"Invalid Ethereum Address Format"),t}ko(Fh,{ethRandomPrivateKey:()=>Uh,validateAndParseEthAddress:()=>Mh});var $h="undefined"!=typeof globalThis&&globalThis.fetch.bind(globalThis)||"undefined"!=typeof window&&window.fetch.bind(window)||"undefined"!=typeof global&&global.fetch.bind(global)||(()=>{throw new Lh("'fetch()' not detected, use the 'baseFetch' constructor parameter to set it")}),Hh={};function zh(e){return new Promise(t=>{setTimeout(t,e)})}function jh(e){const t={...e};return delete t.sierra_program_debug_info,t.abi=Gu(Xc(e.abi)),t.sierra_program=Gu(Xc(e.sierra_program)),t.sierra_program=ph(t.sierra_program),t}function qh(e){const t=il(e)?Yc(e):e;return Ch(e)?jh(t):{...t,..."program"in t&&{program:ph(t.program)}}}ko(Hh,{Block:()=>Gh,createSierraContractClass:()=>jh,getDefaultNodeUrl:()=>Kh,getDefaultNodes:()=>Wh,getSupportedRpcVersions:()=>Zh,parseContract:()=>qh,validBlockTags:()=>Yh,wait:()=>zh});var Kh=(e,t=!1,n)=>{t||vc.info("Using default public node url, please provide nodeUrl in provider options!");const r=Wh(n??wc.get("rpcVersion"))[e??uc.SN_SEPOLIA];return r[Math.floor(Math.random()*r.length)]};function Wh(e){const t={...mc};return Object.keys(t).forEach(function(n,r){t[n]=t[n].map(t=>`${t}${dh(e)}`)}),t}function Zh(){return[...new Set(Object.values(pc))]}var Yh=Object.values(Cc),Gh=class{hash=null;number=null;tag=null;setIdentifier(e){if(il(e))if(Ml(e))this.number=parseInt(e,10);else if(cl(e))this.hash=e;else{if(!Yh.includes(e))throw TypeError(`Block identifier unmanaged: ${e}`);this.tag=e}else al(e)?this.hash=ul(e):rl(e)?this.number=e:this.tag=Cc.PENDING;if(rl(this.number)&&this.number<0)throw TypeError(`Block number (${this.number}) can't be negative`)}constructor(e){this.setIdentifier(e)}get queryIdentifier(){return null!==this.number?`blockNumber=${this.number}`:null!==this.hash?`blockHash=${this.hash}`:`blockNumber=${this.tag}`}get identifier(){return null!==this.number?{block_number:this.number}:null!==this.hash?{block_hash:this.hash}:this.tag}set identifier(e){this.setIdentifier(e)}valueOf=()=>this.number;toString=()=>this.hash},Xh={};ko(Xh,{buildUDCCall:()=>nf,fromCallsToExecuteCalldata:()=>Qh,fromCallsToExecuteCalldata_cairo1:()=>ef,getExecuteCalldata:()=>tf,getVersionsByType:()=>rf,transformCallsToMulticallArrays:()=>Jh});var Jh=e=>{const t=[],n=[];return e.forEach(e=>{const r=hu.compile(e.calldata||[]);t.push({to:ll(e.contractAddress).toString(10),selector:ll(Nl(e.entrypoint)).toString(10),data_offset:n.length.toString(),data_len:r.length.toString()}),n.push(...r)}),{callArray:t,calldata:hu.compile({calldata:n})}},Qh=e=>{const{callArray:t,calldata:n}=Jh(e);return[...hu.compile({callArray:t}),...n]},ef=e=>{const t=e.map(e=>({contractAddress:e.contractAddress,entrypoint:e.entrypoint,calldata:Array.isArray(e.calldata)&&"__compiled__"in e.calldata?e.calldata:hu.compile(e.calldata)}));return hu.compile({orderCalls:t})},tf=(e,t="0")=>"1"===t?ef(e):Qh(e);function nf(e,t){const n=[].concat(e).map(e=>{const{classHash:n,salt:r,unique:s=!0,constructorCalldata:a=[]}=e,i=hu.compile(a),o=r??mh();return{call:{contractAddress:sc.ADDRESS,entrypoint:sc.ENTRYPOINT,calldata:[n,o,kl(s),i.length,...i]},address:Zu(s?yr(t,o):o,n,i,s?sc.ADDRESS:0)}});return{calls:n.map(e=>e.call),addresses:n.map(e=>e.address)}}function rf(e){return"fee"===e?{v1:Bc.F1,v2:Bc.F2,v3:Bc.F3}:{v1:Bc.V1,v2:Bc.V2,v3:Bc.V3}}var sf={headers:{"Content-Type":"application/json"},blockIdentifier:Cc.PENDING,retries:200},af=class{id="RPC071";channelSpecVersion=pc.v0_7_1;nodeUrl;headers;requestId;blockIdentifier;retries;waitMode;chainId;specVersion;transactionRetryIntervalFallback;batchClient;baseFetch;constructor(e){const{baseFetch:t,batch:n,blockIdentifier:r,chainId:s,headers:a,nodeUrl:i,retries:o,specVersion:c,transactionRetryIntervalFallback:l,waitMode:d}=e||{};Object.values(uc).includes(i)?this.nodeUrl=Kh(i,e?.default,this.channelSpecVersion):this.nodeUrl=i||Kh(void 0,e?.default,this.channelSpecVersion),this.baseFetch=t||wc.get("fetch")||$h,this.blockIdentifier=r??sf.blockIdentifier,this.chainId=s,this.headers={...sf.headers,...a},this.retries=o??sf.retries,this.specVersion=c,this.transactionRetryIntervalFallback=l,this.waitMode=d??!1,this.requestId=0,"number"==typeof n&&(this.batchClient=new Jc({nodeUrl:this.nodeUrl,headers:this.headers,interval:n,baseFetch:this.baseFetch})),vc.debug("Using Channel",this.id)}readSpecVersion(){return this.specVersion}get transactionRetryIntervalDefault(){return this.transactionRetryIntervalFallback??5e3}setChainId(e){this.chainId=e}fetch(e,t,n=0){const r={id:n,jsonrpc:"2.0",method:e,...t&&{params:t}};return this.baseFetch(this.nodeUrl,{method:"POST",body:Xc(r),headers:this.headers})}errorHandler(e,t,n,r){if(n)throw new Rh(n,e,t);if(r instanceof Lh)throw r;if(r)throw Error(r.message)}async fetchEndpoint(e,t){try{if(this.batchClient){const{error:n,result:r}=await this.batchClient.fetch(e,t,this.requestId+=1);return this.errorHandler(e,t,n),r}const n=await this.fetch(e,t,this.requestId+=1),{error:r,result:s}=await n.json();return this.errorHandler(e,t,r),s}catch(n){throw this.errorHandler(e,t,n?.response?.data,n),n}}async getChainId(){return this.chainId??=await this.fetchEndpoint("starknet_chainId"),this.chainId}getSpecVersion(){return this.fetchEndpoint("starknet_specVersion")}async setUpSpecVersion(){if(!this.specVersion){const e=await this.fetchEndpoint("starknet_specVersion");if(oh(this.channelSpecVersion,e)||vc.error(_c.channelVersionMismatch,{channelId:this.id,channelSpecVersion:this.channelSpecVersion,nodeSpecVersion:this.specVersion}),!ch(e))throw new Lh(`${_c.unsupportedSpecVersion}, channelId: ${this.id}`);this.specVersion=e}return this.specVersion}getNonceForAddress(e,t=this.blockIdentifier){const n=ul(e),r=new Gh(t).identifier;return this.fetchEndpoint("starknet_getNonce",{contract_address:n,block_id:r})}getBlockLatestAccepted(){return this.fetchEndpoint("starknet_blockHashAndNumber")}getBlockNumber(){return this.fetchEndpoint("starknet_blockNumber")}getBlockWithTxHashes(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxHashes",{block_id:t})}getBlockWithTxs(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxs",{block_id:t})}getBlockWithReceipts(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_getBlockWithReceipts",{block_id:t})}getBlockStateUpdate(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_getStateUpdate",{block_id:t})}getBlockTransactionsTraces(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_traceBlockTransactions",{block_id:t})}getBlockTransactionCount(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_getBlockTransactionCount",{block_id:t})}getTransactionByHash(e){const t=ul(e);return this.fetchEndpoint("starknet_getTransactionByHash",{transaction_hash:t})}getTransactionByBlockIdAndIndex(e,t){const n=new Gh(e).identifier;return this.fetchEndpoint("starknet_getTransactionByBlockIdAndIndex",{block_id:n,index:t})}getTransactionReceipt(e){const t=ul(e);return this.fetchEndpoint("starknet_getTransactionReceipt",{transaction_hash:t})}getTransactionTrace(e){const t=ul(e);return this.fetchEndpoint("starknet_traceTransaction",{transaction_hash:t})}getTransactionStatus(e){const t=ul(e);return this.fetchEndpoint("starknet_getTransactionStatus",{transaction_hash:t})}simulateTransaction(e,t={}){const{blockIdentifier:n=this.blockIdentifier,skipValidate:r=!0,skipFeeCharge:s=!0}=t,a=new Gh(n).identifier,i=[];return r&&i.push(c.vn.SKIP_VALIDATE),s&&i.push(c.vn.SKIP_FEE_CHARGE),this.fetchEndpoint("starknet_simulateTransactions",{block_id:a,transactions:e.map(e=>this.buildTransaction(e)),simulation_flags:i})}async waitForTransaction(e,t){const n=ul(e);let{retries:r}=this,s=!1,a=!1;const i=t?.retryInterval??this.transactionRetryIntervalDefault,o=t?.errorStates??[c.sI.REJECTED],l=t?.successStates??[c.If.SUCCEEDED,c.sI.ACCEPTED_ON_L2,c.sI.ACCEPTED_ON_L1];let d;for(;!s;){await zh(i);try{d=await this.getTransactionStatus(n);const e=d.execution_status,t=d.finality_status;if(!t)throw new Error("waiting for transaction status");if(o.includes(e)||o.includes(t)){const n=`${e}: ${t}`,r=new Error(n);throw r.response=d,a=!0,r}(l.includes(e)||l.includes(t))&&(s=!0)}catch(e){if(e instanceof Error&&a)throw e;if(r<=0)throw new Error(`waitForTransaction timed-out with retries ${this.retries}`)}r-=1}let u=null;for(;null===u;){try{u=await this.getTransactionReceipt(n)}catch(e){if(r<=0)throw new Error(`waitForTransaction timed-out with retries ${this.retries}`)}r-=1,await zh(i)}return u}getStorageAt(e,t,n=this.blockIdentifier){const r=ul(e),s=fl(t),a=new Gh(n).identifier;return this.fetchEndpoint("starknet_getStorageAt",{contract_address:r,key:s,block_id:a})}getClassHashAt(e,t=this.blockIdentifier){const n=ul(e),r=new Gh(t).identifier;return this.fetchEndpoint("starknet_getClassHashAt",{block_id:r,contract_address:n})}getClass(e,t=this.blockIdentifier){const n=ul(e),r=new Gh(t).identifier;return this.fetchEndpoint("starknet_getClass",{class_hash:n,block_id:r})}getClassAt(e,t=this.blockIdentifier){const n=ul(e),r=new Gh(t).identifier;return this.fetchEndpoint("starknet_getClassAt",{block_id:r,contract_address:n})}async getEstimateFee(e,{blockIdentifier:t=this.blockIdentifier,skipValidate:n=!0}){const r=new Gh(t).identifier,s={simulation_flags:n?[c.vn.SKIP_VALIDATE]:[]};return this.fetchEndpoint("starknet_estimateFee",{request:e.map(e=>this.buildTransaction(e,"fee")),block_id:r,...s})}async invoke(e,t){let n;return ih(t)?(n=this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:{type:c.wV.INVOKE,sender_address:e.contractAddress,calldata:hu.toHex(e.calldata),version:c.WY.V3,signature:wh(e.signature),nonce:ul(t.nonce),resource_bounds:t.resourceBounds,tip:ul(t.tip),paymaster_data:t.paymasterData.map(e=>ul(e)),account_deployment_data:t.accountDeploymentData.map(e=>ul(e)),nonce_data_availability_mode:t.nonceDataAvailabilityMode,fee_data_availability_mode:t.feeDataAvailabilityMode}}),el(!t.maxFee,()=>{vc.warn(_c.maxFeeInV3,{type:c.wV.INVOKE})})):(n=this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:{sender_address:e.contractAddress,calldata:hu.toHex(e.calldata),type:c.wV.INVOKE,max_fee:ul(t.maxFee||0),version:c.WY.V1,signature:wh(e.signature),nonce:ul(t.nonce)}}),vc.warn(_c.legacyTxWarningMessage,{version:c.WY.V1,type:c.wV.INVOKE})),this.waitMode?this.waitForTransaction((await n).transaction_hash):n}async declare({contract:e,signature:t,senderAddress:n,compiledClassHash:r},s){let a;if(Ch(e)||ih(s))if(Ch(e)&&!ih(s))a=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:c.wV.DECLARE,contract_class:{sierra_program:gh(e.sierra_program),contract_class_version:e.contract_class_version,entry_points_by_type:e.entry_points_by_type,abi:e.abi},compiled_class_hash:r||"",version:c.WY.V2,max_fee:ul(s.maxFee||0),signature:wh(t),sender_address:n,nonce:ul(s.nonce)}}),vc.warn(_c.legacyTxWarningMessage,{version:c.WY.V2,type:c.wV.DECLARE});else{if(!Ch(e)||!ih(s))throw Error("declare unspotted parameters");a=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:c.wV.DECLARE,sender_address:n,compiled_class_hash:r||"",version:c.WY.V3,signature:wh(t),nonce:ul(s.nonce),contract_class:{sierra_program:gh(e.sierra_program),contract_class_version:e.contract_class_version,entry_points_by_type:e.entry_points_by_type,abi:e.abi},resource_bounds:s.resourceBounds,tip:ul(s.tip),paymaster_data:s.paymasterData.map(e=>ul(e)),account_deployment_data:s.accountDeploymentData.map(e=>ul(e)),nonce_data_availability_mode:s.nonceDataAvailabilityMode,fee_data_availability_mode:s.feeDataAvailabilityMode}}),el(!s.maxFee,()=>{vc.warn(_c.maxFeeInV3,{type:c.wV.DECLARE})})}else a=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:c.wV.DECLARE,contract_class:{program:e.program,entry_points_by_type:e.entry_points_by_type,abi:e.abi},version:c.WY.V1,max_fee:ul(s.maxFee||0),signature:wh(t),sender_address:n,nonce:ul(s.nonce)}}),vc.warn(_c.legacyTxWarningMessage,{version:c.WY.V1,type:c.wV.DECLARE});return this.waitMode?this.waitForTransaction((await a).transaction_hash):a}async deployAccount({classHash:e,constructorCalldata:t,addressSalt:n,signature:r},s){let a;return ih(s)?(a=this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:{type:c.wV.DEPLOY_ACCOUNT,version:c.WY.V3,signature:wh(r),nonce:ul(s.nonce),contract_address_salt:ul(n||0),constructor_calldata:hu.toHex(t||[]),class_hash:ul(e),resource_bounds:s.resourceBounds,tip:ul(s.tip),paymaster_data:s.paymasterData.map(e=>ul(e)),nonce_data_availability_mode:s.nonceDataAvailabilityMode,fee_data_availability_mode:s.feeDataAvailabilityMode}}),el(!s.maxFee,()=>{vc.warn(_c.maxFeeInV3,{type:c.wV.DEPLOY_ACCOUNT})})):(a=this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:{constructor_calldata:hu.toHex(t||[]),class_hash:ul(e),contract_address_salt:ul(n||0),type:c.wV.DEPLOY_ACCOUNT,max_fee:ul(s.maxFee||0),version:c.WY.V1,signature:wh(r),nonce:ul(s.nonce)}}),vc.warn(_c.legacyTxWarningMessage,{version:c.WY.V1,type:c.wV.DEPLOY_ACCOUNT})),this.waitMode?this.waitForTransaction((await a).transaction_hash):a}callContract(e,t=this.blockIdentifier){const n=new Gh(t).identifier;return this.fetchEndpoint("starknet_call",{request:{contract_address:e.contractAddress,entry_point_selector:Nl(e.entrypoint),calldata:hu.toHex(e.calldata)},block_id:n})}estimateMessageFee(e,t=this.blockIdentifier){const{from_address:n,to_address:r,entry_point_selector:s,payload:a}=e,i={from_address:Mh(n),to_address:ul(r),entry_point_selector:Dl(s),payload:Al(a)},o=new Gh(t).identifier;return this.fetchEndpoint("starknet_estimateMessageFee",{message:i,block_id:o})}getSyncingStats(){return this.fetchEndpoint("starknet_syncing")}getEvents(e){return this.fetchEndpoint("starknet_getEvents",{filter:e})}buildTransaction(e,t){const n=rf(t);let r;if(ih(e)?(r={signature:wh(e.signature),nonce:ul(e.nonce),resource_bounds:e.resourceBounds,tip:ul(e.tip),paymaster_data:e.paymasterData.map(e=>ul(e)),nonce_data_availability_mode:e.nonceDataAvailabilityMode,fee_data_availability_mode:e.feeDataAvailabilityMode,account_deployment_data:e.accountDeploymentData.map(e=>ul(e))},el(!e.maxFee,()=>{vc.warn(_c.maxFeeInV3,{type:e.type,versionType:t})})):(r={signature:wh(e.signature),nonce:ul(e.nonce),max_fee:ul(e.maxFee||0)},vc.warn(_c.legacyTxWarningMessage,{version:e.version,type:e.type})),e.type===Sc.INVOKE)return{type:c.wV.INVOKE,sender_address:e.contractAddress,calldata:hu.toHex(e.calldata),version:ul(e.version||n.v3),...r};if(e.type===Sc.DECLARE)return Ch(e.contract)?{type:e.type,contract_class:{...e.contract,sierra_program:gh(e.contract.sierra_program)},compiled_class_hash:e.compiledClassHash||"",sender_address:e.senderAddress,version:ul(e.version||n.v3),...r}:{type:e.type,contract_class:e.contract,sender_address:e.senderAddress,version:ul(e.version||n.v1),...r};if(e.type===Sc.DEPLOY_ACCOUNT){const{account_deployment_data:t,...s}=r;return{type:e.type,constructor_calldata:hu.toHex(e.constructorCalldata||[]),class_hash:ul(e.classHash),contract_address_salt:ul(e.addressSalt||0),version:ul(e.version||n.v3),...s}}throw Error("RPC buildTransaction received unknown TransactionType")}},of={};ko(of,{RpcChannel:()=>lf});var cf={headers:{"Content-Type":"application/json"},blockIdentifier:Cc.PENDING,retries:200},lf=class{id="RPC081";channelSpecVersion=pc.v0_8_1;nodeUrl;headers;requestId;blockIdentifier;retries;waitMode;chainId;specVersion;transactionRetryIntervalFallback;batchClient;baseFetch;constructor(e){const{baseFetch:t,batch:n,blockIdentifier:r,chainId:s,headers:a,nodeUrl:i,retries:o,specVersion:c,transactionRetryIntervalFallback:l,waitMode:d}=e||{};Object.values(uc).includes(i)?this.nodeUrl=Kh(i,e?.default,this.channelSpecVersion):this.nodeUrl=i||Kh(void 0,e?.default,this.channelSpecVersion),this.baseFetch=t||wc.get("fetch")||$h,this.blockIdentifier=r??cf.blockIdentifier,this.chainId=s,this.headers={...cf.headers,...a},this.retries=o??cf.retries,this.specVersion=c,this.transactionRetryIntervalFallback=l,this.waitMode=d??!1,this.requestId=0,"number"==typeof n&&(this.batchClient=new Jc({nodeUrl:this.nodeUrl,headers:this.headers,interval:n,baseFetch:this.baseFetch})),vc.debug("Using Channel",this.id)}readSpecVersion(){return this.specVersion}get transactionRetryIntervalDefault(){return this.transactionRetryIntervalFallback??5e3}setChainId(e){this.chainId=e}fetch(e,t,n=0){const r={id:n,jsonrpc:"2.0",method:e,...t&&{params:t}};return this.baseFetch(this.nodeUrl,{method:"POST",body:Xc(r),headers:this.headers})}errorHandler(e,t,n,r){if(n)throw new Rh(n,e,t);if(r instanceof Lh)throw r;if(r)throw Error(r.message)}async fetchEndpoint(e,t){try{if(this.batchClient){const{error:n,result:r}=await this.batchClient.fetch(e,t,this.requestId+=1);return this.errorHandler(e,t,n),r}const n=await this.fetch(e,t,this.requestId+=1),{error:r,result:s}=await n.json();return this.errorHandler(e,t,r),s}catch(n){throw this.errorHandler(e,t,n?.response?.data,n),n}}async getChainId(){return this.chainId??=await this.fetchEndpoint("starknet_chainId"),this.chainId}getSpecVersion(){return this.fetchEndpoint("starknet_specVersion")}async setUpSpecVersion(){if(!this.specVersion){const e=await this.fetchEndpoint("starknet_specVersion");if(oh(this.channelSpecVersion,e)||vc.error(_c.channelVersionMismatch,{channelId:this.id,channelSpecVersion:this.channelSpecVersion,nodeSpecVersion:this.specVersion}),!ch(e))throw new Lh(`${_c.unsupportedSpecVersion}, channelId: ${this.id}`);this.specVersion=e}return this.specVersion}getMessagesStatus(e){const t=ul(e);return this.fetchEndpoint("starknet_getMessagesStatus",{transaction_hash:t})}getStorageProof(e=[],t=[],n=[],r=this.blockIdentifier){const s=new Gh(r).identifier,a=wl(e),i=wl(t);return this.fetchEndpoint("starknet_getStorageProof",{block_id:s,class_hashes:a,contract_addresses:i,contracts_storage_keys:n})}getCompiledCasm(e){const t=ul(e);return this.fetchEndpoint("starknet_getCompiledCasm",{class_hash:t})}getNonceForAddress(e,t=this.blockIdentifier){const n=ul(e),r=new Gh(t).identifier;return this.fetchEndpoint("starknet_getNonce",{contract_address:n,block_id:r})}getBlockLatestAccepted(){return this.fetchEndpoint("starknet_blockHashAndNumber")}getBlockNumber(){return this.fetchEndpoint("starknet_blockNumber")}getBlockWithTxHashes(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxHashes",{block_id:t})}getBlockWithTxs(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxs",{block_id:t})}getBlockWithReceipts(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_getBlockWithReceipts",{block_id:t})}getBlockStateUpdate(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_getStateUpdate",{block_id:t})}getBlockTransactionsTraces(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_traceBlockTransactions",{block_id:t})}getBlockTransactionCount(e=this.blockIdentifier){const t=new Gh(e).identifier;return this.fetchEndpoint("starknet_getBlockTransactionCount",{block_id:t})}getTransactionByHash(e){const t=ul(e);return this.fetchEndpoint("starknet_getTransactionByHash",{transaction_hash:t})}getTransactionByBlockIdAndIndex(e,t){const n=new Gh(e).identifier;return this.fetchEndpoint("starknet_getTransactionByBlockIdAndIndex",{block_id:n,index:t})}getTransactionReceipt(e){const t=ul(e);return this.fetchEndpoint("starknet_getTransactionReceipt",{transaction_hash:t})}getTransactionTrace(e){const t=ul(e);return this.fetchEndpoint("starknet_traceTransaction",{transaction_hash:t})}getTransactionStatus(e){const t=ul(e);return this.fetchEndpoint("starknet_getTransactionStatus",{transaction_hash:t})}simulateTransaction(e,t={}){const{blockIdentifier:n=this.blockIdentifier,skipValidate:r=!0,skipFeeCharge:s=!0}=t,a=new Gh(n).identifier,i=[];return r&&i.push(d.vn.SKIP_VALIDATE),s&&i.push(d.vn.SKIP_FEE_CHARGE),this.fetchEndpoint("starknet_simulateTransactions",{block_id:a,transactions:e.map(e=>this.buildTransaction(e)),simulation_flags:i})}async waitForTransaction(e,t){const n=ul(e);let{retries:r}=this,s=!1,a=!1;const i=t?.retryInterval??this.transactionRetryIntervalDefault,o=t?.errorStates??[d.sI.REJECTED],c=t?.successStates??[d.If.SUCCEEDED,d.sI.ACCEPTED_ON_L2,d.sI.ACCEPTED_ON_L1];let l;for(;!s;){await zh(i);try{l=await this.getTransactionStatus(n);const e=l.execution_status,t=l.finality_status;if(!t)throw new Error("waiting for transaction status");if(o.includes(e)||o.includes(t)){const n=`${e}: ${t}`,r=new Error(n);throw r.response=l,a=!0,r}(c.includes(e)||c.includes(t))&&(s=!0)}catch(e){if(e instanceof Error&&a)throw e;if(r<=0)throw new Error(`waitForTransaction timed-out with retries ${this.retries}`)}r-=1}let u=null;for(;null===u;){try{u=await this.getTransactionReceipt(n)}catch(e){if(r<=0)throw new Error(`waitForTransaction timed-out with retries ${this.retries}`)}r-=1,await zh(i)}return u}getStorageAt(e,t,n=this.blockIdentifier){const r=ul(e),s=fl(t),a=new Gh(n).identifier;return this.fetchEndpoint("starknet_getStorageAt",{contract_address:r,key:s,block_id:a})}getClassHashAt(e,t=this.blockIdentifier){const n=ul(e),r=new Gh(t).identifier;return this.fetchEndpoint("starknet_getClassHashAt",{block_id:r,contract_address:n})}getClass(e,t=this.blockIdentifier){const n=ul(e),r=new Gh(t).identifier;return this.fetchEndpoint("starknet_getClass",{class_hash:n,block_id:r})}getClassAt(e,t=this.blockIdentifier){const n=ul(e),r=new Gh(t).identifier;return this.fetchEndpoint("starknet_getClassAt",{block_id:r,contract_address:n})}async getEstimateFee(e,{blockIdentifier:t=this.blockIdentifier,skipValidate:n=!0}){const r=new Gh(t).identifier,s={simulation_flags:n?[d.vn.SKIP_VALIDATE]:[]};return this.fetchEndpoint("starknet_estimateFee",{request:e.map(e=>this.buildTransaction(e,"fee")),block_id:r,...s})}async invoke(e,t){let n;if(!ih(t))throw Error(_c.legacyTxRPC08Message);if(!Vc(t.resourceBounds))throw Error(_c.SWOldV3);return n=this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:{type:d.wV.INVOKE,sender_address:e.contractAddress,calldata:hu.toHex(e.calldata),version:d.WY.V3,signature:wh(e.signature),nonce:ul(t.nonce),resource_bounds:t.resourceBounds,tip:ul(t.tip),paymaster_data:t.paymasterData.map(e=>ul(e)),account_deployment_data:t.accountDeploymentData.map(e=>ul(e)),nonce_data_availability_mode:t.nonceDataAvailabilityMode,fee_data_availability_mode:t.feeDataAvailabilityMode}}),this.waitMode?this.waitForTransaction((await n).transaction_hash):n}async declare({contract:e,signature:t,senderAddress:n,compiledClassHash:r},s){let a;if(!Ch(e)||!ih(s))throw Error(_c.legacyTxRPC08Message);if(!Vc(s.resourceBounds))throw Error(_c.SWOldV3);return a=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:d.wV.DECLARE,sender_address:n,compiled_class_hash:r||"",version:d.WY.V3,signature:wh(t),nonce:ul(s.nonce),contract_class:{sierra_program:gh(e.sierra_program),contract_class_version:e.contract_class_version,entry_points_by_type:e.entry_points_by_type,abi:e.abi},resource_bounds:s.resourceBounds,tip:ul(s.tip),paymaster_data:s.paymasterData.map(e=>ul(e)),account_deployment_data:s.accountDeploymentData.map(e=>ul(e)),nonce_data_availability_mode:s.nonceDataAvailabilityMode,fee_data_availability_mode:s.feeDataAvailabilityMode}}),this.waitMode?this.waitForTransaction((await a).transaction_hash):a}async deployAccount({classHash:e,constructorCalldata:t,addressSalt:n,signature:r},s){let a;if(!ih(s))throw Error(_c.legacyTxRPC08Message);if(!Vc(s.resourceBounds))throw Error(_c.SWOldV3);return a=this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:{type:d.wV.DEPLOY_ACCOUNT,version:d.WY.V3,signature:wh(r),nonce:ul(s.nonce),contract_address_salt:ul(n||0),constructor_calldata:hu.toHex(t||[]),class_hash:ul(e),resource_bounds:s.resourceBounds,tip:ul(s.tip),paymaster_data:s.paymasterData.map(e=>ul(e)),nonce_data_availability_mode:s.nonceDataAvailabilityMode,fee_data_availability_mode:s.feeDataAvailabilityMode}}),this.waitMode?this.waitForTransaction((await a).transaction_hash):a}callContract(e,t=this.blockIdentifier){const n=new Gh(t).identifier;return this.fetchEndpoint("starknet_call",{request:{contract_address:e.contractAddress,entry_point_selector:Nl(e.entrypoint),calldata:hu.toHex(e.calldata)},block_id:n})}estimateMessageFee(e,t=this.blockIdentifier){const{from_address:n,to_address:r,entry_point_selector:s,payload:a}=e,i={from_address:Mh(n),to_address:ul(r),entry_point_selector:Dl(s),payload:Al(a)},o=new Gh(t).identifier;return this.fetchEndpoint("starknet_estimateMessageFee",{message:i,block_id:o})}getSyncingStats(){return this.fetchEndpoint("starknet_syncing")}getEvents(e){return this.fetchEndpoint("starknet_getEvents",{filter:e})}buildTransaction(e,t){const n=rf(t);let r;if(!ih(e))throw Error("v0,v1,v2 tx are not supported on RPC 0.8");if(r={signature:wh(e.signature),nonce:ul(e.nonce),resource_bounds:e.resourceBounds,tip:ul(e.tip),paymaster_data:e.paymasterData.map(e=>ul(e)),nonce_data_availability_mode:e.nonceDataAvailabilityMode,fee_data_availability_mode:e.feeDataAvailabilityMode,account_deployment_data:e.accountDeploymentData.map(e=>ul(e))},e.type===Sc.INVOKE)return{type:d.wV.INVOKE,sender_address:e.contractAddress,calldata:hu.toHex(e.calldata),version:ul(e.version||n.v3),...r};if(e.type===Sc.DECLARE){if(!Ch(e.contract))throw vc.error("Cairo 0 -  non Sierra v1 tx are not supported"),Error("Declaring non Sierra contract using RPC 0.8");return{type:e.type,contract_class:{...e.contract,sierra_program:gh(e.contract.sierra_program)},compiled_class_hash:e.compiledClassHash||"",sender_address:e.senderAddress,version:ul(e.version||n.v3),...r}}if(e.type===Sc.DEPLOY_ACCOUNT){const{account_deployment_data:t,...s}=r;return{type:e.type,constructor_calldata:hu.toHex(e.constructorCalldata||[]),class_hash:ul(e.classHash),contract_address_salt:ul(e.addressSalt||0),version:ul(e.version||n.v3),...s}}throw Error("RPC buildTransaction received unknown TransactionType")}},df=class{listeners={};on(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}off(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(e=>e!==t))}emit(e,t){this.listeners[e]&&this.listeners[e].forEach(e=>e(t))}clear(){this.listeners={}}},uf="undefined"!=typeof WebSocket&&WebSocket||"undefined"!=typeof globalThis&&globalThis.WebSocket||"undefined"!=typeof window&&window.WebSocket&&window.WebSocket.bind(window)||"undefined"!=typeof global&&global.WebSocket||class{constructor(){throw new Lh("WebSocket module not detected, use the 'websocket' constructor parameter to set a compatible connection")}},hf=class{channel;method;params;id;events=new df;buffer=[];maxBufferSize;handler=null;_isClosed=!1;constructor(e,t,n,r,s){this.channel=e,this.method=t,this.params=n,this.id=r,this.maxBufferSize=s}get isClosed(){return this._isClosed}_handleEvent(e){if(this.handler)this.handler(e);else{if(this.buffer.length>=this.maxBufferSize){const e=this.buffer.shift();vc.warn(`Subscription ${this.id}: Buffer full. Dropping oldest event:`,e)}this.buffer.push(e)}}on(e){if(this.handler)throw new Error("A handler is already attached to this subscription.");for(this.handler=e;this.buffer.length>0;){const e=this.buffer.shift();e&&this.handler(e)}}async unsubscribe(){if(this._isClosed)return!0;const e=await this.channel.unsubscribe(this.id);return e&&(this._isClosed=!0,this.channel.removeSubscription(this.id),this.events.emit("unsubscribe",void 0),this.events.clear()),e}},ff=class{nodeUrl;websocket;WsImplementation;activeSubscriptions=new Map;maxBufferSize;autoReconnect;reconnectOptions;requestTimeout;isReconnecting=!1;reconnectAttempts=0;userInitiatedClose=!1;reconnectTimeoutId=null;requestQueue=[];events=new df;openListener=e=>this.events.emit("open",e);closeListener=this.onCloseProxy.bind(this);messageListener=this.onMessageProxy.bind(this);errorListener=e=>this.events.emit("error",e);sendId=0;constructor(e){this.nodeUrl=e.nodeUrl,this.maxBufferSize=e.maxBufferSize??1e3,this.autoReconnect=e.autoReconnect??!0,this.reconnectOptions={retries:e.reconnectOptions?.retries??5,delay:e.reconnectOptions?.delay??2e3},this.requestTimeout=e.requestTimeout??6e4,this.WsImplementation=e.websocket||wc.get("websocket")||uf,this.websocket=new this.WsImplementation(this.nodeUrl),this.websocket.addEventListener("open",this.openListener),this.websocket.addEventListener("close",this.closeListener),this.websocket.addEventListener("message",this.messageListener),this.websocket.addEventListener("error",this.errorListener)}idResolver(e){return e||this.sendId++}send(e,t,n){if(!this.isConnected())throw new Ph("WebSocketChannel.send() failed due to socket being disconnected");const r=this.idResolver(n),s={id:r,jsonrpc:"2.0",method:e,...t&&{params:t}};return this.websocket.send(Xc(s)),r}sendReceive(e,t){if(this.isReconnecting||!this.isConnected()&&this.autoReconnect&&!this.userInitiatedClose)return vc.info(`WebSocket: Connection unavailable, queueing request: ${e}`),new Promise((n,r)=>{this.requestQueue.push({method:e,params:t,resolve:n,reject:r})});const n=this.send(e,t);return new Promise((t,r)=>{let s;if(!this.websocket||this.websocket.readyState!==uf.OPEN)return void r(new Ph("WebSocket not available or not connected."));const a=o=>{if(!il(o.data))return void vc.warn("WebSocket received non-string message data:",o.data);const c=JSON.parse(o.data);c.id===n&&(clearTimeout(s),this.websocket.removeEventListener("message",a),this.websocket.removeEventListener("error",i),"result"in c?t(c.result):r(new Error(`Error on ${e} (id: ${n}): ${JSON.stringify(c.error)}`)))},i=t=>{clearTimeout(s),this.websocket.removeEventListener("message",a),this.websocket.removeEventListener("error",i),r(new Error(`WebSocket error during ${e} (id: ${n}): ${t.type||"Unknown error"}`))};this.websocket.addEventListener("message",a),this.websocket.addEventListener("error",i),s=setTimeout(()=>{this.websocket.removeEventListener("message",a),this.websocket.removeEventListener("error",i),r(new Vh(`Request ${e} (id: ${n}) timed out after ${this.requestTimeout}ms`))},this.requestTimeout)})}isConnected(){return this.websocket.readyState===uf.OPEN}async waitForConnection(){return this.websocket.readyState!==uf.OPEN?new Promise((e,t)=>{this.websocket&&(this.websocket.onopen=()=>e(this.websocket.readyState),this.websocket.onerror=e=>t(e))}):this.websocket.readyState}disconnect(e,t){this.reconnectTimeoutId&&(clearTimeout(this.reconnectTimeoutId),this.reconnectTimeoutId=null),this.websocket.close(e,t),this.userInitiatedClose=!0}async waitForDisconnection(){return this.websocket.readyState!==uf.CLOSED?new Promise((e,t)=>{this.websocket&&(this.websocket.onclose=()=>e(this.websocket.readyState),this.websocket.onerror=t)}):this.websocket.readyState}async unsubscribe(e){const t=await this.sendReceive("starknet_unsubscribe",{subscription_id:e});return t&&this.events.emit("unsubscribe",e),t}waitForUnsubscription(e){return new Promise(t=>{const n=r=>{r===e&&(this.events.off("unsubscribe",n),t())};this.events.on("unsubscribe",n)})}reconnect(){this.userInitiatedClose=!1,this.websocket=new this.WsImplementation(this.nodeUrl),this.websocket.addEventListener("open",this.openListener),this.websocket.addEventListener("close",this.closeListener),this.websocket.addEventListener("message",this.messageListener),this.websocket.addEventListener("error",this.errorListener)}_processRequestQueue(){for(vc.info(`WebSocket: Processing ${this.requestQueue.length} queued requests.`);this.requestQueue.length>0;){const{method:e,params:t,resolve:n,reject:r}=this.requestQueue.shift();this.sendReceive(e,t).then(n).catch(r)}}async _restoreSubscriptions(){const e=Array.from(this.activeSubscriptions.values());this.activeSubscriptions.clear();const t=e.map(async e=>{try{const t=await this.sendReceive(e.method,e.params);e.id=t,this.activeSubscriptions.set(t,e),vc.info(`Subscription ${e.method} restored with new ID: ${t}`)}catch(t){vc.error(`Failed to restore subscription ${e.method}:`,t)}});await Promise.all(t)}_startReconnect(){if(this.isReconnecting||!this.autoReconnect)return;this.isReconnecting=!0,this.reconnectAttempts=0;const e=()=>{if(this.reconnectAttempts>=this.reconnectOptions.retries)return vc.error("WebSocket: Maximum reconnection retries reached. Giving up."),void(this.isReconnecting=!1);this.reconnectAttempts+=1,vc.info(`WebSocket: Connection lost. Attempting to reconnect... (${this.reconnectAttempts}/${this.reconnectOptions.retries})`),this.reconnect(),this.websocket.onopen=async()=>{vc.info("WebSocket: Reconnection successful."),this.isReconnecting=!1,this.reconnectAttempts=0,await this._restoreSubscriptions(),this._processRequestQueue(),this.events.emit("open",new Event("open"))},this.websocket.onerror=()=>{const t=this.reconnectOptions.delay*2**(this.reconnectAttempts-1);vc.info(`WebSocket: Reconnect attempt failed. Retrying in ${t}ms.`),this.reconnectTimeoutId=setTimeout(e,t)}};e()}onCloseProxy(e){this.websocket.removeEventListener("open",this.openListener),this.websocket.removeEventListener("close",this.closeListener),this.websocket.removeEventListener("message",this.messageListener),this.websocket.removeEventListener("error",this.errorListener),this.events.emit("close",e),this.userInitiatedClose||this._startReconnect()}onMessageProxy(e){let t;try{t=JSON.parse(e.data)}catch(t){return void vc.error(`WebSocketChannel: Error parsing incoming message: ${e.data}, Error: ${t}`)}if(t.method&&ol(t.params)&&"subscription_id"in t.params){const{result:e,subscription_id:n}=t.params,r=this.activeSubscriptions.get(n);r?r._handleEvent(e):vc.warn(`WebSocketChannel: Received event for untracked subscription ID: ${n}.`)}vc.debug("onMessageProxy:",e.data),this.events.emit("message",e)}async subscribeNewHeads(e){const t="starknet_subscribeNewHeads",n={block_id:e?new Gh(e).identifier:void 0},r=await this.sendReceive(t,n),s=new hf(this,t,n,r,this.maxBufferSize);return this.activeSubscriptions.set(r,s),s}async subscribeEvents(e,t,n){const r="starknet_subscribeEvents",s={from_address:void 0!==e?ul(e):void 0,keys:t,block_id:n?new Gh(n).identifier:void 0},a=await this.sendReceive(r,s),i=new hf(this,r,s,a,this.maxBufferSize);return this.activeSubscriptions.set(a,i),i}async subscribeTransactionStatus(e,t){const n="starknet_subscribeTransactionStatus",r={transaction_hash:ul(e),block_id:t?new Gh(t).identifier:void 0},s=await this.sendReceive(n,r),a=new hf(this,n,r,s,this.maxBufferSize);return this.activeSubscriptions.set(s,a),a}async subscribePendingTransaction(e,t){const n="starknet_subscribePendingTransactions",r={transaction_details:e,sender_address:t&&wl(t)},s=await this.sendReceive(n,r),a=new hf(this,n,r,s,this.maxBufferSize);return this.activeSubscriptions.set(s,a),a}removeSubscription(e){this.activeSubscriptions.delete(e)}on(e,t){this.events.on(e,t)}off(e,t){this.events.off(e,t)}},pf=class{margin;constructor(e){this.margin=e}estimatedFeeToMaxFee(e){return bh(e,this.margin?.maxFee)}estimateFeeToBounds(e){return vh(e,this.margin?.bounds)}parseGetBlockResponse(e){return e}parseTransactionReceipt(e){return e}parseFeeEstimateResponse(e){const t=e[0];return{overall_fee:ll(t.overall_fee),unit:t.unit,l1_gas_consumed:dl(t.l1_gas_consumed)??dl(t.gas_consumed)??0n,l1_gas_price:dl(t.l1_gas_price)??dl(t.gas_price)??0n,l2_gas_consumed:dl(t.l2_gas_consumed)??void 0,l2_gas_price:dl(t.l2_gas_price)??void 0,l1_data_gas_consumed:dl(t.l1_data_gas_consumed)??dl(t.data_gas_consumed)??0n,l1_data_gas_price:dl(t.l1_data_gas_price)??dl(t.gas_price)??0n,suggestedMaxFee:this.estimatedFeeToMaxFee(t.overall_fee),resourceBounds:this.estimateFeeToBounds(t)}}parseFeeEstimateBulkResponse(e){return e.map(e=>({overall_fee:ll(e.overall_fee),unit:e.unit,l1_gas_consumed:dl(e.l1_gas_consumed)??dl(e.gas_consumed)??0n,l1_gas_price:dl(e.l1_gas_price)??dl(e.gas_price)??0n,l2_gas_consumed:dl(e.l2_gas_consumed)??void 0,l2_gas_price:dl(e.l2_gas_price)??void 0,l1_data_gas_consumed:dl(e.l1_data_gas_consumed)??dl(e.data_gas_consumed)??0n,l1_data_gas_price:dl(e.l1_data_gas_price)??dl(e.gas_price)??0n,suggestedMaxFee:this.estimatedFeeToMaxFee(e.overall_fee),resourceBounds:this.estimateFeeToBounds(e)}))}parseSimulateTransactionResponse(e){return e.map(e=>({...e,suggestedMaxFee:this.estimatedFeeToMaxFee(e.fee_estimation.overall_fee),resourceBounds:this.estimateFeeToBounds(e.fee_estimation)}))}parseContractClassResponse(e){return{...e,abi:il(e.abi)?JSON.parse(e.abi):e.abi}}parseL1GasPriceResponse(e){return e.l1_gas_price.price_in_wei}},gf=class e{statusReceipt;value;constructor(t){[this.statusReceipt,this.value]=e.isSuccess(t)?["success",t]:e.isReverted(t)?["reverted",t]:["error",new Error("Unknown response type")];for(const[e]of Object.entries(this))Object.defineProperty(this,e,{enumerable:!1});for(const[e,n]of Object.entries(t))Object.defineProperty(this,e,{enumerable:!0,writable:!1,value:n})}match(e){return this.statusReceipt in e?e[this.statusReceipt](this.value):e._()}isSuccess(){return"success"===this.statusReceipt}isReverted(){return"reverted"===this.statusReceipt}isError(){return"error"===this.statusReceipt}static isSuccess(e){return e.execution_status===xc.SUCCEEDED}static isReverted(e){return e.execution_status===xc.REVERTED}},mf={};ko(mf,{encodeData:()=>Nf,encodeType:()=>Cf,encodeValue:()=>Of,getDependencies:()=>If,getMessageHash:()=>Lf,getStructHash:()=>Df,getTypeHash:()=>Bf,isMerkleTreeType:()=>xf,prepareSelector:()=>Tf,validateTypedData:()=>Sf,verifyMessage:()=>Rf});var yf={};ko(yf,{MerkleTree:()=>_f,proofMerklePath:()=>wf});var _f=class e{leaves;branches=[];root;hashMethod;constructor(e,t=zu){this.hashMethod=t,this.leaves=e,this.root=this.build(e)}build(t){if(1===t.length)return t[0];t.length!==this.leaves.length&&this.branches.push(t);const n=[];for(let r=0;r<t.length;r+=2)r+1===t.length?n.push(e.hash(t[r],"0x0",this.hashMethod)):n.push(e.hash(t[r],t[r+1],this.hashMethod));return this.build(n)}static hash(e,t,n=zu){const[r,s]=[BigInt(e),BigInt(t)].sort((e,t)=>e>=t?1:-1);return n(r,s)}getProof(t,n=this.leaves,r=[]){const s=n.indexOf(t);if(-1===s)throw new Error("leaf not found");if(1===n.length)return r;const a=s%2==0,i=(a?n[s+1]:n[s-1])??"0x0",o=[...r,i],c=this.leaves.length===n.length?-1:this.branches.findIndex(e=>e.length===n.length),l=this.branches[c+1]??[this.root];return this.getProof(e.hash(a?t:i,a?i:t,this.hashMethod),l,o)}};function wf(e,t,n,r=zu){if(0===n.length)return e===t;const[s,...a]=n;return wf(e,_f.hash(t,s,r),a,r)}var bf={u256:JSON.parse('[{ "name": "low", "type": "u128" }, { "name": "high", "type": "u128" }]'),TokenAmount:JSON.parse('[{ "name": "token_address", "type": "ContractAddress" }, { "name": "amount", "type": "u256" }]'),NftId:JSON.parse('[{ "name": "collection_address", "type": "ContractAddress" }, { "name": "token_id", "type": "u256" }]')},vf={[U.K.ACTIVE]:{domain:"StarknetDomain",hashMethod:Wu,hashMerkleMethod:ju,escapeTypeString:e=>`"${e}"`,presetTypes:bf},[U.K.LEGACY]:{domain:"StarkNetDomain",hashMethod:Ku,hashMerkleMethod:zu,escapeTypeString:e=>e,presetTypes:{}}};function Ef(e,t,{min:n,max:r}){const s=BigInt(e);Qc(s>=n&&s<=r,`${s} (${t}) is out of bounds [${n}, ${r}]`)}function Af({types:e,domain:t}){return vf[U.K.ACTIVE].domain in e&&t.revision?.toString()===U.K.ACTIVE?U.K.ACTIVE:vf[U.K.LEGACY].domain in e&&(t.revision??U.K.LEGACY)===U.K.LEGACY?U.K.LEGACY:void 0}function kf(e){try{return ul(e)}catch(t){if(il(e))return ul(ql(e));throw new Error(`Invalid BigNumberish: ${e}`)}}function Sf(e){const t=e;return Boolean(t.message&&t.primaryType&&t.types&&Af(t))}function Tf(e){return cl(e)?e:Nl(e)}function xf(e){return"merkletree"===e.type}function If(e,t,n=[],r="",s=U.K.LEGACY){let a=[t];return"*"===t[t.length-1]?a=[t.slice(0,-1)]:s===U.K.ACTIVE&&("enum"===t?a=[r]:t.match(/^\(.*\)$/)&&(a=t.slice(1,-1).split(",").map(e=>"*"===e[e.length-1]?e.slice(0,-1):e))),a.filter(t=>!n.includes(t)&&e[t]).reduce((t,n)=>[...t,...[n,...e[n].reduce((t,n)=>[...t,...If(e,n.type,t,n.contains,s).filter(e=>!t.includes(e))],[])].filter(e=>!t.includes(e))],[])}function Cf(e,t,n=U.K.LEGACY){const r=n===U.K.ACTIVE?{...e,...vf[n].presetTypes}:e,[s,...a]=If(r,t,void 0,void 0,n),i=s?[s,...a.sort()]:[],o=vf[n].escapeTypeString;return i.map(e=>{const t=r[e].map(e=>{const t="enum"===e.type&&n===U.K.ACTIVE?e.contains:e.type,r=t.match(/^\(.*\)$/)?`(${t.slice(1,-1).split(",").map(e=>e?o(e):e).join(",")})`:o(t);return`${o(e.name)}:${r}`});return`${o(e)}(${t})`}).join("")}function Bf(e,t,n=U.K.LEGACY){return Nl(Cf(e,t,n))}function Of(e,t,n,r={},s=U.K.LEGACY){if(e[t])return[t,Df(e,t,n,s)];if(vf[s].presetTypes[t])return[t,Df(vf[s].presetTypes,t,n,s)];if(t.endsWith("*")){const r=n.map(n=>Of(e,t.slice(0,-1),n,void 0,s)[1]);return[t,vf[s].hashMethod(r)]}switch(t){case"enum":if(s===U.K.ACTIVE){const[a,i]=Object.entries(n)[0],o=e[r.parent].find(e=>e.name===r.key),c=e[o.contains],l=c.find(e=>e.name===a),d=c.indexOf(l),u=l.type.slice(1,-1).split(",").map((t,n)=>{if(!t)return t;const r=i[n];return Of(e,t,r,void 0,s)[1]});return[t,vf[s].hashMethod([d,...u])]}return[t,kf(n)];case"merkletree":{const t=function(e,t){if(t.parent&&t.key){const n=e[t.parent].find(e=>e.name===t.key);if(!xf(n))throw new Error(`${t.key} is not a merkle tree`);if(n.contains.endsWith("*"))throw new Error(`Merkle tree contain property must not be an array but was given ${t.key}`);return n.contains}return"raw"}(e,r),a=n.map(n=>Of(e,t,n,void 0,s)[1]),{root:i}=new _f(a,vf[s].hashMerkleMethod);return["felt",i]}case"selector":return["felt",Tf(n)];case"string":if(s===U.K.ACTIVE){const e=Yl(n),r=[e.data.length,...e.data,e.pending_word,e.pending_word_len];return[t,vf[s].hashMethod(r)]}return[t,kf(n)];case"i128":if(s===U.K.ACTIVE){const e=BigInt(n);return Ef(e,t,nc),[t,kf(e<0n?Xo+e:e)]}return[t,kf(n)];case"timestamp":case"u128":return s===U.K.ACTIVE&&Ef(n,t,rc),[t,kf(n)];case"felt":case"shortstring":return s===U.K.ACTIVE&&Ef(kf(n),t,tc),[t,kf(n)];case"ClassHash":case"ContractAddress":return s===U.K.ACTIVE&&Ef(n,t,tc),[t,kf(n)];case"bool":return s===U.K.ACTIVE&&Qc(sl(n),`Type mismatch for ${t} ${n}`),[t,kf(n)];default:if(s===U.K.ACTIVE)throw new Error(`Unsupported type: ${t}`);return[t,kf(n)]}}function Nf(e,t,n,r=U.K.LEGACY){const s=e[t]??vf[r].presetTypes[t],[a,i]=s.reduce(([s,a],i)=>{if(void 0===n[i.name]||null===n[i.name]&&"enum"!==i.type)throw new Error(`Cannot encode data: missing data for '${i.name}'`);const o=n[i.name],c={parent:t,key:i.name},[l,d]=Of(e,i.type,o,c,r);return[[...s,l],[...a,d]]},[["felt"],[Bf(e,t,r)]]);return[a,i]}function Df(e,t,n,r=U.K.LEGACY){return vf[r].hashMethod(Nf(e,t,n,r)[1])}function Lf(e,t){if(!Sf(e))throw new Error("Typed data does not match JSON schema");const n=Af(e),{domain:r,hashMethod:s}=vf[n];return s([ql("StarkNet Message"),Df(e.types,r,e.domain,n),t,Df(e.types,e.primaryType,e.message,n)])}function Rf(e,t,n,r){const s=Sf(e);if(!Il(e)&&!s)throw new Error("message has a wrong format.");if(s&&void 0===r)throw new Error("When providing a TypedData in message parameter, the accountAddress parameter has to be provided.");if(s&&!Il(r))throw new Error("accountAddress shall be a BigNumberish");const a=s?Lf(e,r):ul(e);return er(Array.isArray(t)?new rr(BigInt(t[0]),BigInt(t[1])):t,a,ul(n))}var Vf=class{responseParser;channel;constructor(e){if(e&&"channel"in e)this.channel=e.channel,this.responseParser="responseParser"in e?e.responseParser:new pf;else{if(e&&e.specVersion)if(oh("0.8",e.specVersion))this.channel=new of.RpcChannel({...e,waitMode:!1});else{if(!oh("0.7",e.specVersion))throw new Error(`unsupported channel for spec version: ${e.specVersion}`);this.channel=new Ec.RpcChannel({...e,waitMode:!1})}else if(oh("0.8",wc.get("rpcVersion")))this.channel=new of.RpcChannel({...e,waitMode:!1});else{if(!oh("0.7",wc.get("rpcVersion")))throw new Error("unable to define spec version for channel");this.channel=new Ec.RpcChannel({...e,waitMode:!1})}this.responseParser=new pf(e?.feeMarginPercentage)}}static async create(e){const t=new Ec.RpcChannel({...e}),n=await t.getSpecVersion();if(ch(n)||vc.warn(`Using incompatible node spec version ${n}`),oh("0.7",n))return new this({...e,specVersion:pc.v0_7_1});if(oh("0.8",n))return new this({...e,specVersion:pc.v0_8_1});throw new Lh(`Provided RPC node specification version ${n} is not compatible with the SDK. SDK supported RPC versions ${Object.keys(pc).toString()}`)}fetch(e,t,n=0){return this.channel.fetch(e,t,n)}async getChainId(){return this.channel.getChainId()}readSpecVersion(){return this.channel.readSpecVersion()}async getSpecVersion(){return this.channel.getSpecVersion()}setUpSpecVersion(){return this.channel.setUpSpecVersion()}async getNonceForAddress(e,t){return this.channel.getNonceForAddress(e,t)}async getBlock(e){return this.channel.getBlockWithTxHashes(e).then(this.responseParser.parseGetBlockResponse)}async getBlockLatestAccepted(){return this.channel.getBlockLatestAccepted()}async getBlockNumber(){return this.channel.getBlockNumber()}async getBlockWithTxHashes(e){return this.channel.getBlockWithTxHashes(e)}async getBlockWithTxs(e){return this.channel.getBlockWithTxs(e)}async waitForBlock(e="pending",t=5e3){if(e===Cc.LATEST)return;const n=await this.getBlockNumber(),r=e===Cc.PENDING?n+1:Number(ul(e));if(r<=n)return;const{retries:s}=this.channel;let a=s,i=!1;for(;!i;)if(await this.getBlockNumber()===r?i=!0:await zh(t),a-=1,a<=0)throw new Error(`waitForBlock() timed-out after ${s} tries.`)}async getL1GasPrice(e){return this.channel.getBlockWithTxHashes(e).then(this.responseParser.parseL1GasPriceResponse)}async getL1MessageHash(e){const t=await this.channel.getTransactionByHash(e);Qc("L1_HANDLER"===t.type,"This L2 transaction is not a L1 message.");const{calldata:n,contract_address:r,entry_point_selector:s,nonce:a}=t;return Ll([n[0],r,a,s,n.length-1,...n.slice(1)])}async getBlockWithReceipts(e){return this.channel.getBlockWithReceipts(e)}getStateUpdate=this.getBlockStateUpdate;async getBlockStateUpdate(e){return this.channel.getBlockStateUpdate(e)}async getBlockTransactionsTraces(e){return this.channel.getBlockTransactionsTraces(e)}async getBlockTransactionCount(e){return this.channel.getBlockTransactionCount(e)}async getTransaction(e){return this.channel.getTransactionByHash(e)}async getTransactionByHash(e){return this.channel.getTransactionByHash(e)}async getTransactionByBlockIdAndIndex(e,t){return this.channel.getTransactionByBlockIdAndIndex(e,t)}async getTransactionReceipt(e){const t=await this.channel.getTransactionReceipt(e),n=this.responseParser.parseTransactionReceipt(t);return new gf(n)}async getTransactionTrace(e){return this.channel.getTransactionTrace(e)}async getTransactionStatus(e){return this.channel.getTransactionStatus(e)}async getSimulateTransaction(e,t){return this.channel.simulateTransaction(e,t).then(e=>this.responseParser.parseSimulateTransactionResponse(e))}async waitForTransaction(e,t){const n=await this.channel.waitForTransaction(e,t);return new gf(n)}async getStorageAt(e,t,n){return this.channel.getStorageAt(e,t,n)}async getClassHashAt(e,t){return this.channel.getClassHashAt(e,t)}async getClassByHash(e){return this.getClass(e)}async getClass(e,t){return this.channel.getClass(e,t).then(this.responseParser.parseContractClassResponse)}async getClassAt(e,t){return this.channel.getClassAt(e,t).then(this.responseParser.parseContractClassResponse)}async getContractVersion(e,t,{blockIdentifier:n=this.channel.blockIdentifier,compiler:r=!0}={}){let s;if(e)s=await this.getClassAt(e,n);else{if(!t)throw Error("getContractVersion require contractAddress or classHash");s=await this.getClass(t,n)}return Ch(s)?r?{cairo:"1",compiler:Dd(s.abi).compiler}:{cairo:"1",compiler:void 0}:{cairo:"0",compiler:"0"}}async getInvokeEstimateFee(e,t,n,r){return this.channel.getEstimateFee([{type:Sc.INVOKE,...e,...t}],{blockIdentifier:n,skipValidate:r}).then(e=>this.responseParser.parseFeeEstimateResponse(e))}async getDeclareEstimateFee(e,t,n,r){return this.channel.getEstimateFee([{type:Sc.DECLARE,...e,...t}],{blockIdentifier:n,skipValidate:r}).then(e=>this.responseParser.parseFeeEstimateResponse(e))}async getDeployAccountEstimateFee(e,t,n,r){return this.channel.getEstimateFee([{type:Sc.DEPLOY_ACCOUNT,...e,...t}],{blockIdentifier:n,skipValidate:r}).then(e=>this.responseParser.parseFeeEstimateResponse(e))}async getEstimateFeeBulk(e,t){return this.channel.getEstimateFee(e,t).then(e=>this.responseParser.parseFeeEstimateBulkResponse(e))}async invokeFunction(e,t){return this.channel.invoke(e,t)}async declareContract(e,t){return this.channel.declare(e,t)}async deployAccountContract(e,t){return this.channel.deployAccount(e,t)}async callContract(e,t){return this.channel.callContract(e,t)}async estimateMessageFee(e,t){return this.channel.estimateMessageFee(e,t)}async getSyncingStats(){return this.channel.getSyncingStats()}async getEvents(e){return this.channel.getEvents(e)}async verifyMessageInStarknet(e,t,n,r,s){const a=Sf(e);if(!Il(e)&&!a)throw new Error("message has a wrong format.");if(!Il(n))throw new Error("accountAddress shall be a BigNumberish");const i=a?Lf(e,n):ul(e),o=r?[r]:["isValidSignature","is_valid_signature"],c=s||{okResponse:[],nokResponse:["0x0","0x00"],error:["argent/invalid-signature","0x617267656e742f696e76616c69642d7369676e6174757265","is invalid, with respect to the public key","0x697320696e76616c6964","INVALID_SIG","0x494e56414c49445f534947"]};let l;for(const e of o)try{const r=await this.callContract({contractAddress:ul(n),entrypoint:e,calldata:hu.compile({hash:ll(i).toString(),signature:yh(t)})});if(c.nokResponse.includes(r[0].toString()))return!1;if(0===c.okResponse.length||c.okResponse.includes(r[0].toString()))return!0;throw Error("signatureVerificationResponse Error: response is not part of known responses")}catch(e){if(c.error.some(t=>e.message.includes(t)))return!1;l=e}throw Error(`Signature verification Error: ${l}`)}async isClassDeclared(e,t){let n;if(!e.classHash&&"contract"in e)n=Bh(e).classHash;else{if(!e.classHash)throw Error("contractClassIdentifier type not satisfied");n=e.classHash}try{return await this.getClass(n,t)instanceof Object}catch(e){if(e instanceof Lh)return!1;throw e}}async prepareInvocations(e){const t=[];for(const n of e)n.type===Sc.DECLARE?await this.isClassDeclared("payload"in n?n.payload:n)||t.unshift(n):t.push(n);return t}async getL1MessagesStatus(e){if(this.channel instanceof of.RpcChannel)return this.channel.getMessagesStatus(e);throw new Lh("Unsupported method for RPC version")}async getStorageProof(e,t,n,r){if(this.channel instanceof of.RpcChannel)return this.channel.getStorageProof(e,t,n,r);throw new Lh("Unsupported method for RPC version")}async getCompiledCasm(e){if(this.channel instanceof of.RpcChannel)return this.channel.getCompiledCasm(e);throw new Lh("Unsupported method for RPC version")}},Pf={};ko(Pf,{StarknetIdContract:()=>Wf,StarknetIdIdentityContract:()=>Yf,StarknetIdMulticallContract:()=>Xf,StarknetIdPfpContract:()=>tp,StarknetIdPopContract:()=>rp,StarknetIdVerifierContract:()=>Qf,dynamicCallData:()=>op,dynamicFelt:()=>ip,execution:()=>ap,getStarknetIdContract:()=>Zf,getStarknetIdIdentityContract:()=>Gf,getStarknetIdMulticallContract:()=>Jf,getStarknetIdPfpContract:()=>np,getStarknetIdPopContract:()=>sp,getStarknetIdVerifierContract:()=>ep,isStarkDomain:()=>cp,useDecoded:()=>qf,useEncoded:()=>Kf});var Ff="abcdefghijklmnopqrstuvwxyz0123456789-",Uf=BigInt(Ff.length+1),Mf="这来",$f=BigInt(Ff.length),Hf=BigInt(Mf.length),zf=BigInt(Mf.length+1);function jf(e){let t=0;for(;e.endsWith(Mf[Mf.length-1]);)e=e.substring(0,e.length-1),t+=1;return[e,t]}function qf(e){let t="";return e.forEach(e=>{for(;e!==Wo;){const n=e%Uf;if(e/=Uf,n===BigInt(Ff.length)){const n=e/zf;if(n===Wo){const r=e%zf;e=n,t+=r===Wo?Ff[0]:Mf[Number(r)-1]}else t+=Mf[Number(e%Hf)],e/=Hf}else t+=Ff[Number(n)]}const[n,r]=jf(t);r&&(t=n+(r%2==0?Mf[Mf.length-1].repeat(r/2-1)+Mf[0]+Ff[1]:Mf[Mf.length-1].repeat((r-1)/2+1))),t+="."}),t?t.concat("stark"):t}function Kf(e){let t=BigInt(0),n=BigInt(1);if(e.endsWith(Mf[0]+Ff[1])){const[t,n]=jf(e.substring(0,e.length-2));e=t+Mf[Mf.length-1].repeat(2*(n+1))}else{const[t,n]=jf(e);n&&(e=t+Mf[Mf.length-1].repeat(1+2*(n-1)))}for(let r=0;r<e.length;r+=1){const s=e[r],a=Ff.indexOf(s),i=BigInt(Ff.indexOf(s));if(-1!==a)r===e.length-1&&e[r]===Ff[0]?(t+=n*$f,n*=Uf,n*=Uf):(t+=n*i,n*=Uf);else if(-1!==Mf.indexOf(s)){t+=n*$f,n*=Uf;const a=(r===e.length-1?1:0)+Mf.indexOf(s);t+=n*BigInt(a),n*=Hf}}return t}var Wf={MAINNET:"0x6ac597f8116f886fa1c97a23fa4e08299975ecaf6b598873ca6792b9bbfb678",TESTNET_SEPOLIA:"0x154bc2e1af9260b9e66af0e9c46fc757ff893b3ff6a85718a810baf1474"};function Zf(e){switch(e){case hc.SN_MAIN:return Wf.MAINNET;case hc.SN_SEPOLIA:return Wf.TESTNET_SEPOLIA;default:throw new Error("Starknet.id is not yet deployed on this network")}}var Yf={MAINNET:"0x05dbdedc203e92749e2e746e2d40a768d966bd243df04a6b712e222bc040a9af",TESTNET_SEPOLIA:"0x3697660a0981d734780731949ecb2b4a38d6a58fc41629ed611e8defda"};function Gf(e){switch(e){case hc.SN_MAIN:return Yf.MAINNET;case hc.SN_SEPOLIA:return Yf.TESTNET_SEPOLIA;default:throw new Error("Starknet.id verifier contract is not yet deployed on this network")}}var Xf="0x034ffb8f4452df7a613a0210824d6414dbadcddce6c6e19bf4ddc9e22ce5f970";function Jf(e){switch(e){case hc.SN_MAIN:case hc.SN_SEPOLIA:return Xf;default:throw new Error("Starknet.id multicall contract is not yet deployed on this network")}}var Qf={MAINNET:"0x07d14dfd8ee95b41fce179170d88ba1f0d5a512e13aeb232f19cfeec0a88f8bf",TESTNET_SEPOLIA:"0x60B94fEDe525f815AE5E8377A463e121C787cCCf3a36358Aa9B18c12c4D566"};function ep(e){switch(e){case hc.SN_MAIN:return Qf.MAINNET;case hc.SN_SEPOLIA:return Qf.TESTNET_SEPOLIA;default:throw new Error("Starknet.id verifier contract is not yet deployed on this network")}}var tp={MAINNET:"0x070aaa20ec4a46da57c932d9fd89ca5e6bb9ca3188d3df361a32306aff7d59c7",TESTNET_SEPOLIA:"0x9e7bdb8dabd02ea8cfc23b1d1c5278e46490f193f87516ed5ff2dfec02"};function np(e){switch(e){case hc.SN_MAIN:return tp.MAINNET;case hc.SN_SEPOLIA:return tp.TESTNET_SEPOLIA;default:throw new Error("Starknet.id profile picture verifier contract is not yet deployed on this network")}}var rp={MAINNET:"0x0293eb2ba9862f762bd3036586d5755a782bd22e6f5028320f1d0405fd47bff4",TESTNET_SEPOLIA:"0x15ae88ae054caa74090b89025c1595683f12edf7a4ed2ad0274de3e1d4a"};function sp(e){switch(e){case hc.SN_MAIN:return rp.MAINNET;case hc.SN_SEPOLIA:return rp.TESTNET_SEPOLIA;default:throw new Error("Starknet.id proof of personhood verifier contract is not yet deployed on this network")}}function ap(e,t=void 0,n=void 0){return new Fd({Static:e,IfEqual:t?Vd(t[0],t[1],t[2]):void 0,IfNotEqual:n?Vd(n[0],n[1],n[2]):void 0})}function ip(e,t=void 0){return new Fd({Hardcoded:e,Reference:t?Vd(t[0],t[1]):void 0})}function op(e,t=void 0,n=void 0){return new Fd({Hardcoded:e,Reference:t?Vd(t[0],t[1]):void 0,ArrayReference:n?Vd(n[0],n[1]):void 0})}function cp(e){return/^(?:[a-z0-9-]{1,48}(?:[a-z0-9-]{1,48}[a-z0-9-])?\.)*[a-z0-9-]{1,48}\.stark$/.test(e)}var lp=class e{async getStarkName(t,n){return e.getStarkName(this,t,n)}async getAddressFromStarkName(t,n){return e.getAddressFromStarkName(this,t,n)}async getStarkProfile(t,n,r,s,a,i,o){return e.getStarkProfile(this,t,n,r,s,a,i,o)}static async getStarkName(e,t,n){const r=await e.getChainId(),s=n??Zf(r);try{const n=qf((await e.callContract({contractAddress:s,entrypoint:"address_to_domain",calldata:hu.compile({address:t,hint:[]})})).map(e=>BigInt(e)).slice(1));if(!n)throw Error("Starkname not found");return n}catch(e){if(e instanceof Error&&"Starkname not found"===e.message)throw e;throw Error("Could not get stark name")}}static async getAddressFromStarkName(e,t,n){const r=t.endsWith(".stark")?t:`${t}.stark`;if(!cp(r))throw new Error("Invalid domain, must be a valid .stark domain");const s=await e.getChainId(),a=n??Zf(s);try{const t=r.replace(".stark","").split(".").map(e=>Kf(e).toString(10));return(await e.callContract({contractAddress:a,entrypoint:"domain_to_address",calldata:hu.compile({domain:t,hint:[]})}))[0]}catch{throw Error("Could not get address from stark name")}}static async getStarkProfile(e,t,n,r,s,a,i,o){const c=await e.getChainId(),l=n??Zf(c),d=r??Gf(c),u=s??ep(c),h=a??np(c),f=i??sp(c),p=o??Jf(c);try{const n=[{execution:ap({}),to:op(l),selector:op(Nl("address_to_domain")),calldata:[op(t),op("0")]},{execution:ap({}),to:ip(l),selector:ip(Nl("domain_to_id")),calldata:[op(void 0,void 0,[0,0])]},{execution:ap({}),to:ip(d),selector:ip(Nl("get_verifier_data")),calldata:[op(void 0,[1,0]),op(ql("twitter")),op(u),op("0")]},{execution:ap({}),to:ip(d),selector:ip(Nl("get_verifier_data")),calldata:[op(void 0,[1,0]),op(ql("github")),op(u),op("0")]},{execution:ap({}),to:ip(d),selector:ip(Nl("get_verifier_data")),calldata:[op(void 0,[1,0]),op(ql("discord")),op(u),op("0")]},{execution:ap({}),to:ip(d),selector:ip(Nl("get_verifier_data")),calldata:[op(void 0,[1,0]),op(ql("proof_of_personhood")),op(f),op("0")]},{execution:ap({}),to:ip(d),selector:ip(Nl("get_verifier_data")),calldata:[op(void 0,[1,0]),op(ql("nft_pp_contract")),op(h),op("0")]},{execution:ap({}),to:ip(d),selector:ip(Nl("get_extended_verifier_data")),calldata:[op(void 0,[1,0]),op(ql("nft_pp_id")),op("2"),op(h),op("0")]},{execution:ap(void 0,void 0,[6,0,0]),to:ip(void 0,[6,0]),selector:ip(Nl("tokenURI")),calldata:[op(void 0,[7,1]),op(void 0,[7,2])]}],r=await e.callContract({contractAddress:p,entrypoint:"aggregate",calldata:hu.compile({calls:n})});if(Array.isArray(r)){const e=parseInt(r[0],16),t=[];let n=1;for(let s=0;s<e&&n<r.length;s+=1){const e=parseInt(r[n],16);n+=1;const s=r.slice(n,n+e);t.push(s),n+=e}const s=qf(t[0].slice(1).map(e=>BigInt(e))),a="0x0"!==t[2][0]?BigInt(t[2][0]).toString():void 0,i="0x0"!==t[3][0]?BigInt(t[3][0]).toString():void 0,o="0x0"!==t[4][0]?BigInt(t[4][0]).toString():void 0,c="0x1"===t[5][0];return{name:s,twitter:a,github:i,discord:o,proofOfPersonhood:c,profilePicture:("0x9"===r[0]?t[8].slice(1).map(e=>Kl(e)).join(""):void 0)||`https://starknet.id/api/identicons/${BigInt(t[1][0]).toString()}`}}throw Error("Error while calling aggregate function")}catch(e){if(e instanceof Error)throw e;throw Error("Could not get user stark profile data from address")}}},dp=class extends(_o(Vf,lp)){},up=class{},hp=new Vf({default:!0}),fp=class{},pp=class{pk;constructor(e=sr.randomPrivateKey()){this.pk=e instanceof Uint8Array?Vo(e):ul(e)}async getPubKey(){return cr(this.pk)}async signMessage(e,t){const n=Lf(e,t);return this.signRaw(n)}async signTransaction(e,t){const n=tf(e,t.cairoVersion);let r;if(Object.values(xo.ETransactionVersion2).includes(t.version)){const e=t;r=Mu({...e,senderAddress:e.walletAddress,compiledCalldata:n,version:e.version})}else{if(!Object.values(xo.ETransactionVersion3).includes(t.version))throw Error("unsupported signTransaction version");{const e=t;r=Mu({...e,senderAddress:e.walletAddress,compiledCalldata:n,version:e.version,nonceDataAvailabilityMode:Ah(e.nonceDataAvailabilityMode),feeDataAvailabilityMode:Ah(e.feeDataAvailabilityMode)})}}return this.signRaw(r)}async signDeployAccountTransaction(e){const t=hu.compile(e.constructorCalldata);let n;if(Object.values(xo.ETransactionVersion2).includes(e.version)){const r=e;n=Hu({...r,salt:r.addressSalt,constructorCalldata:t,version:r.version})}else{if(!Object.values(xo.ETransactionVersion3).includes(e.version))throw Error("unsupported signDeployAccountTransaction version");{const r=e;n=Hu({...r,salt:r.addressSalt,compiledConstructorCalldata:t,version:r.version,nonceDataAvailabilityMode:Ah(r.nonceDataAvailabilityMode),feeDataAvailabilityMode:Ah(r.feeDataAvailabilityMode)})}}return this.signRaw(n)}async signDeclareTransaction(e){let t;if(Object.values(xo.ETransactionVersion2).includes(e.version)){const n=e;t=$u({...n,version:n.version})}else{if(!Object.values(xo.ETransactionVersion3).includes(e.version))throw Error("unsupported signDeclareTransaction version");{const n=e;t=$u({...n,version:n.version,nonceDataAvailabilityMode:Ah(n.nonceDataAvailabilityMode),feeDataAvailabilityMode:Ah(n.feeDataAvailabilityMode)})}}return this.signRaw(t)}async signRaw(e){return Qn(e,this.pk)}},gp={};function mp(e){return new ad(e).toBigInt()}function yp(e){return ad.is(e)}function _p(e){return new ad(e).toUint256HexString()}ko(gp,{bnToUint256:()=>_p,isUint256:()=>yp,uint256ToBN:()=>mp});var wp=class{pk;constructor(e=Uh()){this.pk=e instanceof Uint8Array?Vo(e).padStart(64,"0"):Po(ul(e)).padStart(64,"0")}async getPubKey(){return Fo(Vo(io.getPublicKey(this.pk,!1)).padStart(130,"0").slice(2))}async signMessage(e,t){const n=Lf(e,t),r=io.sign(Po(Ho(n)),this.pk);return this.formatEthSignature(r)}async signTransaction(e,t){const n=tf(e,t.cairoVersion);let r;if(Object.values(xo.ETransactionVersion2).includes(t.version)){const e=t;r=Mu({...e,senderAddress:e.walletAddress,compiledCalldata:n,version:e.version})}else{if(!Object.values(xo.ETransactionVersion3).includes(t.version))throw Error("unsupported signTransaction version");{const e=t;r=Mu({...e,senderAddress:e.walletAddress,compiledCalldata:n,version:e.version,nonceDataAvailabilityMode:Ah(e.nonceDataAvailabilityMode),feeDataAvailabilityMode:Ah(e.feeDataAvailabilityMode)})}}const s=io.sign(Po(Ho(r)),this.pk);return this.formatEthSignature(s)}async signDeployAccountTransaction(e){const t=hu.compile(e.constructorCalldata);let n;if(Object.values(xo.ETransactionVersion2).includes(e.version)){const r=e;n=Hu({...r,salt:r.addressSalt,constructorCalldata:t,version:r.version})}else{if(!Object.values(xo.ETransactionVersion3).includes(e.version))throw Error("unsupported signDeployAccountTransaction version");{const r=e;n=Hu({...r,salt:r.addressSalt,compiledConstructorCalldata:t,version:r.version,nonceDataAvailabilityMode:Ah(r.nonceDataAvailabilityMode),feeDataAvailabilityMode:Ah(r.feeDataAvailabilityMode)})}}const r=io.sign(Po(Ho(n)),this.pk);return this.formatEthSignature(r)}async signDeclareTransaction(e){let t;if(Object.values(xo.ETransactionVersion2).includes(e.version)){const n=e;t=$u({...n,version:n.version})}else{if(!Object.values(xo.ETransactionVersion3).includes(e.version))throw Error("unsupported signDeclareTransaction version");{const n=e;t=$u({...n,version:n.version,nonceDataAvailabilityMode:Ah(n.nonceDataAvailabilityMode),feeDataAvailabilityMode:Ah(n.feeDataAvailabilityMode)})}}const n=io.sign(Po(Ho(t)),this.pk);return this.formatEthSignature(n)}formatEthSignature(e){const t=_p(e.r),n=_p(e.s);return[ul(t.low),ul(t.high),ul(n.low),ul(n.high),ul(e.recovery)]}},bp=class{transporter;_transporter;accountID;eip2645applicationName;pathBuffer;appVersion;pubKey;fullPubKey;constructor(e,t,n="LedgerW",r=vp){Qc(t>=0,"Ledger account ID shall not be a negative number."),Qc(t<=Yo,"Ledger account ID shall be < 2**31."),Qc(!!n,"Ledger application name shall not be empty."),this.transporter=e,this._transporter=this.transporter,this.accountID=t,this.pubKey="",this.fullPubKey="",this.eip2645applicationName=n,this.appVersion="",this.pathBuffer=r(this.accountID,this.eip2645applicationName)}async getPubKey(){return this.pubKey||await this.getPublicKeys(),this.pubKey}async getFullPubKey(){return this.fullPubKey||await this.getPublicKeys(),this.fullPubKey}async getAppVersion(){if(!this.appVersion){const e=await this._transporter.send(Number("0x5a"),0,0,0);this.appVersion=`${e[0]}.${e[1]}.${e[2]}`}return this.appVersion}async signMessage(e,t){const n=Lf(e,t);return this.signRaw(n)}async signTransaction(e,t){const n=tf(e,t.cairoVersion);let r;if(Object.values(xo.ETransactionVersion2).includes(t.version)){const e=t;r=Mu({...e,senderAddress:e.walletAddress,compiledCalldata:n,version:e.version})}else{if(!Object.values(xo.ETransactionVersion3).includes(t.version))throw Error("unsupported signTransaction version");{const e=t;r=Mu({...e,senderAddress:e.walletAddress,compiledCalldata:n,version:e.version,nonceDataAvailabilityMode:Ah(e.nonceDataAvailabilityMode),feeDataAvailabilityMode:Ah(e.feeDataAvailabilityMode)})}}return this.signRaw(r)}async signDeployAccountTransaction(e){const t=hu.compile(e.constructorCalldata);let n;if(Object.values(xo.ETransactionVersion2).includes(e.version)){const r=e;n=Hu({...r,salt:r.addressSalt,constructorCalldata:t,version:r.version})}else{if(!Object.values(xo.ETransactionVersion3).includes(e.version))throw Error("unsupported signDeployAccountTransaction version");{const r=e;n=Hu({...r,salt:r.addressSalt,compiledConstructorCalldata:t,version:r.version,nonceDataAvailabilityMode:Ah(r.nonceDataAvailabilityMode),feeDataAvailabilityMode:Ah(r.feeDataAvailabilityMode)})}}return this.signRaw(n)}async signDeclareTransaction(e){let t;if(Object.values(xo.ETransactionVersion2).includes(e.version)){const n=e;t=$u({...n,version:n.version})}else{if(!Object.values(xo.ETransactionVersion3).includes(e.version))throw Error("unsupported signDeclareTransaction version");{const n=e;t=$u({...n,version:n.version,nonceDataAvailabilityMode:Ah(n.nonceDataAvailabilityMode),feeDataAvailabilityMode:Ah(n.feeDataAvailabilityMode)})}}return this.signRaw(t)}async signRaw(e){Fo(Vo(await this._transporter.send(Number("0x5a"),2,0,0,Buffer.from(this.pathBuffer))));const t=Sl(ul(BigInt(e)<<4n)),n=Uint8Array.from(await this._transporter.send(Number("0x5a"),2,1,0,Buffer.from(t))),r=BigInt(Fo(Vo(n.subarray(1,33)))),s=BigInt(Fo(Vo(n.subarray(33,65)))),a=n[65];return new rr(r,s).addRecoveryBit(a)}async getPublicKeys(){const e=this.pathBuffer,t=Uint8Array.from(await this._transporter.send(Number("0x5a"),1,0,0,Buffer.from(e)));this.pubKey=Fo(Vo(t.subarray(1,33))),this.fullPubKey=Fo(Vo(t.subarray(0,65)))}};function vp(e,t="LedgerW"){return jo([new Uint8Array([128,0,10,85]),new Uint8Array([71,65,233,201]),"LedgerW"===t?new Uint8Array([43,206,231,219]):xl(t),new Uint8Array([0,0,0,0]),Sl(Fo(Po(ul(e)).padStart(8,"0"))),new Uint8Array([0,0,0,0])])}function Ep(e){const t=ul(il(e)?Fo(e):e);return Fo(Po(t).padStart(64,"0"))}function Ap(e){const t=Ep(e);if(!t.match(/^(0x)?[0-9a-fA-F]{64}$/))throw new Error("Invalid Address Format");return yl(t,Wo,Qo-1n,"Starknet Address"),t}function kp(e){const t=Po(Ap(e)).toLowerCase().split(""),n=$e(Po(Bl(e)).padStart(64,"0"));for(let e=0;e<t.length;e+=2)n[e>>1]>>4>=8&&(t[e]=t[e].toUpperCase()),(15&n[e>>1])>=8&&(t[e+1]=t[e+1].toUpperCase());return Fo(t.join(""))}function Sp(e){return kp(e)===e}var Tp=class extends bp{constructor(e,t,n="LedgerW",r=xp){super(e,t,n,r)}async signTransaction(e,t){const n=tf(e,t.cairoVersion);if(Object.values(xo.ETransactionVersion2).includes(t.version)){const r=t,s=Mu({...r,senderAddress:r.walletAddress,compiledCalldata:n,version:r.version}),a=await this.signTxV1(r,e);return Qc(ll(s)===a.hash,"The V1 transaction hash calculated by Starknet.js is different from the one calculated by the Ledger."),a.signature}if(Object.values(xo.ETransactionVersion3).includes(t.version)){const r=t,s=Mu({...r,senderAddress:r.walletAddress,compiledCalldata:n,version:r.version,nonceDataAvailabilityMode:Ah(r.nonceDataAvailabilityMode),feeDataAvailabilityMode:Ah(r.feeDataAvailabilityMode)}),a=await this.signTxV3(r,e);return Qc(ll(s)===a.hash,"The V3 transaction hash calculated by Starknet.js is different from the one calculated by the Ledger."),a.signature}throw Error("unsupported signTransaction version")}async signDeployAccountTransaction(e){const t=hu.compile(e.constructorCalldata);let n;if(Object.values(xo.ETransactionVersion2).includes(e.version)){const r=e;n=Hu({...r,salt:r.addressSalt,constructorCalldata:t,version:r.version});const s=await this.signDeployAccountV1(r);return Qc(ll(n)===s.hash,"The transaction hash calculated by Starknet.js is different from the one calculated by the Ledger."),s.signature}if(Object.values(xo.ETransactionVersion3).includes(e.version)){const r=e;n=Hu({...r,salt:r.addressSalt,compiledConstructorCalldata:t,version:r.version,nonceDataAvailabilityMode:Ah(r.nonceDataAvailabilityMode),feeDataAvailabilityMode:Ah(r.feeDataAvailabilityMode)});const s=await this.signDeployAccountV3(r);return Qc(ll(n)===s.hash,"The transaction hash calculated by Starknet.js is different from the one calculated by the Ledger."),s.signature}throw Error("unsupported signDeployAccountTransaction version")}convertBnToLedger(e){return Sl(Ep(ul(e)))}decodeSignatureLedger(e){const t=BigInt(Fo(Vo(e.subarray(0,32)))),n=BigInt(Fo(Vo(e.subarray(33,65)))),r=BigInt(Fo(Vo(e.subarray(65,97)))),s=e[97];return{hash:t,signature:new rr(n,r).addRecoveryBit(s)}}encodeCall(e){const t=this.convertBnToLedger(e.contractAddress),n=Sl(Ep(Dl(e.entrypoint)));let r=new Uint8Array([]);e.calldata&&(r=jo(hu.compile(e.calldata).map(e=>this.convertBnToLedger(e))));const s=jo([t,n,r]),a=[];for(let e=0;e<s.length;e+=224)a.push(s.subarray(e,e+224));return a}async signTxV1(e,t){await this._transporter.send(Number("0x5a"),4,0,0,Buffer.from(this.pathBuffer));const n=jo([this.convertBnToLedger(e.walletAddress),this.convertBnToLedger(e.maxFee),this.convertBnToLedger(e.chainId),this.convertBnToLedger(e.nonce)]);await this._transporter.send(Number("0x5a"),4,1,0,Buffer.from(n));const r=this.convertBnToLedger(t.length);await this._transporter.send(Number("0x5a"),4,2,0,Buffer.from(r));let s=new Uint8Array(0);for(const e of t){const t=this.encodeCall(e);await this._transporter.send(Number("0x5a"),4,3,0,Buffer.from(t[0])),t.length>1&&t.slice(1).forEach(async e=>{await this._transporter.send(Number("0x5a"),4,3,1,Buffer.from(e))}),s=await this._transporter.send(Number("0x5a"),4,3,2)}return this.decodeSignatureLedger(s)}async signTxV3(e,t){Qc(e.paymasterData.length<=7,"Paymaster data includes more than 7 items."),Qc(e.accountDeploymentData.length<=7,"accountDeploymentData includes more than 7 items"),await this._transporter.send(Number("0x5a"),3,0,0,Buffer.from(this.pathBuffer));const n=this.convertBnToLedger(e.walletAddress),r=this.convertBnToLedger(e.tip),s=this.convertBnToLedger(e.chainId),a=this.convertBnToLedger(e.nonce),i=this.convertBnToLedger(Bu(e.nonceDataAvailabilityMode===xo.EDataAvailabilityMode.L1?xo.EDAMode.L1:xo.EDAMode.L2,e.feeDataAvailabilityMode===xo.EDataAvailabilityMode.L1?xo.EDAMode.L1:xo.EDAMode.L2)),o=jo([n,r,this.convertBnToLedger(Ou(e.resourceBounds)),this.convertBnToLedger(Nu(e.resourceBounds)),s,a,i]);await this._transporter.send(Number("0x5a"),3,1,0,Buffer.from(o));const c=jo(e.paymasterData.map(e=>this.convertBnToLedger(e)));await this._transporter.send(Number("0x5a"),3,2,0,Buffer.from(c));const l=jo(e.paymasterData.map(e=>this.convertBnToLedger(e)));await this._transporter.send(Number("0x5a"),3,3,0,Buffer.from(l));const d=this.convertBnToLedger(t.length);await this._transporter.send(Number("0x5a"),3,4,0,Buffer.from(d));let u=new Uint8Array(0);for(const e of t){const t=this.encodeCall(e);await this._transporter.send(Number("0x5a"),3,5,0,Buffer.from(t[0])),t.length>1&&t.slice(1).forEach(async e=>{await this._transporter.send(Number("0x5a"),3,5,1,Buffer.from(e))}),u=await this._transporter.send(Number("0x5a"),3,5,2)}return this.decodeSignatureLedger(u)}async signDeployAccountV1(e){await this._transporter.send(Number("0x5a"),6,0,0,Buffer.from(this.pathBuffer));const t=jo([this.convertBnToLedger(e.contractAddress),this.convertBnToLedger(e.classHash),this.convertBnToLedger(e.addressSalt),this.convertBnToLedger(e.chainId),this.convertBnToLedger(e.nonce)]);await this._transporter.send(Number("0x5a"),6,1,0,Buffer.from(t));const n=this.convertBnToLedger(e.maxFee);await this._transporter.send(Number("0x5a"),6,2,0,Buffer.from(n));const r=hu.compile(e.constructorCalldata),s=this.convertBnToLedger(r.length);await this._transporter.send(Number("0x5a"),6,3,0,Buffer.from(s));const a=jo(r.map(e=>this.convertBnToLedger(e))),i=[];for(let e=0;e<a.length;e+=224)i.push(a.subarray(e,e+224));let o=new Uint8Array(0);for(const e of i)o=await this._transporter.send(Number("0x5a"),6,4,0,Buffer.from(e));return this.decodeSignatureLedger(o)}async signDeployAccountV3(e){await this._transporter.send(Number("0x5a"),5,0,0,Buffer.from(this.pathBuffer));const t=jo([this.convertBnToLedger(e.contractAddress),this.convertBnToLedger(e.chainId),this.convertBnToLedger(e.nonce),this.convertBnToLedger(Bu(e.nonceDataAvailabilityMode===xo.EDataAvailabilityMode.L1?xo.EDAMode.L1:xo.EDAMode.L2,e.feeDataAvailabilityMode===xo.EDataAvailabilityMode.L1?xo.EDAMode.L1:xo.EDAMode.L2)),this.convertBnToLedger(e.classHash),this.convertBnToLedger(e.addressSalt)]);await this._transporter.send(Number("0x5a"),5,1,0,Buffer.from(t));const n=jo([this.convertBnToLedger(e.tip),this.convertBnToLedger(Ou(e.resourceBounds)),this.convertBnToLedger(Nu(e.resourceBounds))]);await this._transporter.send(Number("0x5a"),5,2,0,Buffer.from(n));const r=jo(e.paymasterData.map(e=>this.convertBnToLedger(e)));await this._transporter.send(Number("0x5a"),5,3,0,Buffer.from(r));const s=hu.compile(e.constructorCalldata),a=this.convertBnToLedger(s.length);await this._transporter.send(Number("0x5a"),5,4,0,Buffer.from(a));const i=jo(s.map(e=>this.convertBnToLedger(e))),o=[];for(let e=0;e<i.length;e+=224)o.push(i.subarray(e,e+224));let c=new Uint8Array(0);for(const e of o)c=await this._transporter.send(Number("0x5a"),5,5,0,Buffer.from(e));return this.decodeSignatureLedger(c)}};function xp(e,t="LedgerW"){const n=new Uint8Array([cc,0,10,85]),r=new Uint8Array([71|cc,65,233,201]),s="LedgerW"===t?new Uint8Array([43,206,231,219]):xl(t),a=jo([new Uint8Array([s[0]|cc]),s.subarray(1)]);return jo([n,r,a,new Uint8Array([cc,0,0,0]),Sl(Fo(Po(ul(BigInt(e)|lc)).padStart(8,"0"))),new Uint8Array([0,0,0,0])])}var Ip=class extends Tp{constructor(e,t,n="LedgerW",r=xp){super(e,t,n,r)}async signTxV1(e,t){await this._transporter.send(Number("0x5a"),4,0,0,Buffer.from(this.pathBuffer));const n=jo([this.convertBnToLedger(e.walletAddress),this.convertBnToLedger(e.maxFee),this.convertBnToLedger(e.chainId),this.convertBnToLedger(e.nonce)]);await this._transporter.send(Number("0x5a"),4,1,0,Buffer.from(n));const r=this.convertBnToLedger(t.length);await this._transporter.send(Number("0x5a"),4,2,0,Buffer.from(r));let s=new Uint8Array(0);for(const e of t){const t=this.encodeCall(e);s=await this._transporter.send(Number("0x5a"),4,3,0,Buffer.from(t[0])),t.length>1&&t.slice(1).forEach(async e=>{s=await this._transporter.send(Number("0x5a"),4,3,1,Buffer.from(e))})}return this.decodeSignatureLedger(s)}async signTxV3(e,t){Qc(e.paymasterData.length<=7,"Paymaster data includes more than 7 items."),Qc(e.accountDeploymentData.length<=7,"accountDeploymentData includes more than 7 items"),await this._transporter.send(Number("0x5a"),3,0,0,Buffer.from(this.pathBuffer));const n=jo([this.convertBnToLedger(e.walletAddress),this.convertBnToLedger(e.chainId),this.convertBnToLedger(e.nonce),this.convertBnToLedger(Bu(Ah(e.nonceDataAvailabilityMode),Ah(e.feeDataAvailabilityMode)))]);if(await this._transporter.send(Number("0x5a"),3,1,0,Buffer.from(n)),Vc(e.resourceBounds)){const t=jo([this.convertBnToLedger(e.tip),this.convertBnToLedger(Ou(e.resourceBounds)),this.convertBnToLedger(Nu(e.resourceBounds)),this.convertBnToLedger(Du(e.resourceBounds))]);await this._transporter.send(Number("0x5a"),3,2,0,Buffer.from(t))}else{const t=jo([this.convertBnToLedger(e.tip),this.convertBnToLedger(Ou(e.resourceBounds)),this.convertBnToLedger(Nu(e.resourceBounds))]);await this._transporter.send(Number("0x5a"),3,2,0,Buffer.from(t))}const r=jo(e.paymasterData.map(e=>this.convertBnToLedger(e)));await this._transporter.send(Number("0x5a"),3,3,0,Buffer.from(r));const s=jo(e.paymasterData.map(e=>this.convertBnToLedger(e)));await this._transporter.send(Number("0x5a"),3,4,0,Buffer.from(s));const a=this.convertBnToLedger(t.length);await this._transporter.send(Number("0x5a"),3,5,0,Buffer.from(a));let i=new Uint8Array(0);for(const e of t){const t=this.encodeCall(e);i=await this._transporter.send(Number("0x5a"),3,6,0,Buffer.from(t[0])),t.length>1&&t.slice(1).forEach(async e=>{i=await this._transporter.send(Number("0x5a"),3,6,1,Buffer.from(e))})}return this.decodeSignatureLedger(i)}async signDeployAccountV1(e){await this._transporter.send(Number("0x5a"),6,0,0,Buffer.from(this.pathBuffer));const t=jo([this.convertBnToLedger(e.contractAddress),this.convertBnToLedger(e.classHash),this.convertBnToLedger(e.addressSalt),this.convertBnToLedger(e.maxFee),this.convertBnToLedger(e.chainId),this.convertBnToLedger(e.nonce)]);await this._transporter.send(Number("0x5a"),6,1,0,Buffer.from(t));const n=hu.compile(e.constructorCalldata),r=this.convertBnToLedger(n.length);await this._transporter.send(Number("0x5a"),6,2,0,Buffer.from(r));const s=jo(n.map(e=>this.convertBnToLedger(e))),a=[];for(let e=0;e<s.length;e+=224)a.push(s.subarray(e,e+224));let i=new Uint8Array(0);for(const e of a)i=await this._transporter.send(Number("0x5a"),6,3,0,Buffer.from(e));return this.decodeSignatureLedger(i)}async signDeployAccountV3(e){await this._transporter.send(Number("0x5a"),5,0,0,Buffer.from(this.pathBuffer));const t=jo([this.convertBnToLedger(e.contractAddress),this.convertBnToLedger(e.chainId),this.convertBnToLedger(e.nonce),this.convertBnToLedger(Bu(Ah(e.nonceDataAvailabilityMode),Ah(e.feeDataAvailabilityMode))),this.convertBnToLedger(e.classHash),this.convertBnToLedger(e.addressSalt)]);if(await this._transporter.send(Number("0x5a"),5,1,0,Buffer.from(t)),Vc(e.resourceBounds)){const t=jo([this.convertBnToLedger(e.tip),this.convertBnToLedger(Ou(e.resourceBounds)),this.convertBnToLedger(Nu(e.resourceBounds)),this.convertBnToLedger(Du(e.resourceBounds))]);await this._transporter.send(Number("0x5a"),5,2,0,Buffer.from(t))}else{const t=jo([this.convertBnToLedger(e.tip),this.convertBnToLedger(Ou(e.resourceBounds)),this.convertBnToLedger(Nu(e.resourceBounds))]);await this._transporter.send(Number("0x5a"),5,2,0,Buffer.from(t))}const n=jo(e.paymasterData.map(e=>this.convertBnToLedger(e)));await this._transporter.send(Number("0x5a"),5,3,0,Buffer.from(n));const r=hu.compile(e.constructorCalldata),s=this.convertBnToLedger(r.length);await this._transporter.send(Number("0x5a"),5,4,0,Buffer.from(s));const a=jo(r.map(e=>this.convertBnToLedger(e))),i=[];for(let e=0;e<a.length;e+=224)i.push(a.subarray(e,e+224));let o=new Uint8Array(0);for(const e of i)o=await this._transporter.send(Number("0x5a"),5,5,0,Buffer.from(e));return this.decodeSignatureLedger(o)}encodeCall(e){const t=this.convertBnToLedger(e.contractAddress),n=Sl(Ep(Dl(e.entrypoint)));let r=new Uint8Array([]);if(e.calldata){const t=hu.compile(e.calldata);r=jo([this.convertBnToLedger(t.length),...t.map(e=>this.convertBnToLedger(e))])}else r=this.convertBnToLedger("0x00");const s=jo([t,n,r]),a=[];for(let e=0;e<s.length;e+=224)a.push(s.subarray(e,e+224));return a}},Cp={};function Bp(e){return"event"===e.type}function Op(e){const t=e.filter(e=>Bp(e)&&"struct"===e.kind),n=e.filter(e=>Bp(e)&&"enum"===e.kind);return t.reduce((e,t)=>{let r=[],{name:s}=t,a=!1;const i=e=>e.type===s;for(;;){const e=n.find(e=>e.variants.some(i));if(nl(e))break;const t=e.variants.find(i);r.unshift(t.name),"flat"===t.kind&&(a=!0),s=e.name}if(0===r.length)throw new Error("inconsistency in ABI events definition.");a&&(r=[r[r.length-1]]);const o=r.pop();let c={[Fo(br(Do(o)).toString(16))]:t};for(;r.length>0;)c={[Fo(br(Do(r.pop())).toString(16))]:c};return c={...c},Dp(e,c)},{})}function Np(e){return Od(e)?Op(e):function(e){return e.filter(e=>"event"===e.type).reduce((e,t)=>{const n=t.name,r={...t};return r.name=n,{...e,[Fo(br(Do(n)).toString(16))]:r}},{})}(e)}function Dp(e,t){const n={...e};return ol(e)&&ol(t)&&Object.keys(t).forEach(r=>{ol(t[r])?r in e?n[r]=Dp(e[r],t[r]):Object.assign(n,{[r]:t[r]}):Object.assign(n,{[r]:t[r]})}),n}function Lp(e,t,n,r){return e.flat().reduce((e,s)=>{const a=JSON.parse(JSON.stringify(s));let i=t[a.keys.shift()??0];if(!i)return e;for(;!i.name;){const e=a.keys.shift();Qc(!!e,'Not enough data in "keys" property of this event.'),i=i[e]}const o={};o[i.name]={};const c=a.keys[Symbol.iterator](),l=a.data[Symbol.iterator](),d=i.members?.filter(e=>"key"===e.kind)||i.keys,u=i.members?.filter(e=>"data"===e.kind)||i.data;return d.forEach(e=>{o[i.name][e.name]=ru(c,e,n,r,o[i.name])}),u.forEach(e=>{o[i.name][e.name]=ru(l,e,n,r,o[i.name])}),"block_hash"in a&&(o.block_hash=a.block_hash),"block_number"in a&&(o.block_number=a.block_number),"transaction_hash"in a&&(o.transaction_hash=a.transaction_hash),e.push(o),e},[])}function Rp(e){if(!e.events?.length)throw new Error("UDC emitted event is empty");const t=e.events.find(e=>ml(e.from_address)===ml(sc.ADDRESS))||{data:[]};return{transaction_hash:e.transaction_hash,contract_address:t.data[0],address:t.data[0],deployer:t.data[1],unique:t.data[2],classHash:t.data[3],calldata_len:t.data[4],calldata:t.data.slice(5,5+parseInt(t.data[4],16)),salt:t.data[t.data.length-1]}}ko(Cp,{getAbiEvents:()=>Np,isAbiEvent:()=>Bp,parseEvents:()=>Lp,parseUDCEvent:()=>Rp});var Vp={};function Pp(e){return"calldata_len"in e?{To:e.to,Selector:e.selector,Calldata:e.calldata}:e}function Fp(e){const t=e.calldata??[],n=Array.isArray(t)?t:hu.compile(t);return{to:e.contractAddress,selector:Nl(e.entrypoint),calldata:n}}function Up(e,t){const n=Fp(e);return"1"===t?{...n,calldata_len:n.calldata.length,calldata:n.calldata}:{To:n.to,Selector:n.selector,Calldata:n.calldata}}function Mp(e,t){return{name:"Account.execute_from_outside",version:t,chainId:e,..."2"===t?{revision:"1"}:{}}}function $p(e,t,n,r,s){return"1"===s?{types:jc,primaryType:"OutsideExecution",domain:Mp(e,s),message:{...t,nonce:n,calls_len:r.length,calls:r.map(e=>Up(e,s))}}:{types:qc,primaryType:"OutsideExecution",domain:Mp(e,s),message:{Caller:t.caller,Nonce:n,"Execute After":t.execute_after,"Execute Before":t.execute_before,Calls:r.map(e=>Up(e,s))}}}function Hp(e){const t=e.outsideExecution,n=yh(e.signature);return hu.compile({outside_execution:t,signature:n})}function zp(e){return(Array.isArray(e)?e:[e]).map(e=>{let t;if(e.version===Kc.V1)t="execute_from_outside";else{if(e.version!==Kc.V2)throw new Error("Unsupported OutsideExecution version");t="execute_from_outside_v2"}return{contractAddress:ul(e.signerAddress),entrypoint:t,calldata:Hp(e)}})}ko(Vp,{buildExecuteFromOutsideCall:()=>zp,buildExecuteFromOutsideCallData:()=>Hp,getOutsideCall:()=>Fp,getTypedData:()=>$p,toOutsideCallV2:()=>Pp});var jp={};async function qp(e,t,n){const r={contractAddress:ul(t),entrypoint:"supports_interface",calldata:[ul(n)]};try{const t=await e.callContract(r);return 0n!==BigInt(t[0])}catch{return!1}}ko(jp,{supportsInterface:()=>qp});var Kp={};ko(Kp,{assertCallsAreStrictlyEqual:()=>Zp,assertPaymasterTransactionSafety:()=>Yp,getDefaultPaymasterNodeUrl:()=>Wp});var Wp=(e,t=!1)=>{t||vc.info("Using default public node url, please provide nodeUrl in provider options!");const n=yc[e??uc.SN_SEPOLIA];return n[Math.floor(Math.random()*n.length)]};function Zp(e,t){const n="Provided calls are not strictly equal to the returned calls";Qc(t.length-1===e.length,`${n}: Expected ${e.length+1} calls, got ${t.length}`);for(let r=0;r<e.length;r+=1){const s=e[r],a=Pp(t[r]),i=e=>ll(e).toString(16).toLowerCase();Qc(i(s.contractAddress)===i(a.To),`${n}: Contract address mismatch at call ${r}. Expected: ${s.contractAddress}, Got: ${a.To}`),Qc(Nl(s.entrypoint)===a.Selector,`${n}: Entrypoint mismatch at call ${r}. Expected: ${s.entrypoint}, Got: ${a.Selector}`);const o=hu.toCalldata(s.calldata),c=hu.toCalldata(a.Calldata);Qc(o.length===c.length,`${n}: Calldata length mismatch at call ${r}. Expected length: ${o.length}, Got length: ${c.length}`);for(let e=0;e<o.length;e+=1)Qc(BigInt(o[e])===BigInt(c[e]),`${n}: Calldata value mismatch at call ${r}, parameter ${e}. Expected: ${o[e]}, Got: ${c[e]}`)}}var Yp=(e,t,n,r)=>{if("sponsored"!==n.feeMode.mode&&("invoke"===e.type||"deploy_and_invoke"===e.type)){const s="calls"in e.typed_data.message?e.typed_data.message.calls:e.typed_data.message.Calls;Zp(t,s),((e,t)=>{const n=Pp(e[e.length-1]);Qc(BigInt(n.To)===BigInt(t),"Gas token address is not equal to the provided gas token")})(s,n.feeMode.gasToken),r&&(Qc(e.fee.suggested_max_fee_in_gas_token<=r,"Gas token price is too high"),((e,t)=>{const n=Pp(e[e.length-1]),r=hu.toCalldata(n.Calldata)[1];Qc(BigInt(r)===BigInt(t),"Gas token value is not equal to the provided gas fees")})(s,e.fee.suggested_max_fee_in_gas_token))}},Gp=e=>"sponsored"===e.mode?{mode:"sponsored"}:{mode:"default",gas_token:e.gasToken},Xp=e=>e?{execute_after:e.executeAfter||1,execute_before:e.executeBefore}:void 0,Jp=e=>{return{version:e.version,feeMode:(n=e.fee_mode,"sponsored"===n.mode?{mode:"sponsored"}:{mode:"default",gasToken:n.gas_token}),timeBounds:(t=e.time_bounds,t?{executeAfter:t.execute_after,executeBefore:t.execute_before}:void 0)};var t,n},Qp={"Content-Type":"application/json"},eg=class e{nodeUrl;headers;baseFetch;requestId;constructor(t){if(t instanceof e)return this.nodeUrl=t.nodeUrl,this.headers={...Qp,...t.headers},this.baseFetch=t.baseFetch,void(this.requestId=t.requestId);if(t&&"nodeUrl"in t&&"headers"in t&&"baseFetch"in t)return this.nodeUrl=t.nodeUrl??Wp(void 0),this.headers={...Qp,...t.headers},this.baseFetch=t.baseFetch??$h,void(this.requestId=0);const{nodeUrl:n,headers:r,baseFetch:s}=t||{};n&&Object.values(uc).includes(n)?this.nodeUrl=Wp(n,t?.default):this.nodeUrl=n||Wp(void 0,t?.default),this.baseFetch=s??$h,this.headers={...Qp,...r},this.requestId=0}fetch(e,t,n=0){const r={id:n,jsonrpc:"2.0",method:e,...t&&{params:t}};return this.baseFetch(this.nodeUrl,{method:"POST",body:Xc(r),headers:this.headers})}errorHandler(e,t,n,r){if(n)throw new Rh(n,e,t);if(r instanceof Lh)throw r;if(r)throw Error(r.message)}async fetchEndpoint(e,t){try{this.requestId+=1;const n=await this.fetch(e,t,this.requestId),{error:r,result:s}=await n.json();return this.errorHandler(e,t,r),s}catch(n){throw this.errorHandler(e,t,n?.response?.data,n),n}}async isAvailable(){return this.fetchEndpoint("paymaster_isAvailable")}async buildTransaction(e,t){let n;switch(e.type){case"invoke":case"deploy_and_invoke":n={...e,invoke:{user_address:e.invoke.userAddress,calls:(r=e.invoke.calls,r.map(e=>({to:e.contractAddress,selector:Nl(e.entrypoint),calldata:hu.toHex(e.calldata)})))}};break;default:n=e}var r;const s={version:t.version,fee_mode:Gp(t.feeMode),time_bounds:Xp(t.timeBounds)},a=await this.fetchEndpoint("paymaster_buildTransaction",{transaction:n,parameters:s}),i={gas_token_price_in_strk:BigInt(a.fee.gas_token_price_in_strk),estimated_fee_in_strk:BigInt(a.fee.estimated_fee_in_strk),estimated_fee_in_gas_token:BigInt(a.fee.estimated_fee_in_gas_token),suggested_max_fee_in_strk:BigInt(a.fee.suggested_max_fee_in_strk),suggested_max_fee_in_gas_token:BigInt(a.fee.suggested_max_fee_in_gas_token)};switch(a.type){case"invoke":return{type:"invoke",typed_data:a.typed_data,parameters:Jp(a.parameters),fee:i};case"deploy_and_invoke":return{type:"deploy_and_invoke",deployment:a.deployment,typed_data:a.typed_data,parameters:Jp(a.parameters),fee:i};default:return{type:"deploy",deployment:a.deployment,parameters:Jp(a.parameters),fee:i}}}async executeTransaction(e,t){let n;switch(e.type){case"invoke":case"deploy_and_invoke":n={...e,invoke:{user_address:e.invoke.userAddress,typed_data:e.invoke.typedData,signature:wh(e.invoke.signature)}};break;default:n=e}const r={version:t.version,fee_mode:Gp(t.feeMode),time_bounds:Xp(t.timeBounds)};return this.fetchEndpoint("paymaster_executeTransaction",{transaction:n,parameters:r})}async getSupportedTokens(){return this.fetchEndpoint("paymaster_getSupportedTokens").then(e=>e.map(e=>({token_address:e.token_address,decimals:e.decimals,priceInStrk:BigInt(e.price_in_strk)})))}},tg=class{},ng=new eg({default:!0}),rg=class extends dp{signer;address;cairoVersion;transactionVersion;paymaster;constructor(e,t,n,r,s=wc.get("transactionVersion"),a){super(e),this.address=t.toLowerCase(),this.signer=il(n)||n instanceof Uint8Array?new pp(n):n,r&&(this.cairoVersion=r.toString()),this.transactionVersion=s,this.paymaster=a?new eg(a):ng,vc.debug("Account setup",{transactionVersion:this.transactionVersion,cairoVersion:this.cairoVersion,channel:this.channel.id})}static async create(){throw new Lh("Not supported")}getPreferredVersion(e,t){return this.transactionVersion===Bc.V3?t:this.transactionVersion===Bc.V2?e:Bc.V3}async getNonce(e){return super.getNonceForAddress(this.address,e)}async getNonceSafe(e){try{return ll(e??await this.getNonce())}catch(e){return 0n}}async getCairoVersion(e){if(!this.cairoVersion){const{cairo:t}=e?await super.getContractVersion(void 0,e):await super.getContractVersion(this.address);this.cairoVersion=t}return this.cairoVersion}async estimateFee(e,t={}){return this.estimateInvokeFee(e,t)}async estimateInvokeFee(e,t={}){const{nonce:n,blockIdentifier:r,version:s,skipValidate:a=!0}=t,i=Array.isArray(e)?e:[e],o=ll(n??await this.getNonce()),c=kh(this.getPreferredVersion(Bc.F1,Bc.F3),Sh(s)),l=await this.getChainId(),d={...Th(t,await this.channel.setUpSpecVersion()),walletAddress:this.address,nonce:o,maxFee:Wo,version:c,chainId:l,cairoVersion:await this.getCairoVersion(),skipValidate:a},u=await this.buildInvocation(i,d);return super.getInvokeEstimateFee({...u},{...Th(t,await this.channel.setUpSpecVersion()),version:c,nonce:o},r,t.skipValidate)}async estimateDeclareFee(e,t={}){const{blockIdentifier:n,nonce:r,version:s,skipValidate:a=!0}=t,i=ll(r??await this.getNonce()),o=kh(Ch(e.contract)?this.getPreferredVersion(Bc.F2,Bc.F3):Bc.F1,Sh(s)),c=await this.getChainId(),l=await this.buildDeclarePayload(e,{...Th(t,await this.channel.setUpSpecVersion()),nonce:i,chainId:c,version:o,walletAddress:this.address,maxFee:Wo,cairoVersion:void 0,skipValidate:a});return super.getDeclareEstimateFee(l,{...Th(t,await this.channel.setUpSpecVersion()),version:o,nonce:i},n,t.skipValidate)}async estimateAccountDeployFee({classHash:e,addressSalt:t=0,constructorCalldata:n=[],contractAddress:r},s={}){const{blockIdentifier:a,version:i,skipValidate:o=!0}=s,c=kh(this.getPreferredVersion(Bc.F1,Bc.F3),Sh(i)),l=Wo,d=await this.getChainId(),u=await this.buildAccountDeployPayload({classHash:e,addressSalt:t,constructorCalldata:n,contractAddress:r},{...Th(s,await this.channel.setUpSpecVersion()),nonce:l,chainId:d,version:c,walletAddress:this.address,maxFee:Wo,cairoVersion:void 0,skipValidate:o});return super.getDeployAccountEstimateFee({...u},{...Th(s,await this.channel.setUpSpecVersion()),version:c,nonce:l},a,s.skipValidate)}async estimateDeployFee(e,t={}){const n=this.buildUDCContractPayload(e);return this.estimateInvokeFee(n,t)}async estimateFeeBulk(e,t={}){if(!e.length)throw TypeError("Invocations should be non-empty array");const{nonce:n,blockIdentifier:r,version:s,skipValidate:a}=t,i=await this.accountInvocationsFactory(e,{...Th(t,await this.channel.setUpSpecVersion()),versions:[Bc.F1,kh(this.getPreferredVersion(Bc.F2,Bc.F3),s)],nonce:n,blockIdentifier:r,skipValidate:a});return super.getEstimateFeeBulk(i,{blockIdentifier:r,skipValidate:a})}async simulateTransaction(e,t={}){if(!e.length)throw TypeError("Invocations should be non-empty array");const{nonce:n,blockIdentifier:r,skipValidate:s=!0,skipExecute:a,version:i}=t,o=await this.accountInvocationsFactory(e,{...Th(t,await this.channel.setUpSpecVersion()),versions:[Bc.V1,kh(this.getPreferredVersion(Bc.V2,Bc.V3),i)],nonce:n,blockIdentifier:r,skipValidate:s});return super.getSimulateTransaction(o,{blockIdentifier:r,skipValidate:s,skipExecute:a})}async execute(e,t={}){const n=Array.isArray(e)?e:[e],r=ll(t.nonce??await this.getNonce()),s=kh(this.getPreferredVersion(Bc.V1,Bc.V3),t.version),a=await this.getUniversalSuggestedFee(s,{type:Sc.INVOKE,payload:e},{...t,version:s}),i=await this.getChainId(),o={...Th(t,await this.channel.setUpSpecVersion()),resourceBounds:a.resourceBounds,walletAddress:this.address,nonce:r,maxFee:a.maxFee,version:s,chainId:i,cairoVersion:await this.getCairoVersion()},c=await this.signer.signTransaction(n,o),l=tf(n,await this.getCairoVersion());return this.invokeFunction({contractAddress:this.address,calldata:l,signature:c},{...Th(t,await this.channel.setUpSpecVersion()),resourceBounds:a.resourceBounds,nonce:r,maxFee:a.maxFee,version:s})}async buildPaymasterTransaction(e,t){if(!t.deploymentData&&await this.getSnip9Version()===Kc.UNSUPPORTED)throw Error("Account is not compatible with SNIP-9");const n={version:"0x1",feeMode:t.feeMode,timeBounds:t.timeBounds};let r;return r=t.deploymentData?e.length>0?{type:"deploy_and_invoke",invoke:{userAddress:this.address,calls:e},deployment:t.deploymentData}:{type:"deploy",deployment:t.deploymentData}:{type:"invoke",invoke:{userAddress:this.address,calls:e}},this.paymaster.buildTransaction(r,n)}async estimatePaymasterTransactionFee(e,t){return(await this.buildPaymasterTransaction(e,t)).fee}async preparePaymasterTransaction(e){let t;switch(e.type){case"deploy_and_invoke":{const n=await this.signMessage(e.typed_data);t={type:"deploy_and_invoke",invoke:{userAddress:this.address,typedData:e.typed_data,signature:wh(n)},deployment:e.deployment};break}case"invoke":{const n=await this.signMessage(e.typed_data);t={type:"invoke",invoke:{userAddress:this.address,typedData:e.typed_data,signature:wh(n)}};break}case"deploy":t={type:"deploy",deployment:e.deployment};break;default:throw Error("Invalid transaction type")}return t}async executePaymasterTransaction(e,t,n){const r=await this.buildPaymasterTransaction(e,t);Yp(r,e,t,n);const s=await this.preparePaymasterTransaction(r);return this.paymaster.executeTransaction(s,r.parameters).then(e=>({transaction_hash:e.transaction_hash}))}async declareIfNot(e,t={}){const n=Bh(e);try{await this.getClassByHash(n.classHash)}catch(n){return this.declare(e,t)}return{transaction_hash:"",class_hash:n.classHash}}async declare(e,t={}){const n=Bh(e),{nonce:r,version:s}=t,a=kh(Ch(e.contract)?this.getPreferredVersion(Bc.V2,Bc.V3):Bc.V1,s),i=await this.getUniversalSuggestedFee(a,{type:Sc.DECLARE,payload:n},{...t,version:a}),o={...Th(t,await this.channel.setUpSpecVersion()),resourceBounds:i.resourceBounds,maxFee:i.maxFee,nonce:ll(r??await this.getNonce()),version:a,chainId:await this.getChainId(),walletAddress:this.address,cairoVersion:void 0},c=await this.buildDeclarePayload(n,o);return this.declareContract(c,o)}async deploy(e,t={}){const{calls:n,addresses:r}=nf(e,this.address);return{...await this.execute(n,t),contract_address:r}}async deployContract(e,t={}){const n=await this.deploy(e,t);return Rp(await this.waitForTransaction(n.transaction_hash))}async declareAndDeploy(e,t={}){const{constructorCalldata:n,salt:r,unique:s}=e;let a=await this.declareIfNot(e,t);if(""!==a.transaction_hash){const e=await this.waitForTransaction(a.transaction_hash);a={...a,...e}}const i=await this.deployContract({classHash:a.class_hash,salt:r,unique:s,constructorCalldata:n},t);return{declare:{...a},deploy:i}}deploySelf=this.deployAccount;async deployAccount({classHash:e,constructorCalldata:t=[],addressSalt:n=0,contractAddress:r},s={}){const a=kh(this.getPreferredVersion(Bc.V1,Bc.V3),s.version),i=Wo,o=await this.getChainId(),c=hu.compile(t),l=r??Zu(n,e,c,0),d=await this.getUniversalSuggestedFee(a,{type:Sc.DEPLOY_ACCOUNT,payload:{classHash:e,constructorCalldata:c,addressSalt:n,contractAddress:l}},s),u=await this.signer.signDeployAccountTransaction({...Th(s,await this.channel.setUpSpecVersion()),classHash:e,constructorCalldata:c,contractAddress:l,addressSalt:n,chainId:o,resourceBounds:d.resourceBounds,maxFee:d.maxFee,version:a,nonce:i});return this.deployAccountContract({classHash:e,addressSalt:n,constructorCalldata:t,signature:u},{...Th(s,await this.channel.setUpSpecVersion()),nonce:i,resourceBounds:d.resourceBounds,maxFee:d.maxFee,version:a})}async signMessage(e){return this.signer.signMessage(e,this.address)}async hashMessage(e){return Lf(e,this.address)}async getSnip9Version(){return await qp(this,this.address,oc)?Kc.V2:await qp(this,this.address,ic)?Kc.V1:Kc.UNSUPPORTED}async isValidSnip9Nonce(e){try{const t={contractAddress:this.address,entrypoint:"is_valid_outside_execution_nonce",calldata:[ul(e)]},n=await this.callContract(t);return 0n!==BigInt(n[0])}catch(e){throw new Error(`Failed to check if nonce is valid: ${e}`)}}async getSnip9Nonce(){const e=mh();return await this.isValidSnip9Nonce(e)?e:this.getSnip9Nonce()}async getOutsideTransaction(e,t,n,r){if(!cl(e.caller)&&"ANY_CALLER"!==e.caller)throw new Error(`The caller ${e.caller} is not valid.`);const s=cl(e.caller)?e.caller:ac,a=Array.isArray(t)?t:[t],i=n??await this.getSnip9Version();if(!i)throw new Error("This account is not handling outside transactions.");const o=r?ul(r):await this.getSnip9Nonce(),c=$p(await this.getChainId(),{caller:s,execute_after:e.execute_after,execute_before:e.execute_before},o,a,i),l=await this.signMessage(c);return{outsideExecution:{caller:s,nonce:o,execute_after:e.execute_after,execute_before:e.execute_before,calls:a.map(Fp)},signature:l,signerAddress:this.address,version:i}}async executeFromOutside(e,t){const n=zp(e);return this.execute(n,t)}async getUniversalSuggestedFee(e,{type:t,payload:n},r){let s=0,a=vh(Wo,void 0,await this.channel.setUpSpecVersion());return e===Bc.V3?a=r.resourceBounds??(await this.getSuggestedFee({type:t,payload:n},r)).resourceBounds:s=r.maxFee??(await this.getSuggestedFee({type:t,payload:n},r)).suggestedMaxFee,{maxFee:s,resourceBounds:a}}async getSuggestedFee({type:e,payload:t},n){switch(e){case Sc.INVOKE:return this.estimateInvokeFee(t,n);case Sc.DECLARE:return this.estimateDeclareFee(t,n);case Sc.DEPLOY_ACCOUNT:return this.estimateAccountDeployFee(t,n);case Sc.DEPLOY:return this.estimateDeployFee(t,n);default:return Eh(await this.channel.setUpSpecVersion())}}async buildInvocation(e,t){const n=tf(e,await this.getCairoVersion()),r=t.skipValidate?[]:await this.signer.signTransaction(e,t);return{...Th(t,await this.channel.setUpSpecVersion()),contractAddress:this.address,calldata:n,signature:r}}async buildDeclarePayload(e,t){const{classHash:n,contract:r,compiledClassHash:s}=Bh(e),a=qh(r);if(nl(s)&&(t.version===Nc.F3||t.version===Nc.V3))throw Error("V3 Transaction work with Cairo1 Contracts and require compiledClassHash");const i=t.skipValidate?[]:await this.signer.signDeclareTransaction({...t,...Th(t,await this.channel.setUpSpecVersion()),classHash:n,compiledClassHash:s,senderAddress:t.walletAddress});return{senderAddress:t.walletAddress,signature:i,contract:a,compiledClassHash:s}}async buildAccountDeployPayload({classHash:e,addressSalt:t=0,constructorCalldata:n=[],contractAddress:r},s){const a=hu.compile(n),i=r??Zu(t,e,a,0),o=s.skipValidate?[]:await this.signer.signDeployAccountTransaction({...s,...Th(s,await this.channel.setUpSpecVersion()),classHash:e,contractAddress:i,addressSalt:t,constructorCalldata:a});return{...Th(s,await this.channel.setUpSpecVersion()),classHash:e,addressSalt:t,constructorCalldata:a,signature:o}}buildUDCContractPayload(e){const t=[].concat(e).map(e=>{const{classHash:t,salt:n="0",unique:r=!0,constructorCalldata:s=[]}=e,a=hu.compile(s);return{contractAddress:sc.ADDRESS,entrypoint:sc.ENTRYPOINT,calldata:[t,n,kl(r),a.length,...a]}});return t}async accountInvocationsFactory(e,t){const{nonce:n,blockIdentifier:r,skipValidate:s=!0}=t,a=await this.getNonceSafe(n),i=await this.getChainId(),o=t.versions.map(e=>kh(e)),c="payload"in e[0]?e[0].payload:e[0],l=e[0].type===Sc.DEPLOY_ACCOUNT?await this.getCairoVersion(c.classHash):await this.getCairoVersion();return Promise.all([].concat(e).map(async(e,n)=>{const c="payload"in e?e.payload:e,d={...Th(t,await this.channel.setUpSpecVersion()),walletAddress:this.address,nonce:ll(Number(a)+n),maxFee:Wo,chainId:i,cairoVersion:l,version:"",skipValidate:s},u={type:e.type,nonce:ll(Number(a)+n),blockIdentifier:r,version:""};if(e.type===Sc.INVOKE){const e=xh(o[1]);d.version=e,u.version=e;const t=await this.buildInvocation([].concat(c),d);return{...u,...t,...d}}if(e.type===Sc.DEPLOY){const e=xh(o[1]);d.version=e,u.version=e;const t=this.buildUDCContractPayload(c),n=await this.buildInvocation(t,d);return{...u,...n,...d,type:Sc.INVOKE}}if(e.type===Sc.DECLARE){const e=Ch(c.contract)?o[1]:o[0];d.version=e,u.version=e;const t=await this.buildDeclarePayload(c,d);return{...u,...t,...d}}if(e.type===Sc.DEPLOY_ACCOUNT){const e=xh(o[1]);d.version=e,u.version=e;const t=await this.buildAccountDeployPayload(c,d);return{...u,...t,...d}}throw Error(`accountInvocationsFactory: unsupported transaction type: ${e}`)}))}async getStarkName(e=this.address,t){return super.getStarkName(e,t)}},sg=class extends up{},ag={};function ig(e,t=!1){return e.request({type:"wallet_requestAccounts",params:{silent_mode:t}})}function og(e){return e.request({type:"wallet_getPermissions"})}function cg(e,t){return e.request({type:"wallet_watchAsset",params:t})}function lg(e,t){return e.request({type:"wallet_addStarknetChain",params:t})}function dg(e,t){return e.request({type:"wallet_switchStarknetChain",params:{chainId:t}})}function ug(e){return e.request({type:"wallet_requestChainId"})}function hg(e){return e.request({type:"wallet_deploymentData"})}function fg(e,t){return e.request({type:"wallet_addInvokeTransaction",params:t})}function pg(e,t){return e.request({type:"wallet_addDeclareTransaction",params:t})}function gg(e,t){return e.request({type:"wallet_signTypedData",params:t})}function mg(e){return e.request({type:"wallet_supportedSpecs"})}function yg(e,t){e.on("accountsChanged",t)}function _g(e,t){e.on("networkChanged",t)}ko(ag,{addDeclareTransaction:()=>pg,addInvokeTransaction:()=>fg,addStarknetChain:()=>lg,deploymentData:()=>hg,getPermissions:()=>og,onAccountChange:()=>yg,onNetworkChanged:()=>_g,requestAccounts:()=>ig,requestChainId:()=>ug,signMessage:()=>gg,supportedSpecs:()=>mg,switchStarknetChain:()=>dg,watchAsset:()=>cg});var wg=class e extends rg{walletProvider;constructor(e,t,n,r,s){super(e,n,"",r,void 0,s),this.walletProvider=t,this.walletProvider.on("accountsChanged",e=>{e&&(this.address=e[0].toLowerCase())}),this.walletProvider.on("networkChanged",e=>{e&&this.channel.setChainId(e)})}onAccountChange(e){yg(this.walletProvider,e)}onNetworkChanged(e){_g(this.walletProvider,e)}requestAccounts(e=!1){return ig(this.walletProvider,e)}getPermissions(){return og(this.walletProvider)}switchStarknetChain(e){return dg(this.walletProvider,e)}watchAsset(e){return cg(this.walletProvider,e)}addStarknetChain(e){return lg(this.walletProvider,e)}execute(e){const t={calls:[].concat(e).map(e=>{const{contractAddress:t,entrypoint:n,calldata:r}=e;return{contract_address:t,entry_point:n,calldata:r}})};return fg(this.walletProvider,t)}declare(e){const t=Bh(e),n=e.contract,r={...n,abi:Xc(n.abi)};if(!t.compiledClassHash)throw Error("compiledClassHash is required");const s={compiled_class_hash:t.compiledClassHash,contract_class:r};return pg(this.walletProvider,s)}async deploy(e){const{calls:t,addresses:n}=nf(e,this.address);return{...await this.execute(t),contract_address:n}}signMessage(e){return gg(this.walletProvider,e)}static async connect(t,n,r,s,a=!1){const[i]=await ig(n,a);return new e(t,n,i,r,s)}static async connectSilent(t,n,r,s){return e.connect(t,n,r,s,!0)}};function bg(e,t){return async function(...n){const r={...e.contractOptions};return e.contractOptions=void 0,e.call(t.name,n,{parseRequest:!0,parseResponse:!0,...r})}}function vg(e,t){return"view"===t.stateMutability||"view"===t.state_mutability?bg(e,t):function(e,t){return async function(...n){const r={...e.contractOptions};return e.contractOptions=void 0,e.invoke(t.name,n,{parseRequest:!0,...r})}}(e,t)}function Eg(e,t){return function(...n){return e.estimate(t.name,n)}}function Ag(e,t){return Array.isArray(e)&&"__compiled__"in e?e:Array.isArray(e)&&Array.isArray(e[0])&&"__compiled__"in e[0]?e[0]:t()}var kg=class{abi;address;providerOrAccount;deployTransactionHash;structs;events;functions;callStatic;populateTransaction;estimateFee;callData;contractOptions;constructor(e,t,n=hp){this.address=t&&t.toLowerCase(),this.providerOrAccount=n,this.callData=new hu(e),this.structs=hu.getAbiStruct(e),this.events=Np(e);const r=Wd(e);this.abi=r.getLegacyFormat();const s={enumerable:!0,value:{},writable:!1};Object.defineProperties(this,{functions:{enumerable:!0,value:{},writable:!1},callStatic:{enumerable:!0,value:{},writable:!1},populateTransaction:{enumerable:!0,value:{},writable:!1},estimateFee:{enumerable:!0,value:{},writable:!1}}),this.abi.forEach(e=>{if("function"!==e.type)return;const t=e.name;var n,r;this[t]||Object.defineProperty(this,t,{...s,value:vg(this,e)}),this.functions[t]||Object.defineProperty(this.functions,t,{...s,value:vg(this,e)}),this.callStatic[t]||Object.defineProperty(this.callStatic,t,{...s,value:bg(this,e)}),this.populateTransaction[t]||Object.defineProperty(this.populateTransaction,t,{...s,value:(n=this,r=e,function(...e){return n.populate(r.name,e)})}),this.estimateFee[t]||Object.defineProperty(this.estimateFee,t,{...s,value:Eg(this,e)})})}withOptions(e){return this.contractOptions=e,this}attach(e){this.address=e}connect(e){this.providerOrAccount=e}async deployed(){return this.deployTransactionHash&&(await this.providerOrAccount.waitForTransaction(this.deployTransactionHash),this.deployTransactionHash=void 0),this}async call(e,t=[],{parseRequest:n=!0,parseResponse:r=!0,formatResponse:s,blockIdentifier:a}={}){Qc(null!==this.address,"contract is not connected to an address");const i=Ag(t,()=>n?(this.callData.validate(Uc.CALL,e,t),this.callData.compile(e,t)):(vc.warn("Call skipped parsing but provided rawArgs, possible malfunction request"),t));return this.providerOrAccount.callContract({contractAddress:this.address,calldata:i,entrypoint:e},a).then(t=>r?s?this.callData.format(e,t,s):this.callData.parse(e,t):t)}invoke(e,t=[],{parseRequest:n=!0,signature:r,...s}={}){Qc(null!==this.address,"contract is not connected to an address");const a=Ag(t,()=>n?(this.callData.validate(Uc.INVOKE,e,t),this.callData.compile(e,t)):(vc.warn("Invoke skipped parsing but provided rawArgs, possible malfunction request"),t)),i={contractAddress:this.address,calldata:a,entrypoint:e};if("execute"in this.providerOrAccount)return this.providerOrAccount.execute(i,{...s});if(!s.nonce)throw new Error("Nonce is required when invoking a function without an account");return vc.warn(`Invoking ${e} without an account. This will not work on a public node.`),this.providerOrAccount.invokeFunction({...i,signature:r},{...s,nonce:s.nonce})}async estimate(e,t=[]){Qc(null!==this.address,"contract is not connected to an address"),Ag(t,()=>!1)||this.callData.validate(Uc.INVOKE,e,t);const n=this.populate(e,t);if("estimateInvokeFee"in this.providerOrAccount)return this.providerOrAccount.estimateInvokeFee(n);throw Error("Contract must be connected to the account contract to estimate")}populate(e,t=[]){const n=Ag(t,()=>this.callData.compile(e,t));return{contractAddress:this.address,entrypoint:e,calldata:n}}parseEvents(e){let t;return e.match({success:e=>{const n=e.events?.map(t=>({block_hash:e.block_hash,block_number:e.block_number,transaction_hash:e.transaction_hash,...t})).filter(e=>ml(e.from_address)===ml(this.address),[])||[];t=Lp(n,this.events,this.structs,hu.getAbiEnum(this.abi))},_:()=>{throw Error("This transaction was not successful.")}}),t}isCairo1(){return Gl.isCairo1Abi(this.abi)}async getVersion(){return this.providerOrAccount.getContractVersion(this.address)}typedv2(e){return this}},Sg=class{functions;callStatic;populateTransaction;estimateFee},Tg=class{compiledContract;account;abi;classHash;casm;compiledClassHash;CallData;contractOptions;constructor(e){this.compiledContract=e.compiledContract,this.account=e.account,this.casm=e.casm,this.abi=e.abi??e.compiledContract.abi,this.classHash=e.classHash,this.compiledClassHash=e.compiledClassHash,this.CallData=new hu(this.abi),this.contractOptions=e.contractOptions}async deploy(...e){const t=Ag(e,()=>this.contractOptions?.parseRequest?(this.CallData.validate(Uc.DEPLOY,"constructor",e),this.CallData.compile("constructor",e)):(vc.warn("Call skipped parsing but provided rawArgs, possible malfunction request"),e)),{deploy:{contract_address:n,transaction_hash:r}}=await this.account.declareAndDeploy({contract:this.compiledContract,casm:this.casm,classHash:this.classHash,compiledClassHash:this.compiledClassHash,constructorCalldata:t,salt:this.contractOptions?.addressSalt});Qc(Boolean(n),"Deployment of the contract failed");const s=new kg(this.compiledContract.abi,n,this.account);return s.deployTransactionHash=r,s}connect(e){return this.account=e,this}attach(e){return new kg(this.abi,e,this.account)}},xg=class{};function Ig(e,t="fri"){if("strk"===t){let t="";"bigint"==typeof e?t=e.toString():"string"==typeof e&&(t=cl(e)?BigInt(e).toString():e);const[n,r="0"]=t.split(".");return`${n}${r.padEnd(18,"0")}`.replace(/\b0+/g,"")}const n=BigInt(e).toString();let r;return r=n.length<=18?`0.${n.padStart(18,"0")}`:`${n.slice(0,n.length-18)}.${n.slice(n.length-18)}`,r.replace(/(\.[0-9]*[1-9])0+$|\.0*$/,"$1")}}}]);
//# sourceMappingURL=starknet-core.chunk.js.map